

============================== 13:04:16.963711 | 5c4693c4-72c5-41c4-b1b0-c6ef469e98ee ==============================
[0m13:04:16.963711 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:04:16.972078 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m13:04:16.972078 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:04:17.012781 [info ] [MainThread]: dbt version: 1.10.13
[0m13:04:17.012781 [info ] [MainThread]: python version: 3.12.3
[0m13:04:17.012781 [info ] [MainThread]: python path: C:\Users\danie\attribution-os\.venv\Scripts\python.exe
[0m13:04:17.018287 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m13:04:17.704432 [info ] [MainThread]: Using profiles dir at C:\Users\danie\.dbt
[0m13:04:17.704432 [info ] [MainThread]: Using profiles.yml file at C:\Users\danie\.dbt\profiles.yml
[0m13:04:17.704432 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\danie\attribution-os\analytics\attribution_dbt\dbt_project.yml
[0m13:04:17.877389 [info ] [MainThread]: Configuration:
[0m13:04:17.878305 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:04:17.878713 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:04:17.879624 [info ] [MainThread]: Required dependencies:
[0m13:04:17.881166 [debug] [MainThread]: Executing "git --help"
[0m13:04:17.965283 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:04:17.965283 [debug] [MainThread]: STDERR: "b''"
[0m13:04:17.965283 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:04:17.965283 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:04:17.965283 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:04:17.975494 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "attribution_os", target "dev" invalid: ["SET s3_endpoint='localhost:9000';", "SET s3_url_style='path';", 'SET s3_use_ssl=false;', "SET s3_access_key_id='admin';", "SET s3_secret_access_key='adminadmin';", "SET s3_region='us-east-1';"] is not valid under any of the given schemas


[0m13:04:17.976095 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ProjectFlagsMovedDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:04:17.976095 [debug] [MainThread]: Command `dbt debug` failed at 13:04:17.976095 after 1.32 seconds
[0m13:04:17.976095 [debug] [MainThread]: Flushing usage events
[0m15:12:19.827133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF3884110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF3B02630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF3B02CF0>]}


============================== 15:12:19.844372 | 35d8f41d-ef89-4af2-af48-fb447ccd31e2 ==============================
[0m15:12:19.844372 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:12:19.847092 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m15:12:19.971996 [info ] [MainThread]: dbt version: 1.10.13
[0m15:12:19.971996 [info ] [MainThread]: python version: 3.12.3
[0m15:12:19.978624 [info ] [MainThread]: python path: C:\Users\danie\attribution-os\.venv\Scripts\python.exe
[0m15:12:19.980164 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m15:12:20.581479 [info ] [MainThread]: Using profiles dir at C:\Users\danie\.dbt
[0m15:12:20.586919 [info ] [MainThread]: Using profiles.yml file at C:\Users\danie\.dbt\profiles.yml
[0m15:12:20.589527 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\danie\attribution-os\analytics\attribution_dbt\dbt_project.yml
[0m15:12:21.041711 [info ] [MainThread]: adapter type: duckdb
[0m15:12:21.045945 [info ] [MainThread]: adapter version: 1.9.6
[0m15:12:21.603574 [info ] [MainThread]: Configuration:
[0m15:12:21.612485 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:12:21.615377 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:12:21.615935 [info ] [MainThread]: Required dependencies:
[0m15:12:21.622601 [debug] [MainThread]: Executing "git --help"
[0m15:12:21.884783 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:12:21.887751 [debug] [MainThread]: STDERR: "b''"
[0m15:12:21.889357 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:12:21.891954 [info ] [MainThread]: Connection:
[0m15:12:21.893006 [info ] [MainThread]:   database: attrib
[0m15:12:21.896010 [info ] [MainThread]:   schema: main
[0m15:12:21.896010 [info ] [MainThread]:   path: C:/Users/danie/attribution-os/warehouse/attrib.duckdb
[0m15:12:21.899588 [info ] [MainThread]:   config_options: None
[0m15:12:21.899588 [info ] [MainThread]:   extensions: ['httpfs']
[0m15:12:21.902432 [info ] [MainThread]:   settings: {'s3_endpoint': 'localhost:9000', 's3_url_style': 'path', 's3_use_ssl': False, 's3_access_key_id': 'admin', 's3_secret_access_key': 'adminadmin', 's3_region': 'us-east-1'}
[0m15:12:21.905392 [info ] [MainThread]:   external_root: .
[0m15:12:21.905392 [info ] [MainThread]:   use_credential_provider: None
[0m15:12:21.908137 [info ] [MainThread]:   attach: None
[0m15:12:21.911169 [info ] [MainThread]:   filesystems: None
[0m15:12:21.911169 [info ] [MainThread]:   remote: None
[0m15:12:21.911169 [info ] [MainThread]:   plugins: None
[0m15:12:21.915702 [info ] [MainThread]:   disable_transactions: False
[0m15:12:21.915702 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m15:12:25.532210 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m15:12:37.797506 [debug] [MainThread]: Using duckdb connection "debug"
[0m15:12:37.798034 [debug] [MainThread]: On debug: select 1 as id
[0m15:12:37.801539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:48.075264 [debug] [MainThread]: SQL status: OK in 10.265 seconds
[0m15:12:48.094831 [debug] [MainThread]: On debug: Close
[0m15:12:48.103513 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:12:48.121696 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:12:48.173294 [debug] [MainThread]: Command `dbt debug` succeeded at 15:12:48.158881 after 30.90 seconds
[0m15:12:48.188658 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:12:48.221894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF3841A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF1604F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF5500B00>]}
[0m15:12:48.255036 [debug] [MainThread]: Flushing usage events
[0m15:12:51.536131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:46.768834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D134357E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D134357B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1346B3680>]}


============================== 15:14:46.808343 | 29f90c88-3e9e-46f7-8edc-d71a9eb09e18 ==============================
[0m15:14:46.808343 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:14:46.810075 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\danie\\.dbt'}
[0m15:14:48.360729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29f90c88-3e9e-46f7-8edc-d71a9eb09e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D136075310>]}
[0m15:14:48.619766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29f90c88-3e9e-46f7-8edc-d71a9eb09e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D133B31760>]}
[0m15:14:48.629173 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m15:14:49.900344 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:14:49.903909 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:14:49.905425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29f90c88-3e9e-46f7-8edc-d71a9eb09e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1368518B0>]}
[0m15:14:59.823138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29f90c88-3e9e-46f7-8edc-d71a9eb09e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D136038BF0>]}
[0m15:15:00.095119 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m15:15:00.107061 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m15:15:00.312635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29f90c88-3e9e-46f7-8edc-d71a9eb09e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D136C6C5C0>]}
[0m15:15:00.315808 [info ] [MainThread]: Found 3 models, 7 data tests, 444 macros
[0m15:15:00.321424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29f90c88-3e9e-46f7-8edc-d71a9eb09e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D136C7F8C0>]}
[0m15:15:00.328945 [info ] [MainThread]: 
[0m15:15:00.335585 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:15:00.335585 [info ] [MainThread]: 
[0m15:15:00.346547 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:15:00.370519 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib'
[0m15:15:00.770157 [debug] [ThreadPool]: Using duckdb connection "list_attrib"
[0m15:15:00.772550 [debug] [ThreadPool]: On list_attrib: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"attrib"'
    
  
  
[0m15:15:00.774988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:04.243427 [debug] [ThreadPool]: SQL status: OK in 3.468 seconds
[0m15:15:04.254201 [debug] [ThreadPool]: On list_attrib: Close
[0m15:15:04.257685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_attrib, now create_attrib_main)
[0m15:15:04.259481 [debug] [ThreadPool]: Creating schema "database: "attrib"
schema: "main"
"
[0m15:15:04.276732 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m15:15:04.277256 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='attrib'
        and type='sqlite'
    
  
[0m15:15:04.278304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:04.285298 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:15:04.289997 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m15:15:04.290503 [debug] [ThreadPool]: On create_attrib_main: BEGIN
[0m15:15:04.292524 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:15:04.292524 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m15:15:04.292524 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
    
        create schema if not exists "attrib"."main"
    
[0m15:15:04.296657 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:15:04.300677 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m15:15:04.304315 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m15:15:04.305431 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m15:15:04.307109 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:15:04.307109 [debug] [ThreadPool]: On create_attrib_main: Close
[0m15:15:04.315514 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib_main'
[0m15:15:04.341568 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m15:15:04.342664 [debug] [ThreadPool]: On list_attrib_main: BEGIN
[0m15:15:04.343213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:04.346883 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:15:04.348998 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m15:15:04.351568 [debug] [ThreadPool]: On list_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_main"} */
select
      'attrib' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'attrib'
  
[0m15:15:04.413593 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m15:15:04.421297 [debug] [ThreadPool]: On list_attrib_main: ROLLBACK
[0m15:15:04.425096 [debug] [ThreadPool]: Failed to rollback 'list_attrib_main'
[0m15:15:04.425661 [debug] [ThreadPool]: On list_attrib_main: Close
[0m15:15:04.427313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29f90c88-3e9e-46f7-8edc-d71a9eb09e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D136F884A0>]}
[0m15:15:04.429459 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:04.431110 [debug] [MainThread]: On master: BEGIN
[0m15:15:04.433176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:04.439805 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m15:15:04.442099 [debug] [MainThread]: On master: COMMIT
[0m15:15:04.442099 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:04.442099 [debug] [MainThread]: On master: COMMIT
[0m15:15:04.445160 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:15:04.446636 [debug] [MainThread]: On master: Close
[0m15:15:04.463364 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_chain_blocks
[0m15:15:04.466419 [debug] [Thread-2 (]: Began running node model.attribution_dbt.stg_chain_mempool
[0m15:15:04.466419 [debug] [Thread-3 (]: Began running node model.attribution_dbt.stg_web2
[0m15:15:04.466419 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_chain_blocks .............................. [RUN]
[0m15:15:04.470001 [info ] [Thread-2 (]: 2 of 3 START sql view model main.stg_chain_mempool ............................. [RUN]
[0m15:15:04.471457 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_chain_blocks'
[0m15:15:04.471457 [info ] [Thread-3 (]: 3 of 3 START sql view model main.stg_web2 ...................................... [RUN]
[0m15:15:04.479432 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_chain_mempool'
[0m15:15:04.482113 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_chain_blocks
[0m15:15:04.484159 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_web2'
[0m15:15:04.484159 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.stg_chain_mempool
[0m15:15:04.515595 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_blocks"
[0m15:15:04.515595 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.stg_web2
[0m15:15:04.523295 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_mempool"
[0m15:15:04.532963 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.stg_web2"
[0m15:15:04.536625 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.stg_chain_mempool
[0m15:15:04.558518 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.stg_web2
[0m15:15:04.589514 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_chain_blocks
[0m15:15:04.709407 [debug] [Thread-2 (]: Writing runtime sql for node "model.attribution_dbt.stg_chain_mempool"
[0m15:15:04.718199 [debug] [Thread-3 (]: Writing runtime sql for node "model.attribution_dbt.stg_web2"
[0m15:15:04.729326 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_chain_blocks"
[0m15:15:04.737377 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:15:04.739579 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: BEGIN
[0m15:15:04.741854 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:15:04.742993 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:15:04.744039 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:15:04.744039 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: BEGIN
[0m15:15:04.748721 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: BEGIN
[0m15:15:04.750947 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:15:04.752671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:15:04.757880 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m15:15:04.761087 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:15:04.763519 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */

  
  create view "attrib"."main"."stg_web2__dbt_tmp" as (
    ï»¿select * from read_parquet('s3://dp-silver/web2/date=*/*.parquet')
  );

[0m15:15:04.766907 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m15:15:04.769124 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:15:04.770233 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */

  
  create view "attrib"."main"."stg_chain_mempool__dbt_tmp" as (
    ï»¿select * from read_parquet('s3://dp-silver/chain_mempool/date=*/*.parquet')
  );

[0m15:15:04.775048 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m15:15:04.777044 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:15:04.778948 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */

  
  create view "attrib"."main"."stg_chain_blocks__dbt_tmp" as (
    ï»¿select * from read_parquet('s3://dp-silver/chain_blocks/date=*/*.parquet')
  );

[0m15:15:04.974578 [debug] [Thread-3 (]: SQL status: OK in 0.210 seconds
[0m15:15:04.988662 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:15:04.989690 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */
alter view "attrib"."main"."stg_web2__dbt_tmp" rename to "stg_web2"
[0m15:15:04.994007 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:15:05.023777 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: COMMIT
[0m15:15:05.024620 [debug] [Thread-2 (]: SQL status: OK in 0.253 seconds
[0m15:15:05.025722 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:15:05.032897 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:15:05.035961 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: COMMIT
[0m15:15:05.036469 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */
alter view "attrib"."main"."stg_chain_mempool__dbt_tmp" rename to "stg_chain_mempool"
[0m15:15:05.039124 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:15:05.042357 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: COMMIT
[0m15:15:05.043432 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:15:05.043966 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: COMMIT
[0m15:15:05.045022 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:15:05.059220 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:15:05.060339 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m15:15:05.061381 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */

      drop view if exists "attrib"."main"."stg_web2__dbt_backup" cascade
    
[0m15:15:05.066685 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:15:05.069480 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */

      drop view if exists "attrib"."main"."stg_chain_mempool__dbt_backup" cascade
    
[0m15:15:05.070958 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:15:05.078363 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: Close
[0m15:15:05.079461 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m15:15:05.086424 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: Close
[0m15:15:05.089796 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f90c88-3e9e-46f7-8edc-d71a9eb09e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1371B33B0>]}
[0m15:15:05.091724 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f90c88-3e9e-46f7-8edc-d71a9eb09e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1371B1340>]}
[0m15:15:05.095064 [debug] [Thread-1 (]: SQL status: OK in 0.315 seconds
[0m15:15:05.093859 [info ] [Thread-3 (]: 3 of 3 OK created sql view model main.stg_web2 ................................. [[32mOK[0m in 0.60s]
[0m15:15:05.108523 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:15:05.097109 [info ] [Thread-2 (]: 2 of 3 OK created sql view model main.stg_chain_mempool ........................ [[32mOK[0m in 0.61s]
[0m15:15:05.110815 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.stg_web2
[0m15:15:05.111543 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */
alter view "attrib"."main"."stg_chain_blocks__dbt_tmp" rename to "stg_chain_blocks"
[0m15:15:05.113624 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.stg_chain_mempool
[0m15:15:05.117888 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:15:05.120440 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: COMMIT
[0m15:15:05.121497 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:15:05.122589 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: COMMIT
[0m15:15:05.127531 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:15:05.131352 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:15:05.132495 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */

      drop view if exists "attrib"."main"."stg_chain_blocks__dbt_backup" cascade
    
[0m15:15:05.133424 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:15:05.136215 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: Close
[0m15:15:05.136789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f90c88-3e9e-46f7-8edc-d71a9eb09e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D136C6F170>]}
[0m15:15:05.137341 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_chain_blocks ......................... [[32mOK[0m in 0.67s]
[0m15:15:05.139046 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_chain_blocks
[0m15:15:05.142529 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:05.144195 [debug] [MainThread]: On master: BEGIN
[0m15:15:05.145999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:05.150038 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m15:15:05.150038 [debug] [MainThread]: On master: COMMIT
[0m15:15:05.154256 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:05.155429 [debug] [MainThread]: On master: COMMIT
[0m15:15:05.157079 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:15:05.158163 [debug] [MainThread]: On master: Close
[0m15:15:05.159276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:05.159872 [debug] [MainThread]: Connection 'create_attrib_main' was properly closed.
[0m15:15:05.161109 [debug] [MainThread]: Connection 'list_attrib_main' was properly closed.
[0m15:15:05.162387 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_chain_blocks' was properly closed.
[0m15:15:05.163582 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_chain_mempool' was properly closed.
[0m15:15:05.165219 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_web2' was properly closed.
[0m15:15:05.167536 [info ] [MainThread]: 
[0m15:15:05.169729 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.82 seconds (4.82s).
[0m15:15:05.173156 [debug] [MainThread]: Command end result
[0m15:15:05.265504 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m15:15:05.273139 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m15:15:05.298886 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\run_results.json
[0m15:15:05.300950 [info ] [MainThread]: 
[0m15:15:05.303677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:05.306297 [info ] [MainThread]: 
[0m15:15:05.307967 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:15:05.311179 [debug] [MainThread]: Command `dbt run` succeeded at 15:15:05.311179 after 19.13 seconds
[0m15:15:05.313364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D132764680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D134E4C560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1342D67B0>]}
[0m15:15:05.314750 [debug] [MainThread]: Flushing usage events
[0m15:15:07.394122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:37.517337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202BB796780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B92C22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202BC32CE90>]}


============================== 15:15:37.535302 | 1a3e48b9-5ca3-41f0-9e66-095c98199172 ==============================
[0m15:15:37.535302 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:15:37.537925 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:15:38.822604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a3e48b9-5ca3-41f0-9e66-095c98199172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202BD4EB620>]}
[0m15:15:39.084868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a3e48b9-5ca3-41f0-9e66-095c98199172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B949DCA0>]}
[0m15:15:39.115201 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m15:15:42.069725 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:15:42.726769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:15:42.728045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:15:42.856531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a3e48b9-5ca3-41f0-9e66-095c98199172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202BDCF1CD0>]}
[0m15:15:43.053710 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m15:15:43.065026 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m15:15:43.198933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a3e48b9-5ca3-41f0-9e66-095c98199172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202BE12B2F0>]}
[0m15:15:43.198933 [info ] [MainThread]: Found 3 models, 7 data tests, 444 macros
[0m15:15:43.198933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a3e48b9-5ca3-41f0-9e66-095c98199172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202BDD0DA60>]}
[0m15:15:43.208823 [info ] [MainThread]: 
[0m15:15:43.208823 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:15:43.208823 [info ] [MainThread]: 
[0m15:15:43.208823 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:15:43.227057 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib_main'
[0m15:15:43.454724 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m15:15:43.458168 [debug] [ThreadPool]: On list_attrib_main: BEGIN
[0m15:15:43.459328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:45.721586 [debug] [ThreadPool]: SQL status: OK in 2.261 seconds
[0m15:15:45.723310 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m15:15:45.725022 [debug] [ThreadPool]: On list_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_main"} */
select
      'attrib' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'attrib'
  
[0m15:15:45.892286 [debug] [ThreadPool]: SQL status: OK in 0.166 seconds
[0m15:15:45.900239 [debug] [ThreadPool]: On list_attrib_main: ROLLBACK
[0m15:15:45.900239 [debug] [ThreadPool]: Failed to rollback 'list_attrib_main'
[0m15:15:45.908579 [debug] [ThreadPool]: On list_attrib_main: Close
[0m15:15:45.914768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a3e48b9-5ca3-41f0-9e66-095c98199172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202BD4EB020>]}
[0m15:15:45.917280 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:45.917280 [debug] [MainThread]: On master: BEGIN
[0m15:15:45.917280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:45.926753 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m15:15:45.929803 [debug] [MainThread]: On master: COMMIT
[0m15:15:45.936124 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:45.937403 [debug] [MainThread]: On master: COMMIT
[0m15:15:45.939496 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:15:45.941391 [debug] [MainThread]: On master: Close
[0m15:15:45.958130 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m15:15:45.960682 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m15:15:45.962088 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m15:15:45.963515 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m15:15:45.964865 [info ] [Thread-1 (]: 1 of 7 START test not_null_stg_chain_blocks_height ............................. [RUN]
[0m15:15:45.967173 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_chain_mempool_txid .............................. [RUN]
[0m15:15:45.967173 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_web2_event_id ................................... [RUN]
[0m15:15:45.967173 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_web2_ts ......................................... [RUN]
[0m15:15:45.973857 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962'
[0m15:15:45.975612 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120'
[0m15:15:45.977391 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc'
[0m15:15:45.980320 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6'
[0m15:15:45.982335 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m15:15:45.982335 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m15:15:45.986752 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m15:15:45.987337 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m15:15:46.056437 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"
[0m15:15:46.066560 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"
[0m15:15:46.083063 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"
[0m15:15:46.096253 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"
[0m15:15:46.101100 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m15:15:46.112295 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m15:15:46.143429 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m15:15:46.143948 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m15:15:46.166562 [debug] [Thread-3 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"
[0m15:15:46.174620 [debug] [Thread-4 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"
[0m15:15:46.183393 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"
[0m15:15:46.190188 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"
[0m15:15:46.198050 [debug] [Thread-1 (]: Using duckdb connection "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"
[0m15:15:46.200277 [debug] [Thread-2 (]: Using duckdb connection "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"
[0m15:15:46.200277 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962: BEGIN
[0m15:15:46.202294 [debug] [Thread-4 (]: Using duckdb connection "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"
[0m15:15:46.204309 [debug] [Thread-3 (]: Using duckdb connection "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"
[0m15:15:46.204309 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120: BEGIN
[0m15:15:46.207163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:15:46.208685 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6: BEGIN
[0m15:15:46.208685 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc: BEGIN
[0m15:15:46.211025 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:15:46.214058 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:15:46.214565 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:15:46.219283 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m15:15:46.219283 [debug] [Thread-1 (]: Using duckdb connection "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"
[0m15:15:46.219283 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select height
from "attrib"."main"."stg_chain_blocks"
where height is null



  
  
      
    ) dbt_internal_test
[0m15:15:46.219283 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m15:15:46.219283 [debug] [Thread-2 (]: Using duckdb connection "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"
[0m15:15:46.230680 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txid
from "attrib"."main"."stg_chain_mempool"
where txid is null



  
  
      
    ) dbt_internal_test
[0m15:15:46.235820 [debug] [Thread-4 (]: SQL status: OK in 0.022 seconds
[0m15:15:46.236661 [debug] [Thread-4 (]: Using duckdb connection "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"
[0m15:15:46.240150 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ts
from "attrib"."main"."stg_web2"
where ts is null



  
  
      
    ) dbt_internal_test
[0m15:15:46.244639 [debug] [Thread-3 (]: SQL status: OK in 0.029 seconds
[0m15:15:46.247032 [debug] [Thread-3 (]: Using duckdb connection "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"
[0m15:15:46.248354 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "attrib"."main"."stg_web2"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m15:15:46.379610 [debug] [Thread-4 (]: SQL status: OK in 0.137 seconds
[0m15:15:46.380162 [debug] [Thread-3 (]: SQL status: OK in 0.131 seconds
[0m15:15:46.388608 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6: ROLLBACK
[0m15:15:46.390646 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc: ROLLBACK
[0m15:15:46.394218 [debug] [Thread-4 (]: Failed to rollback 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6'
[0m15:15:46.395229 [debug] [Thread-3 (]: Failed to rollback 'test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc'
[0m15:15:46.397319 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6: Close
[0m15:15:46.398424 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc: Close
[0m15:15:46.398424 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_web2_ts ............................................... [[32mPASS[0m in 0.42s]
[0m15:15:46.402702 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_web2_event_id ......................................... [[32mPASS[0m in 0.42s]
[0m15:15:46.404674 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m15:15:46.404674 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m15:15:46.404674 [debug] [Thread-4 (]: Began running node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m15:15:46.408771 [debug] [Thread-3 (]: Began running node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m15:15:46.408771 [debug] [Thread-1 (]: SQL status: OK in 0.185 seconds
[0m15:15:46.408771 [info ] [Thread-4 (]: 5 of 7 START test unique_stg_chain_blocks_height ............................... [RUN]
[0m15:15:46.408771 [info ] [Thread-3 (]: 6 of 7 START test unique_stg_chain_mempool_txid ................................ [RUN]
[0m15:15:46.412773 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6, now test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157)
[0m15:15:46.412773 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962: ROLLBACK
[0m15:15:46.412773 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc, now test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969)
[0m15:15:46.412773 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m15:15:46.419143 [debug] [Thread-1 (]: Failed to rollback 'test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962'
[0m15:15:46.419668 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m15:15:46.443257 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"
[0m15:15:46.444442 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962: Close
[0m15:15:46.453979 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"
[0m15:15:46.453979 [info ] [Thread-1 (]: 1 of 7 PASS not_null_stg_chain_blocks_height ................................... [[32mPASS[0m in 0.49s]
[0m15:15:46.459403 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m15:15:46.460415 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m15:15:46.467688 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m15:15:46.468770 [debug] [Thread-4 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"
[0m15:15:46.468770 [debug] [Thread-1 (]: Began running node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m15:15:46.478750 [debug] [Thread-3 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"
[0m15:15:46.485280 [debug] [Thread-4 (]: Using duckdb connection "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"
[0m15:15:46.480878 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_web2_event_id ..................................... [RUN]
[0m15:15:46.486937 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157: BEGIN
[0m15:15:46.490289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962, now test.attribution_dbt.unique_stg_web2_event_id.250b5fae02)
[0m15:15:46.490817 [debug] [Thread-3 (]: Using duckdb connection "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"
[0m15:15:46.490817 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:15:46.490817 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m15:15:46.495745 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969: BEGIN
[0m15:15:46.499467 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"
[0m15:15:46.499467 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:15:46.506177 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m15:15:46.507988 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"
[0m15:15:46.517369 [debug] [Thread-4 (]: SQL status: OK in 0.024 seconds
[0m15:15:46.519378 [debug] [Thread-1 (]: Using duckdb connection "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"
[0m15:15:46.519378 [debug] [Thread-4 (]: Using duckdb connection "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"
[0m15:15:46.521390 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_web2_event_id.250b5fae02: BEGIN
[0m15:15:46.524752 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    height as unique_field,
    count(*) as n_records

from "attrib"."main"."stg_chain_blocks"
where height is not null
group by height
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:15:46.527269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:46.533768 [debug] [Thread-3 (]: SQL status: OK in 0.030 seconds
[0m15:15:46.533768 [debug] [Thread-3 (]: Using duckdb connection "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"
[0m15:15:46.537619 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    txid as unique_field,
    count(*) as n_records

from "attrib"."main"."stg_chain_mempool"
where txid is not null
group by txid
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:15:46.541444 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m15:15:46.541444 [debug] [Thread-1 (]: Using duckdb connection "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"
[0m15:15:46.545431 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_web2_event_id.250b5fae02: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "attrib"."main"."stg_web2"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:15:46.565359 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m15:15:46.572622 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157: ROLLBACK
[0m15:15:46.573746 [debug] [Thread-4 (]: Failed to rollback 'test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157'
[0m15:15:46.577435 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157: Close
[0m15:15:46.580613 [info ] [Thread-4 (]: 5 of 7 PASS unique_stg_chain_blocks_height ..................................... [[32mPASS[0m in 0.17s]
[0m15:15:46.580613 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m15:15:46.580613 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m15:15:46.591292 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_web2_event_id.250b5fae02: ROLLBACK
[0m15:15:46.597641 [debug] [Thread-1 (]: Failed to rollback 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02'
[0m15:15:46.600008 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_web2_event_id.250b5fae02: Close
[0m15:15:46.605024 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_web2_event_id ........................................... [[32mPASS[0m in 0.11s]
[0m15:15:46.606931 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m15:15:46.684996 [debug] [Thread-2 (]: SQL status: OK in 0.454 seconds
[0m15:15:46.694045 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120: ROLLBACK
[0m15:15:46.694045 [debug] [Thread-3 (]: SQL status: OK in 0.158 seconds
[0m15:15:46.701925 [debug] [Thread-2 (]: Failed to rollback 'test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120'
[0m15:15:46.701925 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120: Close
[0m15:15:46.708219 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969: ROLLBACK
[0m15:15:46.712190 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_chain_mempool_txid .................................... [[32mPASS[0m in 0.73s]
[0m15:15:46.717209 [debug] [Thread-3 (]: Failed to rollback 'test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969'
[0m15:15:46.719146 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m15:15:46.719146 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969: Close
[0m15:15:46.724170 [info ] [Thread-3 (]: 6 of 7 PASS unique_stg_chain_mempool_txid ...................................... [[32mPASS[0m in 0.31s]
[0m15:15:46.726186 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m15:15:46.733397 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:46.735410 [debug] [MainThread]: On master: BEGIN
[0m15:15:46.735410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:46.739664 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m15:15:46.739664 [debug] [MainThread]: On master: COMMIT
[0m15:15:46.744535 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:46.747506 [debug] [MainThread]: On master: COMMIT
[0m15:15:46.750102 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:15:46.752135 [debug] [MainThread]: On master: Close
[0m15:15:46.752135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:46.752135 [debug] [MainThread]: Connection 'list_attrib_main' was properly closed.
[0m15:15:46.752135 [debug] [MainThread]: Connection 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02' was properly closed.
[0m15:15:46.757988 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120' was properly closed.
[0m15:15:46.757988 [debug] [MainThread]: Connection 'test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969' was properly closed.
[0m15:15:46.760527 [debug] [MainThread]: Connection 'test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157' was properly closed.
[0m15:15:46.762293 [info ] [MainThread]: 
[0m15:15:46.764210 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m15:15:46.772697 [debug] [MainThread]: Command end result
[0m15:15:46.864562 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m15:15:46.873196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m15:15:46.903859 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\run_results.json
[0m15:15:46.906322 [info ] [MainThread]: 
[0m15:15:46.906924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:46.909083 [info ] [MainThread]: 
[0m15:15:46.911346 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m15:15:46.914998 [debug] [MainThread]: Command `dbt test` succeeded at 15:15:46.914998 after 9.87 seconds
[0m15:15:46.916509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B9D85880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202BBE64710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202BBE653A0>]}
[0m15:15:46.916509 [debug] [MainThread]: Flushing usage events
[0m15:15:48.881613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:43.070556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002017E2323C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020100E66060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020100E65C40>]}


============================== 15:32:43.085800 | 05e9227e-ed91-494d-acf1-f2f7f1a5e71b ==============================
[0m15:32:43.085800 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:32:43.086783 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select staging --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m15:32:46.419003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05e9227e-ed91-494d-acf1-f2f7f1a5e71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002017E33F590>]}
[0m15:32:46.587054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05e9227e-ed91-494d-acf1-f2f7f1a5e71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201014ED9D0>]}
[0m15:32:46.596430 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m15:32:47.330851 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:32:47.568177 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:32:47.570241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05e9227e-ed91-494d-acf1-f2f7f1a5e71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020100E96720>]}
[0m15:32:50.357590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05e9227e-ed91-494d-acf1-f2f7f1a5e71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020101312540>]}
[0m15:32:50.526206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m15:32:50.535665 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m15:32:50.634664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05e9227e-ed91-494d-acf1-f2f7f1a5e71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201015E7470>]}
[0m15:32:50.637972 [info ] [MainThread]: Found 3 models, 7 data tests, 444 macros
[0m15:32:50.642619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05e9227e-ed91-494d-acf1-f2f7f1a5e71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020102C0DAC0>]}
[0m15:32:50.649360 [info ] [MainThread]: 
[0m15:32:50.654586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:32:50.657868 [info ] [MainThread]: 
[0m15:32:50.659394 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:32:50.676633 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib'
[0m15:32:51.048385 [debug] [ThreadPool]: Using duckdb connection "list_attrib"
[0m15:32:51.049387 [debug] [ThreadPool]: On list_attrib: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"attrib"'
    
  
  
[0m15:32:51.051385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:52.835029 [debug] [ThreadPool]: SQL status: OK in 1.783 seconds
[0m15:32:52.841235 [debug] [ThreadPool]: On list_attrib: Close
[0m15:32:52.844236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_attrib, now create_attrib_main)
[0m15:32:52.847243 [debug] [ThreadPool]: Creating schema "database: "attrib"
schema: "main"
"
[0m15:32:52.871746 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m15:32:52.871746 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='attrib'
        and type='sqlite'
    
  
[0m15:32:52.873743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:52.879103 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m15:32:52.883617 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m15:32:52.885595 [debug] [ThreadPool]: On create_attrib_main: BEGIN
[0m15:32:52.887780 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:32:52.889784 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m15:32:52.890764 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
    
        create schema if not exists "attrib"."main"
    
[0m15:32:52.893864 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:32:52.895885 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m15:32:52.896886 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m15:32:52.897875 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m15:32:52.900200 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:32:52.901220 [debug] [ThreadPool]: On create_attrib_main: Close
[0m15:32:52.903380 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib_main'
[0m15:32:52.923624 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m15:32:52.925651 [debug] [ThreadPool]: On list_attrib_main: BEGIN
[0m15:32:52.927315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:52.932394 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m15:32:52.934421 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m15:32:52.935883 [debug] [ThreadPool]: On list_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_main"} */
select
      'attrib' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'attrib'
  
[0m15:32:52.994185 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m15:32:53.002050 [debug] [ThreadPool]: On list_attrib_main: ROLLBACK
[0m15:32:53.004637 [debug] [ThreadPool]: Failed to rollback 'list_attrib_main'
[0m15:32:53.004637 [debug] [ThreadPool]: On list_attrib_main: Close
[0m15:32:53.004637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05e9227e-ed91-494d-acf1-f2f7f1a5e71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201015E4320>]}
[0m15:32:53.004637 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:53.004637 [debug] [MainThread]: On master: BEGIN
[0m15:32:53.004637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:53.017839 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m15:32:53.017839 [debug] [MainThread]: On master: COMMIT
[0m15:32:53.017839 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:53.017839 [debug] [MainThread]: On master: COMMIT
[0m15:32:53.017839 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:32:53.017839 [debug] [MainThread]: On master: Close
[0m15:32:53.032971 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_chain_blocks
[0m15:32:53.032971 [debug] [Thread-2 (]: Began running node model.attribution_dbt.stg_chain_mempool
[0m15:32:53.036448 [debug] [Thread-3 (]: Began running node model.attribution_dbt.stg_web2
[0m15:32:53.036448 [info ] [Thread-1 (]: 1 of 3 START sql table model main.stg_chain_blocks ............................. [RUN]
[0m15:32:53.036448 [info ] [Thread-2 (]: 2 of 3 START sql table model main.stg_chain_mempool ............................ [RUN]
[0m15:32:53.036448 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_chain_blocks'
[0m15:32:53.036448 [info ] [Thread-3 (]: 3 of 3 START sql table model main.stg_web2 ..................................... [RUN]
[0m15:32:53.036448 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_chain_mempool'
[0m15:32:53.036448 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_chain_blocks
[0m15:32:53.036448 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_web2'
[0m15:32:53.036448 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.stg_chain_mempool
[0m15:32:53.063531 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_blocks"
[0m15:32:53.065373 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.stg_web2
[0m15:32:53.067904 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_mempool"
[0m15:32:53.071009 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.stg_web2"
[0m15:32:53.078323 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.stg_chain_mempool
[0m15:32:53.080417 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_chain_blocks
[0m15:32:53.143733 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.stg_web2
[0m15:32:53.183830 [debug] [Thread-2 (]: Writing runtime sql for node "model.attribution_dbt.stg_chain_mempool"
[0m15:32:53.198185 [debug] [Thread-3 (]: Writing runtime sql for node "model.attribution_dbt.stg_web2"
[0m15:32:53.203144 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_chain_blocks"
[0m15:32:53.210030 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:32:53.210030 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:32:53.212790 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:32:53.213296 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: BEGIN
[0m15:32:53.215434 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: BEGIN
[0m15:32:53.216722 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: BEGIN
[0m15:32:53.216722 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:32:53.218269 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:32:53.218269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:32:53.226995 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:32:53.228123 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:32:53.230072 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */

  
    
    

    create  table
      "attrib"."main"."stg_web2__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-silver/web2/date=*/*.parquet')
    );
  
  
[0m15:32:53.236342 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m15:32:53.237387 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:32:53.238656 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */

  
    
    

    create  table
      "attrib"."main"."stg_chain_mempool__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-silver/chain_mempool/date=*/*.parquet')
    );
  
  
[0m15:32:53.242276 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m15:32:53.243267 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:32:53.245912 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */

  
    
    

    create  table
      "attrib"."main"."stg_chain_blocks__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-silver/chain_blocks/date=*/*.parquet')
    );
  
  
[0m15:32:53.623435 [debug] [Thread-3 (]: SQL status: OK in 0.392 seconds
[0m15:32:53.638530 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:32:53.638530 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_web2'
  
[0m15:32:53.642051 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:32:53.646121 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:32:53.647728 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_web2'
  
[0m15:32:53.659690 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m15:32:53.659690 [debug] [Thread-1 (]: SQL status: OK in 0.416 seconds
[0m15:32:53.672875 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:32:53.686229 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:32:53.686888 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_chain_blocks'
  
[0m15:32:53.688899 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */
alter view "attrib"."main"."stg_web2" rename to "stg_web2__dbt_backup"
[0m15:32:53.694758 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:32:53.697221 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:32:53.702745 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:32:53.711386 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:32:53.714929 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_chain_blocks'
  
[0m15:32:53.717786 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */
alter table "attrib"."main"."stg_web2__dbt_tmp" rename to "stg_web2"
[0m15:32:53.721401 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:32:53.721401 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:32:53.729793 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:32:53.783450 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: COMMIT
[0m15:32:53.783450 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */
alter view "attrib"."main"."stg_chain_blocks" rename to "stg_chain_blocks__dbt_backup"
[0m15:32:53.787163 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:32:53.789014 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: COMMIT
[0m15:32:53.790039 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:32:53.797533 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:32:53.798688 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */
alter table "attrib"."main"."stg_chain_blocks__dbt_tmp" rename to "stg_chain_blocks"
[0m15:32:53.800697 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m15:32:53.801703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:32:53.816306 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m15:32:53.820264 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: COMMIT
[0m15:32:53.825016 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */

      drop view if exists "attrib"."main"."stg_web2__dbt_backup" cascade
    
[0m15:32:53.825016 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:32:53.829549 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: COMMIT
[0m15:32:53.836133 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:32:53.842772 [debug] [Thread-3 (]: On model.attribution_dbt.stg_web2: Close
[0m15:32:53.844783 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:32:53.859360 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m15:32:53.859360 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */

      drop view if exists "attrib"."main"."stg_chain_blocks__dbt_backup" cascade
    
[0m15:32:53.862574 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05e9227e-ed91-494d-acf1-f2f7f1a5e71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010304DDC0>]}
[0m15:32:53.862574 [info ] [Thread-3 (]: 3 of 3 OK created sql table model main.stg_web2 ................................ [[32mOK[0m in 0.81s]
[0m15:32:53.866772 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.stg_web2
[0m15:32:53.868082 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:32:53.869591 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: Close
[0m15:32:53.875063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05e9227e-ed91-494d-acf1-f2f7f1a5e71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010471A870>]}
[0m15:32:53.878030 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.stg_chain_blocks ........................ [[32mOK[0m in 0.84s]
[0m15:32:53.880578 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_chain_blocks
[0m15:32:54.052125 [debug] [Thread-2 (]: SQL status: OK in 0.812 seconds
[0m15:32:54.056535 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:32:54.058482 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_chain_mempool'
  
[0m15:32:54.058482 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:32:54.066890 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:32:54.067945 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_chain_mempool'
  
[0m15:32:54.071401 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:32:54.077927 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:32:54.078930 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */
alter view "attrib"."main"."stg_chain_mempool" rename to "stg_chain_mempool__dbt_backup"
[0m15:32:54.081930 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:32:54.090696 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:32:54.093228 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */
alter table "attrib"."main"."stg_chain_mempool__dbt_tmp" rename to "stg_chain_mempool"
[0m15:32:54.095245 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:32:54.098284 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: COMMIT
[0m15:32:54.103222 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:32:54.104220 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: COMMIT
[0m15:32:54.276038 [debug] [Thread-2 (]: SQL status: OK in 0.172 seconds
[0m15:32:54.280785 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m15:32:54.284717 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */

      drop view if exists "attrib"."main"."stg_chain_mempool__dbt_backup" cascade
    
[0m15:32:54.286914 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:32:54.286914 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: Close
[0m15:32:54.286914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05e9227e-ed91-494d-acf1-f2f7f1a5e71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020102D1EAB0>]}
[0m15:32:54.297215 [info ] [Thread-2 (]: 2 of 3 OK created sql table model main.stg_chain_mempool ....................... [[32mOK[0m in 1.25s]
[0m15:32:54.299478 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.stg_chain_mempool
[0m15:32:54.308177 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:54.308177 [debug] [MainThread]: On master: BEGIN
[0m15:32:54.308177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:32:54.315704 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m15:32:54.317324 [debug] [MainThread]: On master: COMMIT
[0m15:32:54.324546 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:54.324546 [debug] [MainThread]: On master: COMMIT
[0m15:32:54.324546 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:32:54.326551 [debug] [MainThread]: On master: Close
[0m15:32:54.326551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:54.326551 [debug] [MainThread]: Connection 'create_attrib_main' was properly closed.
[0m15:32:54.328556 [debug] [MainThread]: Connection 'list_attrib_main' was properly closed.
[0m15:32:54.328556 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_chain_blocks' was properly closed.
[0m15:32:54.328556 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_chain_mempool' was properly closed.
[0m15:32:54.328556 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_web2' was properly closed.
[0m15:32:54.368791 [info ] [MainThread]: 
[0m15:32:54.370680 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m15:32:54.377472 [debug] [MainThread]: Command end result
[0m15:32:54.437305 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m15:32:54.443828 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m15:32:54.453484 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\run_results.json
[0m15:32:54.453484 [info ] [MainThread]: 
[0m15:32:54.453484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:32:54.460641 [info ] [MainThread]: 
[0m15:32:54.460641 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:32:54.463515 [debug] [MainThread]: Command `dbt run` succeeded at 15:32:54.463515 after 11.94 seconds
[0m15:32:54.463515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201003EB1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020103035340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020100E96F00>]}
[0m15:32:54.463515 [debug] [MainThread]: Flushing usage events
[0m15:32:56.407319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:34:40.545540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62E0F8DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62EFC4E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62EFC4500>]}


============================== 15:34:40.550484 | 5bda8e2c-dee3-4c2e-8077-e569d0aab23d ==============================
[0m15:34:40.550484 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:34:40.560687 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_gold_* --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:34:41.595949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bda8e2c-dee3-4c2e-8077-e569d0aab23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62C0EF5F0>]}
[0m15:34:41.782991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bda8e2c-dee3-4c2e-8077-e569d0aab23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62E8440E0>]}
[0m15:34:41.790504 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m15:34:42.772240 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:34:43.507869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:34:43.513901 [debug] [MainThread]: Partial parsing: added file: attribution_dbt://models\staging\stg_gold_attribution.sql
[0m15:34:43.520539 [debug] [MainThread]: Partial parsing: added file: attribution_dbt://models\staging\stg_gold_sessions.sql
[0m15:34:45.301176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bda8e2c-dee3-4c2e-8077-e569d0aab23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E630EC4E90>]}
[0m15:34:45.527542 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m15:34:45.562940 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m15:34:47.124387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bda8e2c-dee3-4c2e-8077-e569d0aab23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E630F6D730>]}
[0m15:34:47.128525 [info ] [MainThread]: Found 5 models, 7 data tests, 444 macros
[0m15:34:47.130112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bda8e2c-dee3-4c2e-8077-e569d0aab23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E630E7B1D0>]}
[0m15:34:47.161442 [warn ] [MainThread]: The selection criterion 'stg_gold_*' does not match any enabled nodes
[0m15:34:47.172145 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:34:47.172145 [debug] [MainThread]: Command end result
[0m15:34:47.208039 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m15:34:47.210045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m15:34:47.214079 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\run_results.json
[0m15:34:47.214079 [debug] [MainThread]: Command `dbt run` succeeded at 15:34:47.214079 after 7.31 seconds
[0m15:34:47.214079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62F020B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62EBD1DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62EBD1D60>]}
[0m15:34:47.214079 [debug] [MainThread]: Flushing usage events
[0m15:34:50.616226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:37.132537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ED86F90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ED86134A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ED600C1A0>]}


============================== 15:53:37.151031 | 8e913479-de62-45ab-851e-4a9195429596 ==============================
[0m15:53:37.151031 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:53:37.160520 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt ls --select stg_gold_*', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\danie\\.dbt'}
[0m15:53:38.947888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e913479-de62-45ab-851e-4a9195429596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ED8858F20>]}
[0m15:53:39.210445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e913479-de62-45ab-851e-4a9195429596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ED587DE20>]}
[0m15:53:39.218095 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m15:53:39.925010 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:53:40.381523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:53:40.381523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:53:40.477855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e913479-de62-45ab-851e-4a9195429596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EDA0D9D00>]}
[0m15:53:40.664347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m15:53:40.664347 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m15:53:40.812664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e913479-de62-45ab-851e-4a9195429596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EDA4303B0>]}
[0m15:53:40.815982 [info ] [MainThread]: Found 5 models, 7 data tests, 444 macros
[0m15:53:40.817213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e913479-de62-45ab-851e-4a9195429596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EDA3C1EE0>]}
[0m15:53:40.825622 [warn ] [MainThread]: The selection criterion 'stg_gold_*' does not match any enabled nodes
[0m15:53:40.827268 [warn ] [MainThread]: No nodes selected!
[0m15:53:40.828348 [debug] [MainThread]: Command `dbt ls` succeeded at 15:53:40.828348 after 4.27 seconds
[0m15:53:40.828888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ED5FB9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ED7BB3D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ED7BB1520>]}
[0m15:53:40.830017 [debug] [MainThread]: Flushing usage events
[0m15:53:42.765234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:38.992354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D98A86270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9B9B34A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9566BD40>]}


============================== 15:55:39.007553 | 8b0be188-40ab-497e-b91a-5495704f1471 ==============================
[0m15:55:39.007553 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:55:39.010491 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt ls --select stg_gold_*', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:55:40.332901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b0be188-40ab-497e-b91a-5495704f1471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9D337C20>]}
[0m15:55:40.550017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b0be188-40ab-497e-b91a-5495704f1471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9CCDFA70>]}
[0m15:55:40.554939 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m15:55:41.401859 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:55:41.936021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:41.937748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:42.089176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b0be188-40ab-497e-b91a-5495704f1471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9D4CFA10>]}
[0m15:55:42.338760 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m15:55:42.352378 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m15:55:42.495597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b0be188-40ab-497e-b91a-5495704f1471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9D8205C0>]}
[0m15:55:42.497417 [info ] [MainThread]: Found 5 models, 7 data tests, 444 macros
[0m15:55:42.499991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b0be188-40ab-497e-b91a-5495704f1471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9D4AD8B0>]}
[0m15:55:42.501666 [warn ] [MainThread]: The selection criterion 'stg_gold_*' does not match any enabled nodes
[0m15:55:42.504256 [warn ] [MainThread]: No nodes selected!
[0m15:55:42.505879 [debug] [MainThread]: Command `dbt ls` succeeded at 15:55:42.505311 after 4.03 seconds
[0m15:55:42.506972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9818ACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9BC8A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9B360CB0>]}
[0m15:55:42.508652 [debug] [MainThread]: Flushing usage events
[0m15:55:45.098862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:26.782075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216CDF56360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216D09B30B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216D09B3350>]}


============================== 16:04:26.790606 | 6c1e3996-f732-4ba2-9ef9-ce9687b43431 ==============================
[0m16:04:26.790606 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:04:26.791962 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt ls --resource-type model', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:04:27.751337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c1e3996-f732-4ba2-9ef9-ce9687b43431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216D117D550>]}
[0m16:04:27.925012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c1e3996-f732-4ba2-9ef9-ce9687b43431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216D28909E0>]}
[0m16:04:27.936354 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:04:29.496832 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:04:29.976075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:04:29.977101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:04:30.077616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c1e3996-f732-4ba2-9ef9-ce9687b43431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216D28E8F80>]}
[0m16:04:30.253789 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m16:04:30.261849 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m16:04:30.318805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c1e3996-f732-4ba2-9ef9-ce9687b43431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216D2CEC1A0>]}
[0m16:04:30.325378 [info ] [MainThread]: Found 5 models, 7 data tests, 444 macros
[0m16:04:30.326414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c1e3996-f732-4ba2-9ef9-ce9687b43431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216D299D1C0>]}
[0m16:04:30.326414 [info ] [MainThread]: attribution_dbt.staging.stg_chain_blocks
[0m16:04:30.326414 [info ] [MainThread]: attribution_dbt.staging.stg_chain_mempool
[0m16:04:30.326414 [info ] [MainThread]: attribution_dbt.staging.stg_gold_attribution
[0m16:04:30.326414 [info ] [MainThread]: attribution_dbt.staging.stg_gold_sessions
[0m16:04:30.326414 [info ] [MainThread]: attribution_dbt.staging.stg_web2
[0m16:04:30.336469 [debug] [MainThread]: Command `dbt ls` succeeded at 16:04:30.335460 after 3.99 seconds
[0m16:04:30.336469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216D0D8B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216D21E82F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216D0ABB9B0>]}
[0m16:04:30.336469 [debug] [MainThread]: Flushing usage events
[0m16:04:31.794914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:08.438568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB5B1CDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB310A720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB44B57C0>]}


============================== 16:05:08.448984 | df214c68-ce32-4913-877f-51a336cb5b17 ==============================
[0m16:05:08.448984 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:05:08.448984 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt parse --no-partial-parse', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m16:05:09.275333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df214c68-ce32-4913-877f-51a336cb5b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB8392EA0>]}
[0m16:05:09.426742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df214c68-ce32-4913-877f-51a336cb5b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB642C530>]}
[0m16:05:09.430801 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:05:10.044306 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:05:10.047304 [debug] [MainThread]: Partial parsing not enabled
[0m16:05:12.477875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df214c68-ce32-4913-877f-51a336cb5b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB8932090>]}
[0m16:05:12.488484 [info ] [MainThread]: Performance info: C:\Users\danie\attribution-os\analytics\attribution_dbt\target\perf_info.json
[0m16:05:12.656505 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m16:05:12.661680 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m16:05:12.661680 [debug] [MainThread]: Command `dbt parse` succeeded at 16:05:12.661680 after 4.52 seconds
[0m16:05:12.661680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB6A5EF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB65C2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EB65C2B10>]}
[0m16:05:12.661680 [debug] [MainThread]: Flushing usage events
[0m16:05:14.054448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:15.421011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E6E8CE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E43A13A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E446AB10>]}


============================== 16:06:15.435332 | 7851794c-d8bc-4cf0-9c36-a16ff3444691 ==============================
[0m16:06:15.435332 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:06:15.436969 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt ls --select stg_gold_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\danie\\.dbt'}
[0m16:06:16.312514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7851794c-d8bc-4cf0-9c36-a16ff3444691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E9640C50>]}
[0m16:06:16.491043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7851794c-d8bc-4cf0-9c36-a16ff3444691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E9640CB0>]}
[0m16:06:16.497828 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:06:17.041313 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:06:17.589462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:17.595178 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:17.708163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7851794c-d8bc-4cf0-9c36-a16ff3444691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E97DB590>]}
[0m16:06:17.862032 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m16:06:17.870746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m16:06:17.933328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7851794c-d8bc-4cf0-9c36-a16ff3444691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E9B1BFE0>]}
[0m16:06:17.933328 [info ] [MainThread]: Found 5 models, 7 data tests, 444 macros
[0m16:06:17.938312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7851794c-d8bc-4cf0-9c36-a16ff3444691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E971E7B0>]}
[0m16:06:17.940350 [info ] [MainThread]: attribution_dbt.staging.stg_gold_sessions
[0m16:06:17.940350 [debug] [MainThread]: Command `dbt ls` succeeded at 16:06:17.940350 after 2.91 seconds
[0m16:06:17.940350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E7295F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E97A95B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E8F89BB0>]}
[0m16:06:17.948865 [debug] [MainThread]: Flushing usage events
[0m16:06:19.568622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:56.584978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC88A33D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8BE35DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8BE36420>]}


============================== 16:07:56.601246 | fd174fa4-31d0-415b-aa1a-7ef0cdd27426 ==============================
[0m16:07:56.601246 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:07:56.603794 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select stg_gold_sessions --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:07:58.136212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd174fa4-31d0-415b-aa1a-7ef0cdd27426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8C68A240>]}
[0m16:07:58.345427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd174fa4-31d0-415b-aa1a-7ef0cdd27426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8C68B860>]}
[0m16:07:58.350659 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:07:59.495844 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:08:00.105751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:00.105751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:00.249084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd174fa4-31d0-415b-aa1a-7ef0cdd27426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8E1E7EC0>]}
[0m16:08:00.520594 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m16:08:00.540051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m16:08:00.734976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd174fa4-31d0-415b-aa1a-7ef0cdd27426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8DEEF7D0>]}
[0m16:08:00.737504 [info ] [MainThread]: Found 5 models, 7 data tests, 444 macros
[0m16:08:00.739587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd174fa4-31d0-415b-aa1a-7ef0cdd27426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8DEB94F0>]}
[0m16:08:00.746807 [info ] [MainThread]: 
[0m16:08:00.749536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:08:00.752159 [info ] [MainThread]: 
[0m16:08:00.754596 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:08:00.764417 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib'
[0m16:08:02.037211 [debug] [ThreadPool]: Using duckdb connection "list_attrib"
[0m16:08:02.040240 [debug] [ThreadPool]: On list_attrib: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"attrib"'
    
  
  
[0m16:08:02.042082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:07.227071 [debug] [ThreadPool]: SQL status: OK in 5.184 seconds
[0m16:08:07.239497 [debug] [ThreadPool]: On list_attrib: Close
[0m16:08:07.247835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_attrib, now create_attrib_main)
[0m16:08:07.251206 [debug] [ThreadPool]: Creating schema "database: "attrib"
schema: "main"
"
[0m16:08:07.296081 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:08:07.298766 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='attrib'
        and type='sqlite'
    
  
[0m16:08:07.303293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:07.322213 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:08:07.329502 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:08:07.330877 [debug] [ThreadPool]: On create_attrib_main: BEGIN
[0m16:08:07.337759 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:08:07.338803 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:08:07.340421 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
    
        create schema if not exists "attrib"."main"
    
[0m16:08:07.348393 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:08:07.355325 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m16:08:07.356832 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:08:07.362094 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m16:08:07.367983 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:08:07.369993 [debug] [ThreadPool]: On create_attrib_main: Close
[0m16:08:07.444957 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib_main'
[0m16:08:07.507041 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m16:08:07.510108 [debug] [ThreadPool]: On list_attrib_main: BEGIN
[0m16:08:07.518810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:07.553911 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m16:08:07.556758 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m16:08:07.556758 [debug] [ThreadPool]: On list_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_main"} */
select
      'attrib' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'attrib'
  
[0m16:08:08.498455 [debug] [ThreadPool]: SQL status: OK in 0.940 seconds
[0m16:08:08.556848 [debug] [ThreadPool]: On list_attrib_main: ROLLBACK
[0m16:08:08.602270 [debug] [ThreadPool]: Failed to rollback 'list_attrib_main'
[0m16:08:08.605846 [debug] [ThreadPool]: On list_attrib_main: Close
[0m16:08:08.632359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd174fa4-31d0-415b-aa1a-7ef0cdd27426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8C748080>]}
[0m16:08:08.634518 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:08.635626 [debug] [MainThread]: On master: BEGIN
[0m16:08:08.636748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:08.642250 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m16:08:08.644785 [debug] [MainThread]: On master: COMMIT
[0m16:08:08.644785 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:08.646009 [debug] [MainThread]: On master: COMMIT
[0m16:08:08.648011 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:08:08.654214 [debug] [MainThread]: On master: Close
[0m16:08:08.780321 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_gold_sessions
[0m16:08:08.782076 [info ] [Thread-1 (]: 1 of 1 START sql table model main.stg_gold_sessions ............................ [RUN]
[0m16:08:08.790320 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_gold_sessions'
[0m16:08:08.793539 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_gold_sessions
[0m16:08:08.818695 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_sessions"
[0m16:08:08.834350 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_gold_sessions
[0m16:08:08.938060 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_gold_sessions"
[0m16:08:08.954996 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:08:08.956004 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: BEGIN
[0m16:08:08.957023 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:08.962685 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:08:08.964583 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:08:08.965991 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

  
    
    

    create  table
      "attrib"."main"."stg_gold_sessions__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-gold/web2_sessions/date=*/*.parquet')
    );
  
  
[0m16:08:11.635399 [debug] [Thread-1 (]: SQL status: OK in 2.668 seconds
[0m16:08:11.757639 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:08:11.759497 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */
alter table "attrib"."main"."stg_gold_sessions__dbt_tmp" rename to "stg_gold_sessions"
[0m16:08:11.809054 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m16:08:11.926556 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: COMMIT
[0m16:08:11.928172 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:08:11.929363 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: COMMIT
[0m16:08:11.954846 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m16:08:11.987346 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:08:11.989671 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

      drop table if exists "attrib"."main"."stg_gold_sessions__dbt_backup" cascade
    
[0m16:08:11.994296 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:08:12.012853 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: Close
[0m16:08:12.049365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd174fa4-31d0-415b-aa1a-7ef0cdd27426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8958E540>]}
[0m16:08:12.072106 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.stg_gold_sessions ....................... [[32mOK[0m in 3.23s]
[0m16:08:12.099936 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_gold_sessions
[0m16:08:12.113999 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:12.114556 [debug] [MainThread]: On master: BEGIN
[0m16:08:12.118204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:08:12.134957 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m16:08:12.136145 [debug] [MainThread]: On master: COMMIT
[0m16:08:12.140358 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:12.142379 [debug] [MainThread]: On master: COMMIT
[0m16:08:12.146329 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:08:12.147290 [debug] [MainThread]: On master: Close
[0m16:08:12.148131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:12.150679 [debug] [MainThread]: Connection 'create_attrib_main' was properly closed.
[0m16:08:12.156727 [debug] [MainThread]: Connection 'list_attrib_main' was properly closed.
[0m16:08:12.159351 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_gold_sessions' was properly closed.
[0m16:08:12.165682 [info ] [MainThread]: 
[0m16:08:12.172572 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.41 seconds (11.41s).
[0m16:08:12.186187 [debug] [MainThread]: Command end result
[0m16:08:12.375043 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m16:08:12.463539 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m16:08:12.542450 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\run_results.json
[0m16:08:12.550344 [info ] [MainThread]: 
[0m16:08:12.555812 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:12.572413 [info ] [MainThread]: 
[0m16:08:12.583063 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:08:12.609256 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:12.607416 after 16.59 seconds
[0m16:08:12.631892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8BE53380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8C4D0B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8D8C6000>]}
[0m16:08:12.635572 [debug] [MainThread]: Flushing usage events
[0m16:08:16.576526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:29.274268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001862702D220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018626763170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018626762510>]}


============================== 16:10:29.283845 | 2c8fe523-27fa-42a8-9647-965b47f5257b ==============================
[0m16:10:29.283845 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:10:29.284882 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select stg_gold_attribution --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:10:30.011484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c8fe523-27fa-42a8-9647-965b47f5257b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186274DA810>]}
[0m16:10:30.145853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c8fe523-27fa-42a8-9647-965b47f5257b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018628BF3D70>]}
[0m16:10:30.146873 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:10:30.832452 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:10:31.082868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:31.084893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:31.158335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c8fe523-27fa-42a8-9647-965b47f5257b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018628D8F380>]}
[0m16:10:31.244435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m16:10:31.250090 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m16:10:31.301707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c8fe523-27fa-42a8-9647-965b47f5257b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186290D9880>]}
[0m16:10:31.301707 [info ] [MainThread]: Found 5 models, 7 data tests, 444 macros
[0m16:10:31.301707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c8fe523-27fa-42a8-9647-965b47f5257b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018628D58BC0>]}
[0m16:10:31.301707 [info ] [MainThread]: 
[0m16:10:31.311352 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:31.311352 [info ] [MainThread]: 
[0m16:10:31.311352 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:10:31.311352 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib'
[0m16:10:31.557023 [debug] [ThreadPool]: Using duckdb connection "list_attrib"
[0m16:10:31.561093 [debug] [ThreadPool]: On list_attrib: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"attrib"'
    
  
  
[0m16:10:31.561093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:32.842863 [debug] [ThreadPool]: SQL status: OK in 1.284 seconds
[0m16:10:32.848474 [debug] [ThreadPool]: On list_attrib: Close
[0m16:10:32.848474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_attrib, now create_attrib_main)
[0m16:10:32.848474 [debug] [ThreadPool]: Creating schema "database: "attrib"
schema: "main"
"
[0m16:10:32.853011 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:10:32.853011 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='attrib'
        and type='sqlite'
    
  
[0m16:10:32.853011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:32.853011 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:10:32.863890 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:10:32.864400 [debug] [ThreadPool]: On create_attrib_main: BEGIN
[0m16:10:32.864400 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:32.864400 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:10:32.864400 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
    
        create schema if not exists "attrib"."main"
    
[0m16:10:32.864400 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:10:32.864400 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m16:10:32.864400 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:10:32.864400 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m16:10:32.864400 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:10:32.864400 [debug] [ThreadPool]: On create_attrib_main: Close
[0m16:10:32.880006 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib_main'
[0m16:10:32.884619 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m16:10:32.884619 [debug] [ThreadPool]: On list_attrib_main: BEGIN
[0m16:10:32.884619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:32.884619 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:10:32.884619 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m16:10:32.884619 [debug] [ThreadPool]: On list_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_main"} */
select
      'attrib' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'attrib'
  
[0m16:10:32.942678 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m16:10:32.947007 [debug] [ThreadPool]: On list_attrib_main: ROLLBACK
[0m16:10:32.952689 [debug] [ThreadPool]: Failed to rollback 'list_attrib_main'
[0m16:10:32.952689 [debug] [ThreadPool]: On list_attrib_main: Close
[0m16:10:32.957428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c8fe523-27fa-42a8-9647-965b47f5257b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018628CDB020>]}
[0m16:10:32.958230 [debug] [MainThread]: Using duckdb connection "master"
[0m16:10:32.958230 [debug] [MainThread]: On master: BEGIN
[0m16:10:32.958230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:32.958230 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m16:10:32.958230 [debug] [MainThread]: On master: COMMIT
[0m16:10:32.958230 [debug] [MainThread]: Using duckdb connection "master"
[0m16:10:32.958230 [debug] [MainThread]: On master: COMMIT
[0m16:10:32.958230 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:10:32.958230 [debug] [MainThread]: On master: Close
[0m16:10:32.977623 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_gold_attribution
[0m16:10:32.978734 [info ] [Thread-1 (]: 1 of 1 START sql table model main.stg_gold_attribution ......................... [RUN]
[0m16:10:32.978734 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_gold_attribution'
[0m16:10:32.978734 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_gold_attribution
[0m16:10:32.990180 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_attribution"
[0m16:10:32.990180 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_gold_attribution
[0m16:10:33.049946 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_gold_attribution"
[0m16:10:33.051471 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_attribution"
[0m16:10:33.051471 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_attribution: BEGIN
[0m16:10:33.052487 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:33.054486 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:10:33.054486 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_attribution"
[0m16:10:33.056564 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_attribution: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_attribution"} */

  
    
    

    create  table
      "attrib"."main"."stg_gold_attribution__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-gold/web2_attribution/date=*/*.parquet')
    );
  
  
[0m16:10:33.253390 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_attribution"} */

  
    
    

    create  table
      "attrib"."main"."stg_gold_attribution__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-gold/web2_attribution/date=*/*.parquet')
    );
  
  
[0m16:10:33.254390 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:10:33.255390 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_attribution: ROLLBACK
[0m16:10:33.678453 [debug] [Thread-1 (]: Failed to rollback 'model.attribution_dbt.stg_gold_attribution'
[0m16:10:33.678980 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_attribution: Close
[0m16:10:33.681723 [debug] [Thread-1 (]: Runtime Error in model stg_gold_attribution (models\staging\stg_gold_attribution.sql)
  IO Error: No files found that match the pattern "s3://dp-gold/web2_attribution/date=*/*.parquet"
[0m16:10:33.686097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8fe523-27fa-42a8-9647-965b47f5257b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186267B0770>]}
[0m16:10:33.687723 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.stg_gold_attribution ................ [[31mERROR[0m in 0.70s]
[0m16:10:33.689132 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_gold_attribution
[0m16:10:33.692174 [debug] [Thread-7 (]: Marking all children of 'model.attribution_dbt.stg_gold_attribution' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_gold_attribution (models\staging\stg_gold_attribution.sql)
  IO Error: No files found that match the pattern "s3://dp-gold/web2_attribution/date=*/*.parquet".
[0m16:10:33.696934 [debug] [MainThread]: Using duckdb connection "master"
[0m16:10:33.697947 [debug] [MainThread]: On master: BEGIN
[0m16:10:33.697947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:33.701530 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:10:33.701530 [debug] [MainThread]: On master: COMMIT
[0m16:10:33.702535 [debug] [MainThread]: Using duckdb connection "master"
[0m16:10:33.702535 [debug] [MainThread]: On master: COMMIT
[0m16:10:33.703527 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:10:33.704533 [debug] [MainThread]: On master: Close
[0m16:10:33.704533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:33.705536 [debug] [MainThread]: Connection 'create_attrib_main' was properly closed.
[0m16:10:33.706055 [debug] [MainThread]: Connection 'list_attrib_main' was properly closed.
[0m16:10:33.706055 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_gold_attribution' was properly closed.
[0m16:10:33.707536 [info ] [MainThread]: 
[0m16:10:33.708044 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m16:10:33.710388 [debug] [MainThread]: Command end result
[0m16:10:33.761272 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m16:10:33.766850 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m16:10:33.785223 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\run_results.json
[0m16:10:33.788221 [info ] [MainThread]: 
[0m16:10:33.790778 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:10:33.797058 [info ] [MainThread]: 
[0m16:10:33.801274 [error] [MainThread]: [31mFailure in model stg_gold_attribution (models\staging\stg_gold_attribution.sql)[0m
[0m16:10:33.803391 [error] [MainThread]:   Runtime Error in model stg_gold_attribution (models\staging\stg_gold_attribution.sql)
  IO Error: No files found that match the pattern "s3://dp-gold/web2_attribution/date=*/*.parquet"
[0m16:10:33.805346 [info ] [MainThread]: 
[0m16:10:33.808994 [info ] [MainThread]:   compiled code at target\compiled\attribution_dbt\models\staging\stg_gold_attribution.sql
[0m16:10:33.810082 [info ] [MainThread]: 
[0m16:10:33.810082 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:10:33.813662 [debug] [MainThread]: Command `dbt run` failed at 16:10:33.813662 after 4.97 seconds
[0m16:10:33.816178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001862398AA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186290CBE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018626AF76E0>]}
[0m16:10:33.818404 [debug] [MainThread]: Flushing usage events
[0m16:10:35.197059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:12:41.917992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ADB51670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205AAB97680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205AAB96FF0>]}


============================== 16:12:41.939130 | 50dd4521-e02c-4dea-a8ae-b4b42d2459d2 ==============================
[0m16:12:41.939130 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:12:41.943808 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select stg_gold_sessions --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:12:44.830327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50dd4521-e02c-4dea-a8ae-b4b42d2459d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ADE7F2F0>]}
[0m16:12:45.105223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50dd4521-e02c-4dea-a8ae-b4b42d2459d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205AAE6DDF0>]}
[0m16:12:45.118988 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m16:12:46.347076 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:12:49.203087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:49.203756 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:49.293386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50dd4521-e02c-4dea-a8ae-b4b42d2459d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205AF701340>]}
[0m16:12:49.455341 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m16:12:49.570473 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m16:12:49.952977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50dd4521-e02c-4dea-a8ae-b4b42d2459d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205AFA693D0>]}
[0m16:12:49.955739 [info ] [MainThread]: Found 5 models, 7 data tests, 444 macros
[0m16:12:49.957828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50dd4521-e02c-4dea-a8ae-b4b42d2459d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205AFA17DA0>]}
[0m16:12:49.965372 [info ] [MainThread]: 
[0m16:12:49.967553 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:12:49.969205 [info ] [MainThread]: 
[0m16:12:49.972166 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:12:49.979917 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib'
[0m16:12:50.408465 [debug] [ThreadPool]: Using duckdb connection "list_attrib"
[0m16:12:50.410478 [debug] [ThreadPool]: On list_attrib: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"attrib"'
    
  
  
[0m16:12:50.413552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:52.782305 [debug] [ThreadPool]: SQL status: OK in 2.372 seconds
[0m16:12:52.791251 [debug] [ThreadPool]: On list_attrib: Close
[0m16:12:52.791251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_attrib, now create_attrib_main)
[0m16:12:52.803317 [debug] [ThreadPool]: Creating schema "database: "attrib"
schema: "main"
"
[0m16:12:52.854514 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:12:52.856165 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='attrib'
        and type='sqlite'
    
  
[0m16:12:52.857668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:52.862985 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:12:52.870418 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:12:52.872205 [debug] [ThreadPool]: On create_attrib_main: BEGIN
[0m16:12:52.874482 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:12:52.875244 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:12:52.877253 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
    
        create schema if not exists "attrib"."main"
    
[0m16:12:52.880785 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:12:52.884764 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m16:12:52.885221 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m16:12:52.887305 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m16:12:52.890593 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:12:52.890593 [debug] [ThreadPool]: On create_attrib_main: Close
[0m16:12:52.910955 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib_main'
[0m16:12:52.940464 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m16:12:52.943208 [debug] [ThreadPool]: On list_attrib_main: BEGIN
[0m16:12:52.944227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:52.950277 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:12:52.951572 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m16:12:52.953586 [debug] [ThreadPool]: On list_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_main"} */
select
      'attrib' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'attrib'
  
[0m16:12:53.039153 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m16:12:53.044599 [debug] [ThreadPool]: On list_attrib_main: ROLLBACK
[0m16:12:53.049495 [debug] [ThreadPool]: Failed to rollback 'list_attrib_main'
[0m16:12:53.050496 [debug] [ThreadPool]: On list_attrib_main: Close
[0m16:12:53.055963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50dd4521-e02c-4dea-a8ae-b4b42d2459d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205AFA290A0>]}
[0m16:12:53.057679 [debug] [MainThread]: Using duckdb connection "master"
[0m16:12:53.058187 [debug] [MainThread]: On master: BEGIN
[0m16:12:53.060202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:12:53.064567 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:12:53.065576 [debug] [MainThread]: On master: COMMIT
[0m16:12:53.066585 [debug] [MainThread]: Using duckdb connection "master"
[0m16:12:53.067586 [debug] [MainThread]: On master: COMMIT
[0m16:12:53.068589 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:12:53.069595 [debug] [MainThread]: On master: Close
[0m16:12:53.087117 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_gold_sessions
[0m16:12:53.089095 [info ] [Thread-1 (]: 1 of 1 START sql table model main.stg_gold_sessions ............................ [RUN]
[0m16:12:53.091502 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_gold_sessions'
[0m16:12:53.092502 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_gold_sessions
[0m16:12:53.115557 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_sessions"
[0m16:12:53.117697 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_gold_sessions
[0m16:12:53.224360 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_gold_sessions"
[0m16:12:53.228175 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:12:53.229572 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: BEGIN
[0m16:12:53.230820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:12:53.239415 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:12:53.241332 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:12:53.243295 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

  
    
    

    create  table
      "attrib"."main"."stg_gold_sessions__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-gold/web2_sessions/date=*/*.parquet')
    );
  
  
[0m16:12:54.012643 [debug] [Thread-1 (]: SQL status: OK in 0.767 seconds
[0m16:12:54.031370 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:12:54.035490 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_gold_sessions'
  
[0m16:12:54.040714 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:12:54.044796 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:12:54.044796 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_gold_sessions'
  
[0m16:12:54.058517 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:12:54.091706 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:12:54.096773 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */
alter table "attrib"."main"."stg_gold_sessions" rename to "stg_gold_sessions__dbt_backup"
[0m16:12:54.106684 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:12:54.117909 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:12:54.121323 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */
alter table "attrib"."main"."stg_gold_sessions__dbt_tmp" rename to "stg_gold_sessions"
[0m16:12:54.125768 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:12:54.224282 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: COMMIT
[0m16:12:54.227260 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:12:54.230941 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: COMMIT
[0m16:12:54.268758 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m16:12:54.291619 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m16:12:54.295085 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

      drop table if exists "attrib"."main"."stg_gold_sessions__dbt_backup" cascade
    
[0m16:12:54.303907 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:12:54.311053 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: Close
[0m16:12:54.318674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50dd4521-e02c-4dea-a8ae-b4b42d2459d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205AFAC8620>]}
[0m16:12:54.321811 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.stg_gold_sessions ....................... [[32mOK[0m in 1.22s]
[0m16:12:54.326913 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_gold_sessions
[0m16:12:54.331534 [debug] [MainThread]: Using duckdb connection "master"
[0m16:12:54.332546 [debug] [MainThread]: On master: BEGIN
[0m16:12:54.333707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:12:54.343393 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m16:12:54.344393 [debug] [MainThread]: On master: COMMIT
[0m16:12:54.346358 [debug] [MainThread]: Using duckdb connection "master"
[0m16:12:54.347251 [debug] [MainThread]: On master: COMMIT
[0m16:12:54.348879 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:12:54.350880 [debug] [MainThread]: On master: Close
[0m16:12:54.351879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:54.354806 [debug] [MainThread]: Connection 'create_attrib_main' was properly closed.
[0m16:12:54.356665 [debug] [MainThread]: Connection 'list_attrib_main' was properly closed.
[0m16:12:54.357174 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_gold_sessions' was properly closed.
[0m16:12:54.359261 [info ] [MainThread]: 
[0m16:12:54.361665 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m16:12:54.364993 [debug] [MainThread]: Command end result
[0m16:12:54.477853 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m16:12:54.484377 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m16:12:54.521716 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\run_results.json
[0m16:12:54.523706 [info ] [MainThread]: 
[0m16:12:54.525709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:54.526789 [info ] [MainThread]: 
[0m16:12:54.528304 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:12:54.531316 [debug] [MainThread]: Command `dbt run` succeeded at 16:12:54.530314 after 14.56 seconds
[0m16:12:54.532314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205AAB96FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205AF5803B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205AD1F1520>]}
[0m16:12:54.533318 [debug] [MainThread]: Flushing usage events
[0m16:12:56.286895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:01.531133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159AC1C25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159AC106F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159AECDB710>]}


============================== 10:44:01.542535 | 0ae05086-e021-4a46-a787-50f9fa738f5f ==============================
[0m10:44:01.542535 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:44:01.542535 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m10:44:02.686125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ae05086-e021-4a46-a787-50f9fa738f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159B0645C40>]}
[0m10:44:02.910536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ae05086-e021-4a46-a787-50f9fa738f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159AE7E43E0>]}
[0m10:44:02.953724 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:44:04.013996 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:44:07.226048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:07.226048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:07.326170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ae05086-e021-4a46-a787-50f9fa738f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159B0F77E00>]}
[0m10:44:07.510522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m10:44:07.561244 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m10:44:07.668768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ae05086-e021-4a46-a787-50f9fa738f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159B0E272C0>]}
[0m10:44:07.669764 [info ] [MainThread]: Found 5 models, 7 data tests, 444 macros
[0m10:44:07.671281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ae05086-e021-4a46-a787-50f9fa738f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159B0F959A0>]}
[0m10:44:07.676894 [info ] [MainThread]: 
[0m10:44:07.677892 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:07.679164 [info ] [MainThread]: 
[0m10:44:07.681170 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:44:07.693977 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib'
[0m10:44:15.106552 [debug] [ThreadPool]: Using duckdb connection "list_attrib"
[0m10:44:15.108037 [debug] [ThreadPool]: On list_attrib: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"attrib"'
    
  
  
[0m10:44:15.108037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:16.750239 [debug] [ThreadPool]: SQL status: OK in 1.641 seconds
[0m10:44:16.756850 [debug] [ThreadPool]: On list_attrib: Close
[0m10:44:16.758930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_attrib, now create_attrib_main)
[0m10:44:16.760711 [debug] [ThreadPool]: Creating schema "database: "attrib"
schema: "main"
"
[0m10:44:16.782789 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m10:44:16.782789 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='attrib'
        and type='sqlite'
    
  
[0m10:44:16.787593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:16.793381 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m10:44:16.798047 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m10:44:16.798047 [debug] [ThreadPool]: On create_attrib_main: BEGIN
[0m10:44:16.803584 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:44:16.804384 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m10:44:16.805414 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
    
        create schema if not exists "attrib"."main"
    
[0m10:44:16.809935 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:44:16.812529 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m10:44:16.814100 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m10:44:16.815191 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m10:44:16.818798 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:44:16.819563 [debug] [ThreadPool]: On create_attrib_main: Close
[0m10:44:16.824695 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib_main'
[0m10:44:16.838589 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m10:44:16.838589 [debug] [ThreadPool]: On list_attrib_main: BEGIN
[0m10:44:16.838589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:16.850602 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m10:44:16.850602 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m10:44:16.850602 [debug] [ThreadPool]: On list_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_main"} */
select
      'attrib' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'attrib'
  
[0m10:44:16.934587 [debug] [ThreadPool]: SQL status: OK in 0.079 seconds
[0m10:44:16.939120 [debug] [ThreadPool]: On list_attrib_main: ROLLBACK
[0m10:44:16.995127 [debug] [ThreadPool]: Failed to rollback 'list_attrib_main'
[0m10:44:16.997143 [debug] [ThreadPool]: On list_attrib_main: Close
[0m10:44:17.000889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ae05086-e021-4a46-a787-50f9fa738f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159AF456FF0>]}
[0m10:44:17.001899 [debug] [MainThread]: Using duckdb connection "master"
[0m10:44:17.001899 [debug] [MainThread]: On master: BEGIN
[0m10:44:17.001899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:17.008795 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m10:44:17.010276 [debug] [MainThread]: On master: COMMIT
[0m10:44:17.010783 [debug] [MainThread]: Using duckdb connection "master"
[0m10:44:17.010783 [debug] [MainThread]: On master: COMMIT
[0m10:44:17.013231 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:44:17.013231 [debug] [MainThread]: On master: Close
[0m10:44:17.029306 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_chain_blocks
[0m10:44:17.030047 [debug] [Thread-2 (]: Began running node model.attribution_dbt.stg_chain_mempool
[0m10:44:17.030553 [debug] [Thread-3 (]: Began running node model.attribution_dbt.stg_gold_attribution
[0m10:44:17.031561 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_gold_sessions
[0m10:44:17.032582 [info ] [Thread-1 (]: 1 of 5 START sql table model main.stg_chain_blocks ............................. [RUN]
[0m10:44:17.033563 [info ] [Thread-2 (]: 2 of 5 START sql table model main.stg_chain_mempool ............................ [RUN]
[0m10:44:17.035029 [info ] [Thread-3 (]: 3 of 5 START sql table model main.stg_gold_attribution ......................... [RUN]
[0m10:44:17.037031 [info ] [Thread-4 (]: 4 of 5 START sql table model main.stg_gold_sessions ............................ [RUN]
[0m10:44:17.038677 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_chain_blocks'
[0m10:44:17.038677 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_chain_mempool'
[0m10:44:17.040720 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_gold_attribution'
[0m10:44:17.040720 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_gold_sessions'
[0m10:44:17.043942 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_chain_blocks
[0m10:44:17.043942 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.stg_chain_mempool
[0m10:44:17.046553 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.stg_gold_attribution
[0m10:44:17.046553 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_gold_sessions
[0m10:44:17.064603 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_blocks"
[0m10:44:17.070841 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_mempool"
[0m10:44:17.076965 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_attribution"
[0m10:44:17.078488 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_sessions"
[0m10:44:17.086010 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.stg_gold_attribution
[0m10:44:17.086010 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.stg_chain_mempool
[0m10:44:17.117592 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_chain_blocks
[0m10:44:17.118110 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_gold_sessions
[0m10:44:17.224375 [debug] [Thread-2 (]: Writing runtime sql for node "model.attribution_dbt.stg_chain_mempool"
[0m10:44:17.225480 [debug] [Thread-3 (]: Writing runtime sql for node "model.attribution_dbt.stg_gold_attribution"
[0m10:44:17.237608 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_chain_blocks"
[0m10:44:17.244247 [debug] [Thread-4 (]: Writing runtime sql for node "model.attribution_dbt.stg_gold_sessions"
[0m10:44:17.250285 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_gold_attribution"
[0m10:44:17.251287 [debug] [Thread-3 (]: On model.attribution_dbt.stg_gold_attribution: BEGIN
[0m10:44:17.251287 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m10:44:17.255256 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m10:44:17.256265 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:44:17.257624 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: BEGIN
[0m10:44:17.258892 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: BEGIN
[0m10:44:17.259416 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:44:17.263102 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:44:17.263102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:44:17.263102 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: BEGIN
[0m10:44:17.263102 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:44:17.268567 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m10:44:17.270577 [debug] [Thread-3 (]: Using duckdb connection "model.attribution_dbt.stg_gold_attribution"
[0m10:44:17.272327 [debug] [Thread-3 (]: On model.attribution_dbt.stg_gold_attribution: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_attribution"} */

  
    
    

    create  table
      "attrib"."main"."stg_gold_attribution__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-gold/web2_attribution/date=*/*.parquet')
    );
  
  
[0m10:44:17.273944 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m10:44:17.273944 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m10:44:17.273944 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */

  
    
    

    create  table
      "attrib"."main"."stg_chain_mempool__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-silver/chain_mempool/date=*/*.parquet')
    );
  
  
[0m10:44:17.282096 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m10:44:17.283604 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m10:44:17.285126 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */

  
    
    

    create  table
      "attrib"."main"."stg_chain_blocks__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-silver/chain_blocks/date=*/*.parquet')
    );
  
  
[0m10:44:17.288097 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m10:44:17.290314 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:44:17.290314 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

  
    
    

    create  table
      "attrib"."main"."stg_gold_sessions__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-gold/web2_sessions/date=*/*.parquet')
    );
  
  
[0m10:44:17.518225 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_attribution"} */

  
    
    

    create  table
      "attrib"."main"."stg_gold_attribution__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-gold/web2_attribution/date=*/*.parquet')
    );
  
  
[0m10:44:17.518225 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m10:44:17.518225 [debug] [Thread-3 (]: On model.attribution_dbt.stg_gold_attribution: ROLLBACK
[0m10:44:17.636348 [debug] [Thread-4 (]: SQL status: OK in 0.346 seconds
[0m10:44:17.658554 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:44:17.660564 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_gold_sessions'
  
[0m10:44:17.664346 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m10:44:17.667019 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:44:17.667019 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_gold_sessions'
  
[0m10:44:17.674348 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m10:44:17.715196 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:44:17.716005 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */
alter table "attrib"."main"."stg_gold_sessions" rename to "stg_gold_sessions__dbt_backup"
[0m10:44:17.809774 [debug] [Thread-4 (]: SQL status: OK in 0.093 seconds
[0m10:44:17.821887 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:44:17.824005 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */
alter table "attrib"."main"."stg_gold_sessions__dbt_tmp" rename to "stg_gold_sessions"
[0m10:44:17.826015 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:44:17.873472 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: COMMIT
[0m10:44:17.875656 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:44:17.876484 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: COMMIT
[0m10:44:18.078311 [debug] [Thread-4 (]: SQL status: OK in 0.207 seconds
[0m10:44:18.102495 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:44:18.103566 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

      drop table if exists "attrib"."main"."stg_gold_sessions__dbt_backup" cascade
    
[0m10:44:18.330498 [debug] [Thread-4 (]: SQL status: OK in 0.227 seconds
[0m10:44:18.337795 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: Close
[0m10:44:18.342631 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae05086-e021-4a46-a787-50f9fa738f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159B13BC800>]}
[0m10:44:18.342631 [info ] [Thread-4 (]: 4 of 5 OK created sql table model main.stg_gold_sessions ....................... [[32mOK[0m in 1.30s]
[0m10:44:18.500908 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_gold_sessions
[0m10:44:18.501624 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_web2
[0m10:44:18.502391 [info ] [Thread-4 (]: 5 of 5 START sql table model main.stg_web2 ..................................... [RUN]
[0m10:44:18.504195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_gold_sessions, now model.attribution_dbt.stg_web2)
[0m10:44:18.504972 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_web2
[0m10:44:18.507631 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_web2"
[0m10:44:18.552901 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_web2
[0m10:44:18.560496 [debug] [Thread-4 (]: Writing runtime sql for node "model.attribution_dbt.stg_web2"
[0m10:44:18.560496 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m10:44:18.560496 [debug] [Thread-4 (]: On model.attribution_dbt.stg_web2: BEGIN
[0m10:44:18.560496 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:44:18.568587 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m10:44:18.568587 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m10:44:18.570900 [debug] [Thread-4 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */

  
    
    

    create  table
      "attrib"."main"."stg_web2__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-silver/web2/date=*/*.parquet')
    );
  
  
[0m10:44:19.487394 [debug] [Thread-3 (]: Failed to rollback 'model.attribution_dbt.stg_gold_attribution'
[0m10:44:19.487394 [debug] [Thread-3 (]: On model.attribution_dbt.stg_gold_attribution: Close
[0m10:44:19.492507 [debug] [Thread-3 (]: Runtime Error in model stg_gold_attribution (models\staging\stg_gold_attribution.sql)
  IO Error: No files found that match the pattern "s3://dp-gold/web2_attribution/date=*/*.parquet"
[0m10:44:19.493203 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae05086-e021-4a46-a787-50f9fa738f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159B14DF2F0>]}
[0m10:44:19.493203 [error] [Thread-3 (]: 3 of 5 ERROR creating sql table model main.stg_gold_attribution ................ [[31mERROR[0m in 2.45s]
[0m10:44:19.494730 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.stg_gold_attribution
[0m10:44:19.494730 [debug] [Thread-7 (]: Marking all children of 'model.attribution_dbt.stg_gold_attribution' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_gold_attribution (models\staging\stg_gold_attribution.sql)
  IO Error: No files found that match the pattern "s3://dp-gold/web2_attribution/date=*/*.parquet".
[0m10:44:19.770376 [debug] [Thread-4 (]: SQL status: OK in 1.198 seconds
[0m10:44:19.772376 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m10:44:19.772376 [debug] [Thread-4 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_web2'
  
[0m10:44:19.773882 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:44:19.776485 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m10:44:19.777490 [debug] [Thread-4 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_web2'
  
[0m10:44:19.778497 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:44:19.781496 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m10:44:19.782496 [debug] [Thread-4 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */
alter table "attrib"."main"."stg_web2" rename to "stg_web2__dbt_backup"
[0m10:44:19.783000 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m10:44:19.786012 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m10:44:19.787004 [debug] [Thread-4 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */
alter table "attrib"."main"."stg_web2__dbt_tmp" rename to "stg_web2"
[0m10:44:19.788900 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:44:19.789908 [debug] [Thread-4 (]: On model.attribution_dbt.stg_web2: COMMIT
[0m10:44:19.789908 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m10:44:19.789908 [debug] [Thread-4 (]: On model.attribution_dbt.stg_web2: COMMIT
[0m10:44:19.832838 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m10:44:19.837257 [debug] [Thread-4 (]: Using duckdb connection "model.attribution_dbt.stg_web2"
[0m10:44:19.838267 [debug] [Thread-4 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */

      drop table if exists "attrib"."main"."stg_web2__dbt_backup" cascade
    
[0m10:44:19.844410 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m10:44:19.846709 [debug] [Thread-4 (]: On model.attribution_dbt.stg_web2: Close
[0m10:44:19.848211 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae05086-e021-4a46-a787-50f9fa738f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159B14DFA40>]}
[0m10:44:19.849860 [info ] [Thread-4 (]: 5 of 5 OK created sql table model main.stg_web2 ................................ [[32mOK[0m in 1.34s]
[0m10:44:19.851708 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_web2
[0m10:44:19.921526 [debug] [Thread-1 (]: SQL status: OK in 2.635 seconds
[0m10:44:19.924306 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m10:44:19.925356 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_chain_blocks'
  
[0m10:44:19.926897 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:44:19.929631 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m10:44:19.930168 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_chain_blocks'
  
[0m10:44:19.932115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:44:19.941776 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m10:44:19.942817 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */
alter table "attrib"."main"."stg_chain_blocks" rename to "stg_chain_blocks__dbt_backup"
[0m10:44:19.945663 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:44:19.952934 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m10:44:19.953463 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */
alter table "attrib"."main"."stg_chain_blocks__dbt_tmp" rename to "stg_chain_blocks"
[0m10:44:19.955050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:44:19.959207 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: COMMIT
[0m10:44:19.960312 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m10:44:19.961369 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: COMMIT
[0m10:44:19.965812 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:44:19.974726 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_chain_blocks"
[0m10:44:19.975332 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */

      drop table if exists "attrib"."main"."stg_chain_blocks__dbt_backup" cascade
    
[0m10:44:19.982783 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:44:19.989301 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: Close
[0m10:44:19.991348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae05086-e021-4a46-a787-50f9fa738f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159B143CD70>]}
[0m10:44:19.992837 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.stg_chain_blocks ........................ [[32mOK[0m in 2.95s]
[0m10:44:19.995026 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_chain_blocks
[0m10:44:20.139532 [debug] [Thread-2 (]: SQL status: OK in 2.863 seconds
[0m10:44:20.143789 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m10:44:20.143789 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_chain_mempool'
  
[0m10:44:20.146766 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:44:20.148698 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m10:44:20.150828 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_chain_mempool'
  
[0m10:44:20.154323 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:44:20.157853 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m10:44:20.157853 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */
alter table "attrib"."main"."stg_chain_mempool" rename to "stg_chain_mempool__dbt_backup"
[0m10:44:20.164204 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:44:20.171519 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m10:44:20.172027 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */
alter table "attrib"."main"."stg_chain_mempool__dbt_tmp" rename to "stg_chain_mempool"
[0m10:44:20.174035 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:44:20.176464 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: COMMIT
[0m10:44:20.176464 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m10:44:20.176464 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: COMMIT
[0m10:44:20.408459 [debug] [Thread-2 (]: SQL status: OK in 0.228 seconds
[0m10:44:20.420474 [debug] [Thread-2 (]: Using duckdb connection "model.attribution_dbt.stg_chain_mempool"
[0m10:44:20.422402 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */

      drop table if exists "attrib"."main"."stg_chain_mempool__dbt_backup" cascade
    
[0m10:44:20.874936 [debug] [Thread-2 (]: SQL status: OK in 0.451 seconds
[0m10:44:20.878979 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: Close
[0m10:44:20.879980 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae05086-e021-4a46-a787-50f9fa738f5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159B1499E50>]}
[0m10:44:20.881637 [info ] [Thread-2 (]: 2 of 5 OK created sql table model main.stg_chain_mempool ....................... [[32mOK[0m in 3.84s]
[0m10:44:20.884077 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.stg_chain_mempool
[0m10:44:20.886718 [debug] [MainThread]: Using duckdb connection "master"
[0m10:44:20.886718 [debug] [MainThread]: On master: BEGIN
[0m10:44:20.886718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:20.891738 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m10:44:20.891738 [debug] [MainThread]: On master: COMMIT
[0m10:44:20.891738 [debug] [MainThread]: Using duckdb connection "master"
[0m10:44:20.896007 [debug] [MainThread]: On master: COMMIT
[0m10:44:20.897590 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:44:20.898144 [debug] [MainThread]: On master: Close
[0m10:44:20.898686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:20.899233 [debug] [MainThread]: Connection 'create_attrib_main' was properly closed.
[0m10:44:20.899233 [debug] [MainThread]: Connection 'list_attrib_main' was properly closed.
[0m10:44:20.899759 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_chain_blocks' was properly closed.
[0m10:44:20.900286 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_chain_mempool' was properly closed.
[0m10:44:20.901333 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_gold_attribution' was properly closed.
[0m10:44:20.901875 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_web2' was properly closed.
[0m10:44:20.903214 [info ] [MainThread]: 
[0m10:44:20.903756 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 13.22 seconds (13.22s).
[0m10:44:20.907118 [debug] [MainThread]: Command end result
[0m10:44:20.979966 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m10:44:20.987482 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m10:44:21.007813 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\run_results.json
[0m10:44:21.008320 [info ] [MainThread]: 
[0m10:44:21.010018 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:44:21.011621 [info ] [MainThread]: 
[0m10:44:21.012777 [error] [MainThread]: [31mFailure in model stg_gold_attribution (models\staging\stg_gold_attribution.sql)[0m
[0m10:44:21.015053 [error] [MainThread]:   Runtime Error in model stg_gold_attribution (models\staging\stg_gold_attribution.sql)
  IO Error: No files found that match the pattern "s3://dp-gold/web2_attribution/date=*/*.parquet"
[0m10:44:21.016798 [info ] [MainThread]: 
[0m10:44:21.018490 [info ] [MainThread]:   compiled code at target\compiled\attribution_dbt\models\staging\stg_gold_attribution.sql
[0m10:44:21.020178 [info ] [MainThread]: 
[0m10:44:21.021339 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m10:44:21.023347 [debug] [MainThread]: Command `dbt run` failed at 10:44:21.023347 after 19.87 seconds
[0m10:44:21.025658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159AECDB710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159AEDD6EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159AEDD6B70>]}
[0m10:44:21.025658 [debug] [MainThread]: Flushing usage events
[0m10:44:22.841764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:43.562033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B5421280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B2826150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B53F6840>]}


============================== 10:49:43.584982 | 392792e4-e217-4bc1-8d8b-dd5711eff274 ==============================
[0m10:49:43.584982 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:49:43.587223 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select stg_gold_sessions --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\danie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m10:49:45.376538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '392792e4-e217-4bc1-8d8b-dd5711eff274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B292F4D0>]}
[0m10:49:45.696533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '392792e4-e217-4bc1-8d8b-dd5711eff274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B29FDD90>]}
[0m10:49:45.710951 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m10:49:47.023175 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:49:47.677469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:49:47.679130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:49:47.832453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '392792e4-e217-4bc1-8d8b-dd5711eff274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B75C7FB0>]}
[0m10:49:48.101029 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m10:49:48.118461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m10:49:48.295358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '392792e4-e217-4bc1-8d8b-dd5711eff274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B7473590>]}
[0m10:49:48.300523 [info ] [MainThread]: Found 5 models, 7 data tests, 444 macros
[0m10:49:48.303113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392792e4-e217-4bc1-8d8b-dd5711eff274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B721BE60>]}
[0m10:49:48.314633 [info ] [MainThread]: 
[0m10:49:48.320126 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:49:48.322933 [info ] [MainThread]: 
[0m10:49:48.326467 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:49:48.332795 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib'
[0m10:49:49.620768 [debug] [ThreadPool]: Using duckdb connection "list_attrib"
[0m10:49:49.623429 [debug] [ThreadPool]: On list_attrib: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"attrib"'
    
  
  
[0m10:49:49.626152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:52.779110 [debug] [ThreadPool]: SQL status: OK in 3.153 seconds
[0m10:49:52.785338 [debug] [ThreadPool]: On list_attrib: Close
[0m10:49:52.788894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_attrib, now create_attrib_main)
[0m10:49:52.792686 [debug] [ThreadPool]: Creating schema "database: "attrib"
schema: "main"
"
[0m10:49:52.811150 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m10:49:52.814022 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='attrib'
        and type='sqlite'
    
  
[0m10:49:52.816663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:52.826673 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m10:49:52.832902 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m10:49:52.835001 [debug] [ThreadPool]: On create_attrib_main: BEGIN
[0m10:49:52.836574 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:52.837636 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m10:49:52.839488 [debug] [ThreadPool]: On create_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_main"} */

    
    
        create schema if not exists "attrib"."main"
    
[0m10:49:52.843888 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:49:52.846590 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m10:49:52.848264 [debug] [ThreadPool]: Using duckdb connection "create_attrib_main"
[0m10:49:52.848965 [debug] [ThreadPool]: On create_attrib_main: COMMIT
[0m10:49:52.852154 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:52.853775 [debug] [ThreadPool]: On create_attrib_main: Close
[0m10:49:52.881596 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_attrib_main'
[0m10:49:52.929978 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m10:49:52.933340 [debug] [ThreadPool]: On list_attrib_main: BEGIN
[0m10:49:52.934052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:52.940645 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m10:49:52.943733 [debug] [ThreadPool]: Using duckdb connection "list_attrib_main"
[0m10:49:52.944790 [debug] [ThreadPool]: On list_attrib_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_main"} */
select
      'attrib' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'attrib'
  
[0m10:49:53.111855 [debug] [ThreadPool]: SQL status: OK in 0.164 seconds
[0m10:49:53.119173 [debug] [ThreadPool]: On list_attrib_main: ROLLBACK
[0m10:49:53.132852 [debug] [ThreadPool]: Failed to rollback 'list_attrib_main'
[0m10:49:53.137565 [debug] [ThreadPool]: On list_attrib_main: Close
[0m10:49:53.150164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392792e4-e217-4bc1-8d8b-dd5711eff274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B53F6E70>]}
[0m10:49:53.154088 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:53.155411 [debug] [MainThread]: On master: BEGIN
[0m10:49:53.157019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:49:53.161997 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m10:49:53.164161 [debug] [MainThread]: On master: COMMIT
[0m10:49:53.165277 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:53.166482 [debug] [MainThread]: On master: COMMIT
[0m10:49:53.168695 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:49:53.169756 [debug] [MainThread]: On master: Close
[0m10:49:53.187580 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_gold_sessions
[0m10:49:53.190781 [info ] [Thread-1 (]: 1 of 1 START sql table model main.stg_gold_sessions ............................ [RUN]
[0m10:49:53.192509 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.attribution_dbt.stg_gold_sessions'
[0m10:49:53.194227 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_gold_sessions
[0m10:49:53.217689 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_sessions"
[0m10:49:53.223732 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_gold_sessions
[0m10:49:53.373279 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_gold_sessions"
[0m10:49:53.379567 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:49:53.380942 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: BEGIN
[0m10:49:53.382344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:49:53.388011 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:53.390758 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:49:53.393053 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

  
    
    

    create  table
      "attrib"."main"."stg_gold_sessions__dbt_tmp"
  
    as (
      ï»¿select * from read_parquet('s3://dp-gold/web2_sessions/date=*/*.parquet')
    );
  
  
[0m10:49:54.226010 [debug] [Thread-1 (]: SQL status: OK in 0.832 seconds
[0m10:49:54.254857 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:49:54.257272 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_gold_sessions'
  
[0m10:49:54.262574 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:49:54.269420 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:49:54.271534 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_gold_sessions'
  
[0m10:49:54.284698 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:49:54.307534 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:49:54.309347 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */
alter table "attrib"."main"."stg_gold_sessions" rename to "stg_gold_sessions__dbt_backup"
[0m10:49:54.317134 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:54.327348 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:49:54.329268 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */
alter table "attrib"."main"."stg_gold_sessions__dbt_tmp" rename to "stg_gold_sessions"
[0m10:49:54.333406 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:54.404270 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: COMMIT
[0m10:49:54.406303 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:49:54.408830 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: COMMIT
[0m10:49:54.418852 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:49:54.443197 [debug] [Thread-1 (]: Using duckdb connection "model.attribution_dbt.stg_gold_sessions"
[0m10:49:54.445484 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

      drop table if exists "attrib"."main"."stg_gold_sessions__dbt_backup" cascade
    
[0m10:49:54.455193 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:49:54.467370 [debug] [Thread-1 (]: On model.attribution_dbt.stg_gold_sessions: Close
[0m10:49:54.476752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392792e4-e217-4bc1-8d8b-dd5711eff274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B6A7D220>]}
[0m10:49:54.479600 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.stg_gold_sessions ....................... [[32mOK[0m in 1.28s]
[0m10:49:54.484874 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_gold_sessions
[0m10:49:54.491264 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:54.493564 [debug] [MainThread]: On master: BEGIN
[0m10:49:54.495284 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:49:54.502205 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m10:49:54.502205 [debug] [MainThread]: On master: COMMIT
[0m10:49:54.504214 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:54.506391 [debug] [MainThread]: On master: COMMIT
[0m10:49:54.508424 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:49:54.508935 [debug] [MainThread]: On master: Close
[0m10:49:54.511499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:54.513187 [debug] [MainThread]: Connection 'create_attrib_main' was properly closed.
[0m10:49:54.514709 [debug] [MainThread]: Connection 'list_attrib_main' was properly closed.
[0m10:49:54.516357 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_gold_sessions' was properly closed.
[0m10:49:54.518579 [info ] [MainThread]: 
[0m10:49:54.521379 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.19 seconds (6.19s).
[0m10:49:54.525495 [debug] [MainThread]: Command end result
[0m10:49:54.615858 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\manifest.json
[0m10:49:54.623247 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\semantic_manifest.json
[0m10:49:54.654990 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\run_results.json
[0m10:49:54.654990 [info ] [MainThread]: 
[0m10:49:54.660080 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:54.663429 [info ] [MainThread]: 
[0m10:49:54.667525 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:49:54.671580 [debug] [MainThread]: Command `dbt run` succeeded at 10:49:54.671580 after 12.93 seconds
[0m10:49:54.673144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B588CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B6B156A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B5A0F230>]}
[0m10:49:54.675197 [debug] [MainThread]: Flushing usage events
[0m10:49:57.248592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:29.202876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBCC74CEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBCE766AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBCF1D8FB0>]}


============================== 12:05:29.211234 | 029c5797-56fc-4724-9fe9-13736ffba827 ==============================
[0m12:05:29.211234 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:05:29.211234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:05:29.252816 [info ] [MainThread]: dbt version: 1.8.9
[0m12:05:29.252816 [info ] [MainThread]: python version: 3.12.3
[0m12:05:29.257218 [info ] [MainThread]: python path: C:\Users\danie\attribution-os\.venv\Scripts\python.exe
[0m12:05:29.257218 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m12:05:29.263502 [info ] [MainThread]: Using profiles dir at C:\Users\danie\attribution-os\analytics\attribution_dbt\profiles
[0m12:05:29.264917 [info ] [MainThread]: Using profiles.yml file at C:\Users\danie\attribution-os\analytics\attribution_dbt\profiles\profiles.yml
[0m12:05:29.264917 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\danie\attribution-os\analytics\attribution_dbt\dbt_project.yml
[0m12:05:29.429114 [info ] [MainThread]: Configuration:
[0m12:05:29.429114 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:05:29.431121 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:05:29.433134 [info ] [MainThread]: Required dependencies:
[0m12:05:29.433134 [debug] [MainThread]: Executing "git --help"
[0m12:05:29.528680 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:05:29.528680 [debug] [MainThread]: STDERR: "b''"
[0m12:05:29.530438 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:05:29.531191 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:05:29.532730 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:05:29.532730 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'attribution_os'


[0m12:05:29.534810 [debug] [MainThread]: Command `dbt debug` failed at 12:05:29.534810 after 0.61 seconds
[0m12:05:29.536820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBCF14BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBCF1D8FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBCF4A2720>]}
[0m12:05:29.536820 [debug] [MainThread]: Flushing usage events
[0m12:08:56.769535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465C479040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465F083BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465F080620>]}


============================== 12:08:56.779827 | 4af7cc50-a5be-49a9-8c44-86fd8d056b28 ==============================
[0m12:08:56.779827 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:08:56.779827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:08:56.822235 [info ] [MainThread]: dbt version: 1.8.9
[0m12:08:56.826369 [info ] [MainThread]: python version: 3.12.3
[0m12:08:56.826369 [info ] [MainThread]: python path: C:\Users\danie\attribution-os\.venv\Scripts\python.exe
[0m12:08:56.828378 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m12:08:56.947652 [info ] [MainThread]: Using profiles dir at C:\Users\danie\attribution-os\analytics\attribution_dbt\profiles
[0m12:08:56.947652 [info ] [MainThread]: Using profiles.yml file at C:\Users\danie\attribution-os\analytics\attribution_dbt\profiles\profiles.yml
[0m12:08:56.947652 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\danie\attribution-os\analytics\attribution_dbt\dbt_project.yml
[0m12:08:56.947652 [info ] [MainThread]: adapter type: postgres
[0m12:08:56.947652 [info ] [MainThread]: adapter version: 1.8.2
[0m12:08:57.072725 [info ] [MainThread]: Configuration:
[0m12:08:57.073820 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:08:57.075096 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:08:57.076332 [info ] [MainThread]: Required dependencies:
[0m12:08:57.077435 [debug] [MainThread]: Executing "git --help"
[0m12:08:57.160928 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:08:57.160928 [debug] [MainThread]: STDERR: "b''"
[0m12:08:57.164720 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:08:57.164720 [info ] [MainThread]: Connection:
[0m12:08:57.164720 [info ] [MainThread]:   host: localhost
[0m12:08:57.166877 [info ] [MainThread]:   port: 5433
[0m12:08:57.166877 [info ] [MainThread]:   user: attrib
[0m12:08:57.168015 [info ] [MainThread]:   database: attrib_analytics
[0m12:08:57.168015 [info ] [MainThread]:   schema: public
[0m12:08:57.168015 [info ] [MainThread]:   connect_timeout: 10
[0m12:08:57.170736 [info ] [MainThread]:   role: None
[0m12:08:57.171251 [info ] [MainThread]:   search_path: None
[0m12:08:57.171251 [info ] [MainThread]:   keepalives_idle: 0
[0m12:08:57.172404 [info ] [MainThread]:   sslmode: None
[0m12:08:57.173414 [info ] [MainThread]:   sslcert: None
[0m12:08:57.173414 [info ] [MainThread]:   sslkey: None
[0m12:08:57.174926 [info ] [MainThread]:   sslrootcert: None
[0m12:08:57.174926 [info ] [MainThread]:   application_name: dbt
[0m12:08:57.175761 [info ] [MainThread]:   retries: 1
[0m12:08:57.175761 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:08:57.693719 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:09:04.877415 [debug] [MainThread]: Using postgres connection "debug"
[0m12:09:04.877415 [debug] [MainThread]: On debug: select 1 as id
[0m12:09:04.877415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:05.031605 [debug] [MainThread]: SQL status: SELECT 1 in 0.153 seconds
[0m12:09:05.034354 [debug] [MainThread]: On debug: Close
[0m12:09:05.036413 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:09:05.036413 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:09:05.040513 [debug] [MainThread]: Command `dbt debug` succeeded at 12:09:05.040049 after 8.54 seconds
[0m12:09:05.041703 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:09:05.042340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465F0E63F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465E22DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465E22DE80>]}
[0m12:09:05.043323 [debug] [MainThread]: Flushing usage events
[0m12:48:50.705138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1A44717F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1A45A3E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1A45A3B30>]}


============================== 12:48:50.722360 | ee0f88f0-9912-4321-85bd-02d2144542f5 ==============================
[0m12:48:50.722360 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:48:50.722360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:50.771208 [info ] [MainThread]: dbt version: 1.8.9
[0m12:48:50.771208 [info ] [MainThread]: python version: 3.12.3
[0m12:48:50.771208 [info ] [MainThread]: python path: C:\Users\danie\attribution-os\.venv\Scripts\python.exe
[0m12:48:50.774572 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m12:48:50.897734 [info ] [MainThread]: Using profiles dir at C:\Users\danie\attribution-os\analytics\attribution_dbt\profiles
[0m12:48:50.898277 [info ] [MainThread]: Using profiles.yml file at C:\Users\danie\attribution-os\analytics\attribution_dbt\profiles\profiles.yml
[0m12:48:50.898277 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\danie\attribution-os\analytics\attribution_dbt\dbt_project.yml
[0m12:48:50.904000 [info ] [MainThread]: adapter type: postgres
[0m12:48:50.904000 [info ] [MainThread]: adapter version: 1.8.2
[0m12:48:51.013755 [info ] [MainThread]: Configuration:
[0m12:48:51.013755 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:48:51.015262 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:48:51.015262 [info ] [MainThread]: Required dependencies:
[0m12:48:51.015262 [debug] [MainThread]: Executing "git --help"
[0m12:48:51.121663 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:48:51.121663 [debug] [MainThread]: STDERR: "b''"
[0m12:48:51.121663 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:48:51.121663 [info ] [MainThread]: Connection:
[0m12:48:51.124815 [info ] [MainThread]:   host: localhost
[0m12:48:51.124815 [info ] [MainThread]:   port: 5433
[0m12:48:51.126822 [info ] [MainThread]:   user: attrib
[0m12:48:51.127496 [info ] [MainThread]:   database: attrib_analytics
[0m12:48:51.127496 [info ] [MainThread]:   schema: public
[0m12:48:51.129536 [info ] [MainThread]:   connect_timeout: 10
[0m12:48:51.129536 [info ] [MainThread]:   role: None
[0m12:48:51.129536 [info ] [MainThread]:   search_path: None
[0m12:48:51.131276 [info ] [MainThread]:   keepalives_idle: 0
[0m12:48:51.131276 [info ] [MainThread]:   sslmode: None
[0m12:48:51.131276 [info ] [MainThread]:   sslcert: None
[0m12:48:51.131276 [info ] [MainThread]:   sslkey: None
[0m12:48:51.131276 [info ] [MainThread]:   sslrootcert: None
[0m12:48:51.131276 [info ] [MainThread]:   application_name: dbt
[0m12:48:51.131276 [info ] [MainThread]:   retries: 1
[0m12:48:51.131276 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:48:51.640403 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:48:51.768448 [debug] [MainThread]: Using postgres connection "debug"
[0m12:48:51.771228 [debug] [MainThread]: On debug: select 1 as id
[0m12:48:51.771228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:51.892124 [debug] [MainThread]: SQL status: SELECT 1 in 0.122 seconds
[0m12:48:51.892124 [debug] [MainThread]: On debug: Close
[0m12:48:51.896245 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:48:51.896245 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:48:51.898703 [debug] [MainThread]: Command `dbt debug` succeeded at 12:48:51.898703 after 1.53 seconds
[0m12:48:51.898703 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:48:51.898703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1A0944C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1A40B7E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1A4113620>]}
[0m12:48:51.898703 [debug] [MainThread]: Flushing usage events
[0m12:48:56.786755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEA146FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEA144B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEA144BF0>]}


============================== 12:48:56.793912 | 1ab47918-8ece-4502-b0b0-262dae21ebd2 ==============================
[0m12:48:56.793912 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:48:56.793912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m12:48:57.176039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ab47918-8ece-4502-b0b0-262dae21ebd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEA24B890>]}
[0m12:48:57.260920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ab47918-8ece-4502-b0b0-262dae21ebd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BE7C95FA0>]}
[0m12:48:57.261662 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:48:57.617129 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:48:57.805203 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:48:57.806243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ab47918-8ece-4502-b0b0-262dae21ebd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BE994FE90>]}
[0m12:49:02.412619 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:49:02.412619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ab47918-8ece-4502-b0b0-262dae21ebd2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEBB257C0>]}
[0m12:49:02.905416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ab47918-8ece-4502-b0b0-262dae21ebd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEBD6B440>]}
[0m12:49:03.103126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ab47918-8ece-4502-b0b0-262dae21ebd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEBBBCE30>]}
[0m12:49:03.103126 [info ] [MainThread]: Found 7 models, 11 data tests, 1 source, 433 macros
[0m12:49:03.109716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ab47918-8ece-4502-b0b0-262dae21ebd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BE9F1B320>]}
[0m12:49:03.113482 [info ] [MainThread]: 
[0m12:49:03.115232 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:49:03.122046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m12:49:03.210205 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:49:03.210205 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m12:49:03.210205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:03.259005 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m12:49:03.260038 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:49:03.261188 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:49:03.305205 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m12:49:03.309627 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m12:49:03.309627 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m12:49:03.322042 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:03.323103 [debug] [MainThread]: On master: BEGIN
[0m12:49:03.323103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:03.350987 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m12:49:03.351840 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:03.351840 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:49:03.405529 [debug] [MainThread]: SQL status: SELECT 0 in 0.051 seconds
[0m12:49:03.408167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ab47918-8ece-4502-b0b0-262dae21ebd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BE7AC47A0>]}
[0m12:49:03.408167 [debug] [MainThread]: On master: ROLLBACK
[0m12:49:03.409676 [debug] [MainThread]: On master: Close
[0m12:49:03.409676 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:49:03.412792 [info ] [MainThread]: 
[0m12:49:03.416039 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_chain_blocks
[0m12:49:03.416039 [debug] [Thread-2 (]: Began running node model.attribution_dbt.stg_chain_mempool
[0m12:49:03.416039 [debug] [Thread-3 (]: Began running node model.attribution_dbt.stg_gold_attribution
[0m12:49:03.416039 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_gold_sessions
[0m12:49:03.426261 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_chain_blocks'
[0m12:49:03.426261 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_chain_mempool'
[0m12:49:03.426261 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_gold_attribution'
[0m12:49:03.426261 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_gold_sessions'
[0m12:49:03.426261 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_chain_blocks
[0m12:49:03.429938 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.stg_chain_mempool
[0m12:49:03.430662 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.stg_gold_attribution
[0m12:49:03.430662 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_gold_sessions
[0m12:49:03.436828 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_blocks"
[0m12:49:03.444205 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_mempool"
[0m12:49:03.447714 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_attribution"
[0m12:49:03.450045 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_sessions"
[0m12:49:03.450045 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_gold_sessions
[0m12:49:03.455748 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_gold_sessions
[0m12:49:03.455748 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.stg_chain_mempool
[0m12:49:03.457273 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_orders
[0m12:49:03.457273 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.stg_gold_attribution
[0m12:49:03.457273 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_chain_blocks
[0m12:49:03.457273 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.stg_chain_mempool
[0m12:49:03.457273 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_gold_sessions, now model.attribution_dbt.stg_orders)
[0m12:49:03.461977 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.stg_gold_attribution
[0m12:49:03.462571 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_chain_blocks
[0m12:49:03.462571 [debug] [Thread-2 (]: Began running node model.attribution_dbt.stg_web2
[0m12:49:03.462571 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_orders
[0m12:49:03.462571 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m12:49:03.462571 [debug] [Thread-1 (]: Began running node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m12:49:03.462571 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_chain_mempool, now model.attribution_dbt.stg_web2)
[0m12:49:03.469852 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m12:49:03.469852 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_gold_attribution, now test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120)
[0m12:49:03.469852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_chain_blocks, now test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969)
[0m12:49:03.469852 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.stg_web2
[0m12:49:03.469852 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m12:49:03.469852 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m12:49:03.475297 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_orders
[0m12:49:03.475812 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.stg_web2"
[0m12:49:03.488674 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"
[0m12:49:03.494972 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_orders
[0m12:49:03.502092 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"
[0m12:49:03.504098 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m12:49:03.504098 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.stg_web2
[0m12:49:03.506902 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_orders, now test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962)
[0m12:49:03.508314 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.stg_web2
[0m12:49:03.508314 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m12:49:03.509848 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m12:49:03.510617 [debug] [Thread-2 (]: Began running node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m12:49:03.511163 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m12:49:03.511163 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m12:49:03.513709 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"
[0m12:49:03.513709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_web2, now test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157)
[0m12:49:03.513709 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m12:49:03.519634 [debug] [Thread-3 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m12:49:03.519634 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m12:49:03.519634 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m12:49:03.519634 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120, now model.attribution_dbt.mart_revenue_daily)
[0m12:49:03.526372 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m12:49:03.526372 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"
[0m12:49:03.526372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969, now test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m12:49:03.529770 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m12:49:03.529770 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m12:49:03.529770 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m12:49:03.529770 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m12:49:03.529770 [debug] [Thread-4 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m12:49:03.529770 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m12:49:03.540152 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:49:03.542581 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962, now test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m12:49:03.544811 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m12:49:03.544811 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m12:49:03.544811 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m12:49:03.548306 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m12:49:03.550313 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m12:49:03.550313 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m12:49:03.550313 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m12:49:03.557756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157, now test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc)
[0m12:49:03.558793 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m12:49:03.560801 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m12:49:03.560801 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m12:49:03.560801 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_revenue_daily, now test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6)
[0m12:49:03.560801 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m12:49:03.562637 [debug] [Thread-1 (]: Began running node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m12:49:03.562637 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"
[0m12:49:03.562637 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m12:49:03.570121 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m12:49:03.571131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.attribution_dbt.unique_stg_web2_event_id.250b5fae02)
[0m12:49:03.577486 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"
[0m12:49:03.577486 [debug] [Thread-4 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m12:49:03.577486 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m12:49:03.577486 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m12:49:03.577486 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a, now test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f)
[0m12:49:03.584298 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"
[0m12:49:03.584298 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m12:49:03.584298 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m12:49:03.589045 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m12:49:03.589552 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m12:49:03.589552 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m12:49:03.595082 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m12:49:03.596691 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m12:49:03.596691 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc, now test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097)
[0m12:49:03.596691 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m12:49:03.596691 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m12:49:03.603851 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m12:49:03.605453 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m12:49:03.605453 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m12:49:03.605453 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m12:49:03.609890 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m12:49:03.611391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:03.612164 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m12:49:03.612670 [debug] [MainThread]: Connection 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02' was properly closed.
[0m12:49:03.612670 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097' was properly closed.
[0m12:49:03.612670 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6' was properly closed.
[0m12:49:03.612670 [debug] [MainThread]: Connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f' was properly closed.
[0m12:49:03.616765 [debug] [MainThread]: Command end result
[0m12:49:03.654028 [debug] [MainThread]: Command `dbt compile` succeeded at 12:49:03.654028 after 7.09 seconds
[0m12:49:03.663311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BE9E135F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BE9989160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BEBCCFBC0>]}
[0m12:49:03.663311 [debug] [MainThread]: Flushing usage events
[0m12:49:12.287214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017538C2B9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753BC63E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753BC78620>]}


============================== 12:49:12.295443 | 56e1d78f-51de-4eeb-a337-d20332b05c45 ==============================
[0m12:49:12.295443 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:49:12.301176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_orders mart_revenue_daily', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:49:12.816755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e1d78f-51de-4eeb-a337-d20332b05c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753BC78140>]}
[0m12:49:13.016977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e1d78f-51de-4eeb-a337-d20332b05c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753BDAD520>]}
[0m12:49:13.025309 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:49:13.673800 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:49:13.950333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:13.950333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:14.026902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e1d78f-51de-4eeb-a337-d20332b05c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753D20FBC0>]}
[0m12:49:14.186322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e1d78f-51de-4eeb-a337-d20332b05c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753D538890>]}
[0m12:49:14.188956 [info ] [MainThread]: Found 7 models, 11 data tests, 1 source, 433 macros
[0m12:49:14.188956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e1d78f-51de-4eeb-a337-d20332b05c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753BB0D730>]}
[0m12:49:14.188956 [info ] [MainThread]: 
[0m12:49:14.188956 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:49:14.201918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m12:49:14.306864 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m12:49:14.306864 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:49:14.306864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:14.350979 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.042 seconds
[0m12:49:14.350979 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m12:49:14.357084 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m12:49:14.367488 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:49:14.367488 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m12:49:14.367488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:14.395197 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m12:49:14.395197 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:49:14.396838 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:49:14.404620 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m12:49:14.406979 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m12:49:14.406979 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m12:49:14.418626 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.418626 [debug] [MainThread]: On master: BEGIN
[0m12:49:14.420223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:14.444631 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m12:49:14.447199 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.448430 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:49:14.457664 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m12:49:14.459895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e1d78f-51de-4eeb-a337-d20332b05c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753D5CBEC0>]}
[0m12:49:14.459895 [debug] [MainThread]: On master: ROLLBACK
[0m12:49:14.461912 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.461912 [debug] [MainThread]: On master: BEGIN
[0m12:49:14.461912 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:49:14.465828 [debug] [MainThread]: On master: COMMIT
[0m12:49:14.466950 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.467490 [debug] [MainThread]: On master: COMMIT
[0m12:49:14.469982 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:49:14.471048 [debug] [MainThread]: On master: Close
[0m12:49:14.472454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:49:14.473523 [info ] [MainThread]: 
[0m12:49:14.478134 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_orders
[0m12:49:14.482431 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_orders ................................. [RUN]
[0m12:49:14.482759 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m12:49:14.485269 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_orders
[0m12:49:14.501340 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m12:49:14.502539 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_orders
[0m12:49:14.568204 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_orders"
[0m12:49:14.570927 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:49:14.570927 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: BEGIN
[0m12:49:14.575039 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:14.611833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:49:14.613313 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:49:14.614970 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */

  
    

  create  table "attrib_analytics"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    ï»¿select
  order_id,
  cast(order_date as date) as order_date,
  lower(channel)          as channel,
  cast(amount as numeric(12,2)) as amount
from "attrib_analytics"."public"."orders"
  );
  
[0m12:49:14.624316 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "ï»¿select"
LINE 12:     ï»¿select
             ^

[0m12:49:14.626406 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: ROLLBACK
[0m12:49:14.628717 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: Close
[0m12:49:14.771273 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_orders.sql
[0m12:49:14.778074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e1d78f-51de-4eeb-a337-d20332b05c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753B3C10D0>]}
[0m12:49:14.778074 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.stg_orders ........................ [[31mERROR[0m in 0.29s]
[0m12:49:14.778074 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_orders
[0m12:49:14.778074 [debug] [Thread-3 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m12:49:14.784417 [info ] [Thread-3 (]: 2 of 2 SKIP relation public.mart_revenue_daily ................................. [[33mSKIP[0m]
[0m12:49:14.786626 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m12:49:14.792105 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.792105 [debug] [MainThread]: On master: BEGIN
[0m12:49:14.794114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:14.822886 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m12:49:14.824899 [debug] [MainThread]: On master: COMMIT
[0m12:49:14.826044 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:14.826569 [debug] [MainThread]: On master: COMMIT
[0m12:49:14.828189 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:49:14.829232 [debug] [MainThread]: On master: Close
[0m12:49:14.830324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:14.831125 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m12:49:14.831654 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m12:49:14.833123 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_orders' was properly closed.
[0m12:49:14.834234 [info ] [MainThread]: 
[0m12:49:14.835465 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m12:49:14.835465 [debug] [MainThread]: Command end result
[0m12:49:14.881899 [info ] [MainThread]: 
[0m12:49:14.881899 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:49:14.881899 [info ] [MainThread]: 
[0m12:49:14.881899 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_orders.sql
[0m12:49:14.891644 [info ] [MainThread]: 
[0m12:49:14.891644 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m12:49:14.891644 [debug] [MainThread]: Command `dbt run` failed at 12:49:14.891644 after 2.99 seconds
[0m12:49:14.895944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017538C2B9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001753BDF9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017539581280>]}
[0m12:49:14.896974 [debug] [MainThread]: Flushing usage events
[0m12:49:20.660629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174CC06FB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174CE9E3BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174CEEB74A0>]}


============================== 12:49:20.665535 | 743e9889-c3de-42a6-b4c6-c7165b2647da ==============================
[0m12:49:20.665535 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:49:20.665535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:49:20.901842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '743e9889-c3de-42a6-b4c6-c7165b2647da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174CF274590>]}
[0m12:49:20.988876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '743e9889-c3de-42a6-b4c6-c7165b2647da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174CEF86CC0>]}
[0m12:49:20.991963 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:49:21.479765 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:49:21.705545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:21.705545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:21.773969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '743e9889-c3de-42a6-b4c6-c7165b2647da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174D0741880>]}
[0m12:49:21.956013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '743e9889-c3de-42a6-b4c6-c7165b2647da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174D0BC6930>]}
[0m12:49:21.959280 [info ] [MainThread]: Found 7 models, 11 data tests, 1 source, 433 macros
[0m12:49:21.959280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743e9889-c3de-42a6-b4c6-c7165b2647da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174D07414F0>]}
[0m12:49:21.959280 [info ] [MainThread]: 
[0m12:49:21.965425 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:49:21.972707 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m12:49:22.085799 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:49:22.085799 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m12:49:22.090255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:22.121575 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m12:49:22.123818 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:49:22.124905 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:49:22.131625 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m12:49:22.134305 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m12:49:22.135811 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m12:49:22.144009 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:22.144009 [debug] [MainThread]: On master: BEGIN
[0m12:49:22.144009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:22.165265 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m12:49:22.166378 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:22.166949 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:49:22.173909 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m12:49:22.176847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743e9889-c3de-42a6-b4c6-c7165b2647da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174D0B91B80>]}
[0m12:49:22.177370 [debug] [MainThread]: On master: ROLLBACK
[0m12:49:22.177370 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:22.179390 [debug] [MainThread]: On master: BEGIN
[0m12:49:22.181629 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:49:22.183809 [debug] [MainThread]: On master: COMMIT
[0m12:49:22.184738 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:22.185835 [debug] [MainThread]: On master: COMMIT
[0m12:49:22.186917 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:49:22.187478 [debug] [MainThread]: On master: Close
[0m12:49:22.188013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:49:22.189373 [info ] [MainThread]: 
[0m12:49:22.195762 [debug] [Thread-1 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m12:49:22.195762 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m12:49:22.195762 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m12:49:22.195762 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m12:49:22.195762 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_mart_revenue_daily_channel__ads__email__direct  [RUN]
[0m12:49:22.195762 [info ] [Thread-2 (]: 2 of 11 START test not_null_mart_revenue_daily_order_date ...................... [RUN]
[0m12:49:22.195762 [info ] [Thread-3 (]: 3 of 11 START test not_null_stg_chain_blocks_height ............................ [RUN]
[0m12:49:22.195762 [info ] [Thread-4 (]: 4 of 11 START test not_null_stg_chain_mempool_txid ............................. [RUN]
[0m12:49:22.203525 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f'
[0m12:49:22.203525 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097'
[0m12:49:22.203525 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962'
[0m12:49:22.203525 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120'
[0m12:49:22.203525 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m12:49:22.203525 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m12:49:22.203525 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m12:49:22.203525 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m12:49:22.226630 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m12:49:22.245694 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m12:49:22.247773 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"
[0m12:49:22.254878 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"
[0m12:49:22.258212 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m12:49:22.258212 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m12:49:22.258212 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m12:49:22.275955 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m12:49:22.275955 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m12:49:22.289911 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m12:49:22.293941 [debug] [Thread-3 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"
[0m12:49:22.296632 [debug] [Thread-4 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"
[0m12:49:22.301369 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m12:49:22.301369 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: BEGIN
[0m12:49:22.301369 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:22.301369 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"
[0m12:49:22.305502 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m12:49:22.307042 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962: BEGIN
[0m12:49:22.307042 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"
[0m12:49:22.307042 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: BEGIN
[0m12:49:22.307042 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:49:22.307042 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120: BEGIN
[0m12:49:22.307042 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:49:22.312214 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:49:22.329818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m12:49:22.330832 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m12:49:22.331909 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        channel as value_field,
        count(*) as n_records

    from "attrib_analytics"."public"."mart_revenue_daily"
    group by channel

)

select *
from all_values
where value_field not in (
    'ads','email','direct'
)



  
  
      
    ) dbt_internal_test
[0m12:49:22.335371 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.mart_revenue_daily" does not exist
LINE 20:     from "attrib_analytics"."public"."mart_revenue_daily"
                  ^

[0m12:49:22.336801 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: ROLLBACK
[0m12:49:22.339453 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: Close
[0m12:49:22.345461 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m12:49:22.347076 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"
[0m12:49:22.347608 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select height
from "attrib_analytics"."public"."stg_chain_blocks"
where height is null



  
  
      
    ) dbt_internal_test
[0m12:49:22.349450 [debug] [Thread-2 (]: SQL status: BEGIN in 0.038 seconds
[0m12:49:22.350718 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m12:49:22.351792 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_chain_blocks" does not exist
LINE 17: from "attrib_analytics"."public"."stg_chain_blocks"
              ^

[0m12:49:22.352887 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "attrib_analytics"."public"."mart_revenue_daily"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m12:49:22.354540 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962: ROLLBACK
[0m12:49:22.355589 [debug] [Thread-4 (]: SQL status: BEGIN in 0.042 seconds
[0m12:49:22.357160 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"
[0m12:49:22.358237 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962: Close
[0m12:49:22.358912 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.mart_revenue_daily" does not exist
LINE 17: from "attrib_analytics"."public"."mart_revenue_daily"
              ^

[0m12:49:22.359994 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txid
from "attrib_analytics"."public"."stg_chain_mempool"
where txid is null



  
  
      
    ) dbt_internal_test
[0m12:49:22.362873 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: ROLLBACK
[0m12:49:22.366711 [debug] [Thread-3 (]: Database Error in test not_null_stg_chain_blocks_height (models\staging\schema.yml)
  relation "public.stg_chain_blocks" does not exist
  LINE 17: from "attrib_analytics"."public"."stg_chain_blocks"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\not_null_stg_chain_blocks_height.sql
[0m12:49:22.368409 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: Close
[0m12:49:22.368409 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_chain_mempool" does not exist
LINE 17: from "attrib_analytics"."public"."stg_chain_mempool"
              ^

[0m12:49:22.371103 [debug] [Thread-1 (]: Database Error in test accepted_values_mart_revenue_daily_channel__ads__email__direct (models\schema.yml)
  relation "public.mart_revenue_daily" does not exist
  LINE 20:     from "attrib_analytics"."public"."mart_revenue_daily"
                    ^
  compiled code at target\run\attribution_dbt\models\schema.yml\accepted_values_mart_revenue_daily_channel__ads__email__direct.sql
[0m12:49:22.371698 [error] [Thread-3 (]: 3 of 11 ERROR not_null_stg_chain_blocks_height ................................. [[31mERROR[0m in 0.17s]
[0m12:49:22.374480 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120: ROLLBACK
[0m12:49:22.375590 [error] [Thread-1 (]: 1 of 11 ERROR accepted_values_mart_revenue_daily_channel__ads__email__direct ... [[31mERROR[0m in 0.17s]
[0m12:49:22.377206 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m12:49:22.378838 [debug] [Thread-2 (]: Database Error in test not_null_mart_revenue_daily_order_date (models\schema.yml)
  relation "public.mart_revenue_daily" does not exist
  LINE 17: from "attrib_analytics"."public"."mart_revenue_daily"
                ^
  compiled code at target\run\attribution_dbt\models\schema.yml\not_null_mart_revenue_daily_order_date.sql
[0m12:49:22.379878 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m12:49:22.379878 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120: Close
[0m12:49:22.379878 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m12:49:22.382557 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m12:49:22.379878 [error] [Thread-2 (]: 2 of 11 ERROR not_null_mart_revenue_daily_order_date ........................... [[31mERROR[0m in 0.18s]
[0m12:49:22.383140 [info ] [Thread-3 (]: 5 of 11 START test not_null_stg_orders_order_id ................................ [RUN]
[0m12:49:22.383140 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_web2_event_id .................................. [RUN]
[0m12:49:22.388536 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m12:49:22.388536 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962, now test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m12:49:22.390071 [debug] [Thread-4 (]: Database Error in test not_null_stg_chain_mempool_txid (models\staging\schema.yml)
  relation "public.stg_chain_mempool" does not exist
  LINE 17: from "attrib_analytics"."public"."stg_chain_mempool"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\not_null_stg_chain_mempool_txid.sql
[0m12:49:22.390071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f, now test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc)
[0m12:49:22.390071 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m12:49:22.390071 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m12:49:22.390071 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m12:49:22.390071 [error] [Thread-4 (]: 4 of 11 ERROR not_null_stg_chain_mempool_txid .................................. [[31mERROR[0m in 0.19s]
[0m12:49:22.390071 [info ] [Thread-2 (]: 7 of 11 START test not_null_stg_web2_ts ........................................ [RUN]
[0m12:49:22.401256 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:49:22.411021 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"
[0m12:49:22.411021 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m12:49:22.411021 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097, now test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6)
[0m12:49:22.414494 [debug] [Thread-4 (]: Began running node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m12:49:22.416481 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m12:49:22.416481 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m12:49:22.416481 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m12:49:22.424044 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"
[0m12:49:22.416481 [info ] [Thread-4 (]: 8 of 11 START test unique_stg_chain_blocks_height .............................. [RUN]
[0m12:49:22.427431 [debug] [Thread-3 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:49:22.432395 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"
[0m12:49:22.432395 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120, now test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157)
[0m12:49:22.432395 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m12:49:22.435866 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m12:49:22.438109 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"
[0m12:49:22.438109 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"
[0m12:49:22.441665 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:49:22.451364 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"
[0m12:49:22.452377 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc: BEGIN
[0m12:49:22.454484 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m12:49:22.454484 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"
[0m12:49:22.456499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:22.456499 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:49:22.458510 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6: BEGIN
[0m12:49:22.458510 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m12:49:22.461145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:49:22.465374 [debug] [Thread-4 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"
[0m12:49:22.468574 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"
[0m12:49:22.469926 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157: BEGIN
[0m12:49:22.469926 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:49:22.492768 [debug] [Thread-3 (]: SQL status: BEGIN in 0.035 seconds
[0m12:49:22.494993 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:49:22.495565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:49:22.497683 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m12:49:22.498224 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "attrib_analytics"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:49:22.498816 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"
[0m12:49:22.499367 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"
[0m12:49:22.500941 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "attrib_analytics"."public"."stg_web2"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m12:49:22.501463 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    height as unique_field,
    count(*) as n_records

from "attrib_analytics"."public"."stg_chain_blocks"
where height is not null
group by height
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:49:22.502682 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_orders" does not exist
LINE 17: from "attrib_analytics"."public"."stg_orders"
              ^

[0m12:49:22.503265 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m12:49:22.504550 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_web2" does not exist
LINE 17: from "attrib_analytics"."public"."stg_web2"
              ^

[0m12:49:22.505566 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_chain_blocks" does not exist
LINE 18: from "attrib_analytics"."public"."stg_chain_blocks"
              ^

[0m12:49:22.507249 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc: ROLLBACK
[0m12:49:22.507790 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m12:49:22.509054 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157: ROLLBACK
[0m12:49:22.512402 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc: Close
[0m12:49:22.512931 [debug] [Thread-2 (]: SQL status: BEGIN in 0.052 seconds
[0m12:49:22.514000 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157: Close
[0m12:49:22.516640 [debug] [Thread-3 (]: Database Error in test not_null_stg_orders_order_id (models\schema.yml)
  relation "public.stg_orders" does not exist
  LINE 17: from "attrib_analytics"."public"."stg_orders"
                ^
  compiled code at target\run\attribution_dbt\models\schema.yml\not_null_stg_orders_order_id.sql
[0m12:49:22.518236 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"
[0m12:49:22.522566 [debug] [Thread-1 (]: Database Error in test not_null_stg_web2_event_id (models\staging\schema.yml)
  relation "public.stg_web2" does not exist
  LINE 17: from "attrib_analytics"."public"."stg_web2"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\not_null_stg_web2_event_id.sql
[0m12:49:22.520967 [error] [Thread-3 (]: 5 of 11 ERROR not_null_stg_orders_order_id ..................................... [[31mERROR[0m in 0.13s]
[0m12:49:22.524314 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ts
from "attrib_analytics"."public"."stg_web2"
where ts is null



  
  
      
    ) dbt_internal_test
[0m12:49:22.524314 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m12:49:22.524314 [error] [Thread-1 (]: 6 of 11 ERROR not_null_stg_web2_event_id ....................................... [[31mERROR[0m in 0.13s]
[0m12:49:22.526513 [debug] [Thread-4 (]: Database Error in test unique_stg_chain_blocks_height (models\staging\schema.yml)
  relation "public.stg_chain_blocks" does not exist
  LINE 18: from "attrib_analytics"."public"."stg_chain_blocks"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\unique_stg_chain_blocks_height.sql
[0m12:49:22.526513 [debug] [Thread-3 (]: Began running node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m12:49:22.526513 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m12:49:22.531530 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.stg_web2" does not exist
LINE 17: from "attrib_analytics"."public"."stg_web2"
              ^

[0m12:49:22.532599 [error] [Thread-4 (]: 8 of 11 ERROR unique_stg_chain_blocks_height ................................... [[31mERROR[0m in 0.10s]
[0m12:49:22.534176 [info ] [Thread-3 (]: 9 of 11 START test unique_stg_chain_mempool_txid ............................... [RUN]
[0m12:49:22.535233 [debug] [Thread-1 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m12:49:22.536251 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6: ROLLBACK
[0m12:49:22.537345 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m12:49:22.537877 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969)
[0m12:49:22.538937 [info ] [Thread-1 (]: 10 of 11 START test unique_stg_orders_order_id ................................. [RUN]
[0m12:49:22.540194 [debug] [Thread-4 (]: Began running node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m12:49:22.541301 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6: Close
[0m12:49:22.541857 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m12:49:22.542433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc, now test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m12:49:22.549378 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"
[0m12:49:22.542986 [info ] [Thread-4 (]: 11 of 11 START test unique_stg_web2_event_id ................................... [RUN]
[0m12:49:22.549378 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m12:49:22.549378 [debug] [Thread-2 (]: Database Error in test not_null_stg_web2_ts (models\staging\schema.yml)
  relation "public.stg_web2" does not exist
  LINE 17: from "attrib_analytics"."public"."stg_web2"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\not_null_stg_web2_ts.sql
[0m12:49:22.555569 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157, now test.attribution_dbt.unique_stg_web2_event_id.250b5fae02)
[0m12:49:22.562007 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m12:49:22.562007 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m12:49:22.563629 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m12:49:22.563087 [error] [Thread-2 (]: 7 of 11 ERROR not_null_stg_web2_ts ............................................. [[31mERROR[0m in 0.15s]
[0m12:49:22.567507 [debug] [Thread-3 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"
[0m12:49:22.574887 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"
[0m12:49:22.575990 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m12:49:22.576516 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m12:49:22.582284 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m12:49:22.582824 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"
[0m12:49:22.583880 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m12:49:22.585416 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969: BEGIN
[0m12:49:22.588479 [debug] [Thread-4 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"
[0m12:49:22.591145 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:49:22.591145 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m12:49:22.591145 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m12:49:22.593888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:22.593888 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"
[0m12:49:22.593888 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_web2_event_id.250b5fae02: BEGIN
[0m12:49:22.597348 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:49:22.619022 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m12:49:22.610876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m12:49:22.620161 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"
[0m12:49:22.621910 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m12:49:22.623056 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m12:49:22.624158 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    txid as unique_field,
    count(*) as n_records

from "attrib_analytics"."public"."stg_chain_mempool"
where txid is not null
group by txid
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:49:22.624686 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "attrib_analytics"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:49:22.625213 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"
[0m12:49:22.626289 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_web2_event_id.250b5fae02: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "attrib_analytics"."public"."stg_web2"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:49:22.627540 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_chain_mempool" does not exist
LINE 18: from "attrib_analytics"."public"."stg_chain_mempool"
              ^

[0m12:49:22.628358 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_orders" does not exist
LINE 18: from "attrib_analytics"."public"."stg_orders"
              ^

[0m12:49:22.629511 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969: ROLLBACK
[0m12:49:22.630597 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_web2" does not exist
LINE 18: from "attrib_analytics"."public"."stg_web2"
              ^

[0m12:49:22.631684 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m12:49:22.632922 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_web2_event_id.250b5fae02: ROLLBACK
[0m12:49:22.633998 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969: Close
[0m12:49:22.634486 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_web2_event_id.250b5fae02: Close
[0m12:49:22.636056 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m12:49:22.641965 [debug] [Thread-4 (]: Database Error in test unique_stg_web2_event_id (models\staging\schema.yml)
  relation "public.stg_web2" does not exist
  LINE 18: from "attrib_analytics"."public"."stg_web2"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\unique_stg_web2_event_id.sql
[0m12:49:22.641965 [debug] [Thread-3 (]: Database Error in test unique_stg_chain_mempool_txid (models\staging\schema.yml)
  relation "public.stg_chain_mempool" does not exist
  LINE 18: from "attrib_analytics"."public"."stg_chain_mempool"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\unique_stg_chain_mempool_txid.sql
[0m12:49:22.646163 [debug] [Thread-1 (]: Database Error in test unique_stg_orders_order_id (models\schema.yml)
  relation "public.stg_orders" does not exist
  LINE 18: from "attrib_analytics"."public"."stg_orders"
                ^
  compiled code at target\run\attribution_dbt\models\schema.yml\unique_stg_orders_order_id.sql
[0m12:49:22.646163 [error] [Thread-4 (]: 11 of 11 ERROR unique_stg_web2_event_id ........................................ [[31mERROR[0m in 0.10s]
[0m12:49:22.646163 [error] [Thread-3 (]: 9 of 11 ERROR unique_stg_chain_mempool_txid .................................... [[31mERROR[0m in 0.11s]
[0m12:49:22.650849 [error] [Thread-1 (]: 10 of 11 ERROR unique_stg_orders_order_id ...................................... [[31mERROR[0m in 0.11s]
[0m12:49:22.651587 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m12:49:22.651587 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m12:49:22.655174 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m12:49:22.656194 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:22.656194 [debug] [MainThread]: On master: BEGIN
[0m12:49:22.656194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:22.692784 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m12:49:22.697274 [debug] [MainThread]: On master: COMMIT
[0m12:49:22.697963 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:22.698492 [debug] [MainThread]: On master: COMMIT
[0m12:49:22.700111 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:49:22.700639 [debug] [MainThread]: On master: Close
[0m12:49:22.701709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:22.702290 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m12:49:22.702839 [debug] [MainThread]: Connection 'test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m12:49:22.703362 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6' was properly closed.
[0m12:49:22.703362 [debug] [MainThread]: Connection 'test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969' was properly closed.
[0m12:49:22.705117 [debug] [MainThread]: Connection 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02' was properly closed.
[0m12:49:22.705704 [info ] [MainThread]: 
[0m12:49:22.706805 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m12:49:22.707400 [debug] [MainThread]: Command end result
[0m12:49:22.754812 [info ] [MainThread]: 
[0m12:49:22.760284 [info ] [MainThread]: [31mCompleted with 11 errors and 0 warnings:[0m
[0m12:49:22.761466 [info ] [MainThread]: 
[0m12:49:22.763155 [error] [MainThread]:   Database Error in test not_null_stg_chain_blocks_height (models\staging\schema.yml)
  relation "public.stg_chain_blocks" does not exist
  LINE 17: from "attrib_analytics"."public"."stg_chain_blocks"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\not_null_stg_chain_blocks_height.sql
[0m12:49:22.766561 [info ] [MainThread]: 
[0m12:49:22.766561 [error] [MainThread]:   Database Error in test accepted_values_mart_revenue_daily_channel__ads__email__direct (models\schema.yml)
  relation "public.mart_revenue_daily" does not exist
  LINE 20:     from "attrib_analytics"."public"."mart_revenue_daily"
                    ^
  compiled code at target\run\attribution_dbt\models\schema.yml\accepted_values_mart_revenue_daily_channel__ads__email__direct.sql
[0m12:49:22.769237 [info ] [MainThread]: 
[0m12:49:22.769237 [error] [MainThread]:   Database Error in test not_null_mart_revenue_daily_order_date (models\schema.yml)
  relation "public.mart_revenue_daily" does not exist
  LINE 17: from "attrib_analytics"."public"."mart_revenue_daily"
                ^
  compiled code at target\run\attribution_dbt\models\schema.yml\not_null_mart_revenue_daily_order_date.sql
[0m12:49:22.769237 [info ] [MainThread]: 
[0m12:49:22.769237 [error] [MainThread]:   Database Error in test not_null_stg_chain_mempool_txid (models\staging\schema.yml)
  relation "public.stg_chain_mempool" does not exist
  LINE 17: from "attrib_analytics"."public"."stg_chain_mempool"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\not_null_stg_chain_mempool_txid.sql
[0m12:49:22.772756 [info ] [MainThread]: 
[0m12:49:22.774397 [error] [MainThread]:   Database Error in test not_null_stg_orders_order_id (models\schema.yml)
  relation "public.stg_orders" does not exist
  LINE 17: from "attrib_analytics"."public"."stg_orders"
                ^
  compiled code at target\run\attribution_dbt\models\schema.yml\not_null_stg_orders_order_id.sql
[0m12:49:22.775407 [info ] [MainThread]: 
[0m12:49:22.777341 [error] [MainThread]:   Database Error in test not_null_stg_web2_event_id (models\staging\schema.yml)
  relation "public.stg_web2" does not exist
  LINE 17: from "attrib_analytics"."public"."stg_web2"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\not_null_stg_web2_event_id.sql
[0m12:49:22.779028 [info ] [MainThread]: 
[0m12:49:22.779028 [error] [MainThread]:   Database Error in test unique_stg_chain_blocks_height (models\staging\schema.yml)
  relation "public.stg_chain_blocks" does not exist
  LINE 18: from "attrib_analytics"."public"."stg_chain_blocks"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\unique_stg_chain_blocks_height.sql
[0m12:49:22.779028 [info ] [MainThread]: 
[0m12:49:22.779028 [error] [MainThread]:   Database Error in test not_null_stg_web2_ts (models\staging\schema.yml)
  relation "public.stg_web2" does not exist
  LINE 17: from "attrib_analytics"."public"."stg_web2"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\not_null_stg_web2_ts.sql
[0m12:49:22.779028 [info ] [MainThread]: 
[0m12:49:22.779028 [error] [MainThread]:   Database Error in test unique_stg_web2_event_id (models\staging\schema.yml)
  relation "public.stg_web2" does not exist
  LINE 18: from "attrib_analytics"."public"."stg_web2"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\unique_stg_web2_event_id.sql
[0m12:49:22.785727 [info ] [MainThread]: 
[0m12:49:22.785727 [error] [MainThread]:   Database Error in test unique_stg_chain_mempool_txid (models\staging\schema.yml)
  relation "public.stg_chain_mempool" does not exist
  LINE 18: from "attrib_analytics"."public"."stg_chain_mempool"
                ^
  compiled code at target\run\attribution_dbt\models\staging\schema.yml\unique_stg_chain_mempool_txid.sql
[0m12:49:22.787156 [info ] [MainThread]: 
[0m12:49:22.787156 [error] [MainThread]:   Database Error in test unique_stg_orders_order_id (models\schema.yml)
  relation "public.stg_orders" does not exist
  LINE 18: from "attrib_analytics"."public"."stg_orders"
                ^
  compiled code at target\run\attribution_dbt\models\schema.yml\unique_stg_orders_order_id.sql
[0m12:49:22.787156 [info ] [MainThread]: 
[0m12:49:22.790948 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=11 SKIP=0 TOTAL=11
[0m12:49:22.793111 [debug] [MainThread]: Command `dbt test` failed at 12:49:22.793111 after 2.35 seconds
[0m12:49:22.793111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174CEDE3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174CED11400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174CEF69730>]}
[0m12:49:22.793111 [debug] [MainThread]: Flushing usage events
[0m10:59:00.354431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140292685C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014029268350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014029268380>]}


============================== 10:59:00.361892 | 31017dae-8daa-4371-b1ce-b89c939962b5 ==============================
[0m10:59:00.361892 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:59:00.364767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m10:59:00.966524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31017dae-8daa-4371-b1ce-b89c939962b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001402939D7C0>]}
[0m10:59:01.023176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31017dae-8daa-4371-b1ce-b89c939962b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014028F8EFF0>]}
[0m10:59:01.029265 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:59:01.629285 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:59:04.341033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:59:04.342035 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\staging\stg_orders.sql
[0m10:59:04.342035 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\marts\mart_revenue_daily.sql
[0m10:59:04.557998 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:59:04.558982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '31017dae-8daa-4371-b1ce-b89c939962b5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014026C0B650>]}
[0m10:59:04.740038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31017dae-8daa-4371-b1ce-b89c939962b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001402ABCDFD0>]}
[0m10:59:04.948197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31017dae-8daa-4371-b1ce-b89c939962b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001402A9B4680>]}
[0m10:59:04.948197 [info ] [MainThread]: Found 7 models, 11 data tests, 1 source, 433 macros
[0m10:59:04.948197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31017dae-8daa-4371-b1ce-b89c939962b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001402AB794F0>]}
[0m10:59:04.957532 [info ] [MainThread]: 
[0m10:59:04.957532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:59:04.964094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m10:59:09.673000 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m10:59:09.673000 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m10:59:09.673000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:09.766635 [debug] [ThreadPool]: SQL status: BEGIN in 0.096 seconds
[0m10:59:09.766635 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m10:59:09.772132 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:59:09.821400 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.049 seconds
[0m10:59:09.823579 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m10:59:09.824651 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m10:59:09.830240 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:09.830240 [debug] [MainThread]: On master: BEGIN
[0m10:59:09.830240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:09.858836 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m10:59:09.858836 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:09.859859 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:59:09.881930 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m10:59:09.883024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31017dae-8daa-4371-b1ce-b89c939962b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140294406B0>]}
[0m10:59:09.883024 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:09.883024 [debug] [MainThread]: On master: Close
[0m10:59:09.883024 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:59:09.883024 [info ] [MainThread]: 
[0m10:59:09.895516 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_chain_blocks
[0m10:59:09.895516 [debug] [Thread-2 (]: Began running node model.attribution_dbt.stg_chain_mempool
[0m10:59:09.896516 [debug] [Thread-3 (]: Began running node model.attribution_dbt.stg_gold_attribution
[0m10:59:09.896516 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_gold_sessions
[0m10:59:09.896516 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_chain_blocks'
[0m10:59:09.898046 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_chain_mempool'
[0m10:59:09.898982 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_gold_attribution'
[0m10:59:09.899489 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_gold_sessions'
[0m10:59:09.900542 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_chain_blocks
[0m10:59:09.900542 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.stg_chain_mempool
[0m10:59:09.900542 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.stg_gold_attribution
[0m10:59:09.901548 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_gold_sessions
[0m10:59:09.910249 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_blocks"
[0m10:59:09.912275 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_mempool"
[0m10:59:09.914257 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_attribution"
[0m10:59:09.915275 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_sessions"
[0m10:59:09.920013 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_chain_blocks
[0m10:59:09.922186 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_chain_blocks
[0m10:59:09.922706 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.stg_gold_attribution
[0m10:59:09.923236 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_orders
[0m10:59:09.923236 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.stg_chain_mempool
[0m10:59:09.924272 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_gold_sessions
[0m10:59:09.926027 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.stg_gold_attribution
[0m10:59:09.926555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_chain_blocks, now model.attribution_dbt.stg_orders)
[0m10:59:09.927642 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.stg_chain_mempool
[0m10:59:09.928176 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_gold_sessions
[0m10:59:09.928712 [debug] [Thread-3 (]: Began running node model.attribution_dbt.stg_web2
[0m10:59:09.929245 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_orders
[0m10:59:09.929794 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m10:59:09.930857 [debug] [Thread-4 (]: Began running node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m10:59:09.931383 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_gold_attribution, now model.attribution_dbt.stg_web2)
[0m10:59:09.935215 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m10:59:09.935758 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_chain_mempool, now test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962)
[0m10:59:09.936835 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_gold_sessions, now test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157)
[0m10:59:09.937369 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.stg_web2
[0m10:59:09.937925 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m10:59:09.938469 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m10:59:09.940180 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.stg_web2"
[0m10:59:09.941195 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_orders
[0m10:59:09.949830 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962"
[0m10:59:09.956162 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157"
[0m10:59:09.956162 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_orders
[0m10:59:09.956162 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.stg_web2
[0m10:59:09.956162 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m10:59:09.956162 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.stg_web2
[0m10:59:09.961480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_orders, now test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120)
[0m10:59:09.961994 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m10:59:09.962528 [debug] [Thread-3 (]: Began running node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m10:59:09.962528 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m10:59:09.962528 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m10:59:09.962528 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m10:59:09.962528 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_web2, now test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969)
[0m10:59:09.962528 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m10:59:09.971129 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120"
[0m10:59:09.972013 [debug] [Thread-2 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m10:59:09.972594 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m10:59:09.973207 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m10:59:09.974214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962, now model.attribution_dbt.mart_revenue_daily)
[0m10:59:09.978294 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969"
[0m10:59:09.979214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157, now test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m10:59:09.979537 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m10:59:09.980047 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m10:59:09.981180 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m10:59:09.981180 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m10:59:09.984723 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m10:59:09.985725 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m10:59:09.990442 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:59:09.990442 [debug] [Thread-1 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m10:59:09.993463 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m10:59:09.993463 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m10:59:09.993463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120, now test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m10:59:09.993463 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m10:59:09.993463 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m10:59:09.997717 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m10:59:09.998321 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969, now test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc)
[0m10:59:09.998849 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m10:59:09.999499 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m10:59:10.004044 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m10:59:10.004044 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m10:59:10.004044 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m10:59:10.004044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_revenue_daily, now test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6)
[0m10:59:10.011595 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc"
[0m10:59:10.012221 [debug] [Thread-4 (]: Began running node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m10:59:10.012866 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m10:59:10.012866 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m10:59:10.014387 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.attribution_dbt.unique_stg_web2_event_id.250b5fae02)
[0m10:59:10.014387 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m10:59:10.020488 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6"
[0m10:59:10.021506 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m10:59:10.021506 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m10:59:10.022502 [debug] [Thread-1 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m10:59:10.029384 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_web2_event_id.250b5fae02"
[0m10:59:10.030383 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m10:59:10.030383 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m10:59:10.031382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a, now test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f)
[0m10:59:10.033089 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m10:59:10.033623 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m10:59:10.034837 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m10:59:10.035446 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m10:59:10.035966 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc, now test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097)
[0m10:59:10.035966 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m10:59:10.041376 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m10:59:10.041376 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m10:59:10.046216 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m10:59:10.046216 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m10:59:10.048235 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m10:59:10.048235 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m10:59:10.048235 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m10:59:10.051910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:10.051910 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m10:59:10.051910 [debug] [MainThread]: Connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f' was properly closed.
[0m10:59:10.051910 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6' was properly closed.
[0m10:59:10.051910 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097' was properly closed.
[0m10:59:10.053607 [debug] [MainThread]: Connection 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02' was properly closed.
[0m10:59:10.056226 [debug] [MainThread]: Command end result
[0m10:59:10.086093 [debug] [MainThread]: Command `dbt compile` succeeded at 10:59:10.086093 after 9.96 seconds
[0m10:59:10.087109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140292699A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140292685C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014029253F20>]}
[0m10:59:10.087723 [debug] [MainThread]: Flushing usage events
[0m10:59:20.949263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B29A4D100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2C2B3D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B28AF4B90>]}


============================== 10:59:20.955159 | 17227742-5f8a-45fc-8d6e-978478353a2c ==============================
[0m10:59:20.955159 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:59:20.955159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_orders', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:59:21.134341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17227742-5f8a-45fc-8d6e-978478353a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2DC36300>]}
[0m10:59:21.189203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17227742-5f8a-45fc-8d6e-978478353a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2DC7D040>]}
[0m10:59:21.189203 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:59:21.386862 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:59:21.536780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:59:21.536780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:59:21.577362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17227742-5f8a-45fc-8d6e-978478353a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2DE6D460>]}
[0m10:59:21.684022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17227742-5f8a-45fc-8d6e-978478353a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2E07F830>]}
[0m10:59:21.684022 [info ] [MainThread]: Found 7 models, 11 data tests, 1 source, 433 macros
[0m10:59:21.684022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17227742-5f8a-45fc-8d6e-978478353a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2E083A10>]}
[0m10:59:21.689903 [info ] [MainThread]: 
[0m10:59:21.689903 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:59:21.692579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m10:59:21.759849 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m10:59:21.759849 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:59:21.759849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:21.804584 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.042 seconds
[0m10:59:21.804584 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m10:59:21.811942 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m10:59:21.818067 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m10:59:21.818067 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m10:59:21.818067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:21.877978 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m10:59:21.878985 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m10:59:21.878985 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:59:21.910491 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.032 seconds
[0m10:59:21.910491 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m10:59:21.910491 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m10:59:21.920037 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:21.920555 [debug] [MainThread]: On master: BEGIN
[0m10:59:21.920555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:21.949605 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m10:59:21.949605 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:21.950607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:59:21.954133 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:59:21.955137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17227742-5f8a-45fc-8d6e-978478353a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2DCB0860>]}
[0m10:59:21.955137 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:21.955137 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:21.955137 [debug] [MainThread]: On master: BEGIN
[0m10:59:21.955137 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:59:21.955137 [debug] [MainThread]: On master: COMMIT
[0m10:59:21.955137 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:21.955137 [debug] [MainThread]: On master: COMMIT
[0m10:59:21.955137 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:59:21.961918 [debug] [MainThread]: On master: Close
[0m10:59:21.961918 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:59:21.961918 [info ] [MainThread]: 
[0m10:59:21.967761 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_orders
[0m10:59:21.967761 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_orders ................................. [RUN]
[0m10:59:21.967761 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m10:59:21.967761 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_orders
[0m10:59:21.972054 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m10:59:21.981082 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_orders
[0m10:59:22.018991 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_orders"
[0m10:59:22.024094 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m10:59:22.024094 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: BEGIN
[0m10:59:22.024094 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:59:22.065578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m10:59:22.065578 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m10:59:22.067210 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */

  
    

  create  table "attrib_analytics"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    select
  order_id,
  cast(order_date as date) as order_date,
  lower(channel)          as channel,
  cast(amount as numeric(12,2)) as amount
from "attrib_analytics"."public"."orders"
  );
  
[0m10:59:22.146018 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.078 seconds
[0m10:59:22.155174 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m10:59:22.156776 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:59:22.161147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:59:22.173552 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m10:59:22.175846 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m10:59:22.175846 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m10:59:22.179242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m10:59:22.189786 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public"."stg_orders__dbt_backup"
[0m10:59:22.191910 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m10:59:22.191910 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
drop table if exists "attrib_analytics"."public"."stg_orders__dbt_backup" cascade
[0m10:59:22.200061 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m10:59:22.204455 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: Close
[0m10:59:22.207872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17227742-5f8a-45fc-8d6e-978478353a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B29F76F60>]}
[0m10:59:22.207872 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_orders ............................ [[32mSELECT 3[0m in 0.24s]
[0m10:59:22.207872 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_orders
[0m10:59:22.210394 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:22.210394 [debug] [MainThread]: On master: BEGIN
[0m10:59:22.210394 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:22.231332 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m10:59:22.231332 [debug] [MainThread]: On master: COMMIT
[0m10:59:22.231332 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:22.236590 [debug] [MainThread]: On master: COMMIT
[0m10:59:22.236590 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:59:22.236590 [debug] [MainThread]: On master: Close
[0m10:59:22.238816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:22.238816 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m10:59:22.239834 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m10:59:22.239834 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_orders' was properly closed.
[0m10:59:22.239834 [info ] [MainThread]: 
[0m10:59:22.239834 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m10:59:22.241852 [debug] [MainThread]: Command end result
[0m10:59:22.273119 [info ] [MainThread]: 
[0m10:59:22.274176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:59:22.275125 [info ] [MainThread]: 
[0m10:59:22.276129 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:59:22.277127 [debug] [MainThread]: Command `dbt run` succeeded at 10:59:22.277127 after 1.48 seconds
[0m10:59:22.277127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B29A4D100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2C3D87A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2C3D83E0>]}
[0m10:59:22.278127 [debug] [MainThread]: Flushing usage events
[0m10:59:31.822402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA91EFF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA9019CD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA92116AB0>]}


============================== 10:59:31.823945 | 802d3319-8ad2-4dfa-a19c-c2d2e30b5c9d ==============================
[0m10:59:31.823945 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:59:31.823945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select mart_revenue_daily', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:31.989967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '802d3319-8ad2-4dfa-a19c-c2d2e30b5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA92F65010>]}
[0m10:59:32.056287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '802d3319-8ad2-4dfa-a19c-c2d2e30b5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA93089160>]}
[0m10:59:32.058285 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:59:32.257609 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:59:32.390131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:59:32.392137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:59:32.434021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '802d3319-8ad2-4dfa-a19c-c2d2e30b5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA947A36E0>]}
[0m10:59:32.540450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '802d3319-8ad2-4dfa-a19c-c2d2e30b5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA947CFE90>]}
[0m10:59:32.540450 [info ] [MainThread]: Found 7 models, 11 data tests, 1 source, 433 macros
[0m10:59:32.540450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '802d3319-8ad2-4dfa-a19c-c2d2e30b5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA930668D0>]}
[0m10:59:32.543863 [info ] [MainThread]: 
[0m10:59:32.543863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:59:32.543863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m10:59:32.612360 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m10:59:32.612360 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:59:32.612360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:32.653992 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.035 seconds
[0m10:59:32.655551 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m10:59:32.661758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m10:59:32.668981 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m10:59:32.670083 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m10:59:32.670083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:32.702290 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m10:59:32.702826 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m10:59:32.703357 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:59:32.708498 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m10:59:32.710648 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m10:59:32.711711 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m10:59:32.720566 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:32.720566 [debug] [MainThread]: On master: BEGIN
[0m10:59:32.721575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:32.745944 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m10:59:32.746965 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:32.746965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:59:32.759395 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m10:59:32.759395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '802d3319-8ad2-4dfa-a19c-c2d2e30b5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA930DD760>]}
[0m10:59:32.762202 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:32.762202 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:32.762202 [debug] [MainThread]: On master: BEGIN
[0m10:59:32.765900 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:59:32.766414 [debug] [MainThread]: On master: COMMIT
[0m10:59:32.766944 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:32.767477 [debug] [MainThread]: On master: COMMIT
[0m10:59:32.769159 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:59:32.769694 [debug] [MainThread]: On master: Close
[0m10:59:32.770814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:59:32.771358 [info ] [MainThread]: 
[0m10:59:32.777940 [debug] [Thread-1 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m10:59:32.779007 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_revenue_daily ......................... [RUN]
[0m10:59:32.780059 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_daily'
[0m10:59:32.782710 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m10:59:32.800179 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m10:59:32.802428 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m10:59:32.861180 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_daily"
[0m10:59:32.862801 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m10:59:32.863856 [debug] [Thread-1 (]: On model.attribution_dbt.mart_revenue_daily: BEGIN
[0m10:59:32.864392 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:59:32.879788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m10:59:32.880306 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m10:59:32.880306 [debug] [Thread-1 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
  order_date,
  channel,
  sum(amount) as revenue
from "attrib_analytics"."public"."stg_orders"
group by 1,2
  );
  
[0m10:59:32.911714 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.032 seconds
[0m10:59:32.921835 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m10:59:32.924043 [debug] [Thread-1 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp" rename to "mart_revenue_daily"
[0m10:59:32.924555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:59:32.940582 [debug] [Thread-1 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m10:59:32.940582 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m10:59:32.942812 [debug] [Thread-1 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m10:59:32.943827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:59:32.953122 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_daily__dbt_backup"
[0m10:59:32.961641 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m10:59:32.961641 [debug] [Thread-1 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_daily__dbt_backup" cascade
[0m10:59:32.963647 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:59:32.963647 [debug] [Thread-1 (]: On model.attribution_dbt.mart_revenue_daily: Close
[0m10:59:32.963647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '802d3319-8ad2-4dfa-a19c-c2d2e30b5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA906C7050>]}
[0m10:59:32.963647 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.mart_revenue_daily .................... [[32mSELECT 3[0m in 0.18s]
[0m10:59:32.963647 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m10:59:32.972412 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:32.972412 [debug] [MainThread]: On master: BEGIN
[0m10:59:32.973935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:32.988561 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m10:59:32.989631 [debug] [MainThread]: On master: COMMIT
[0m10:59:32.989631 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:32.990605 [debug] [MainThread]: On master: COMMIT
[0m10:59:32.991602 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:59:32.991602 [debug] [MainThread]: On master: Close
[0m10:59:32.992631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:32.992631 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m10:59:32.993639 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m10:59:32.993639 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_daily' was properly closed.
[0m10:59:32.993639 [info ] [MainThread]: 
[0m10:59:32.994640 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m10:59:32.995932 [debug] [MainThread]: Command end result
[0m10:59:33.029564 [info ] [MainThread]: 
[0m10:59:33.029564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:59:33.029564 [info ] [MainThread]: 
[0m10:59:33.029564 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:59:33.029564 [debug] [MainThread]: Command `dbt run` succeeded at 10:59:33.029564 after 1.35 seconds
[0m10:59:33.029564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA92AFC7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA92AFDD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA92AFD580>]}
[0m10:59:33.029564 [debug] [MainThread]: Flushing usage events
[0m10:59:42.588253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150566791F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001505927FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001505927CBC0>]}


============================== 10:59:42.588253 | 427e348f-4a49-4dd9-b0b1-b4442db8da99 ==============================
[0m10:59:42.588253 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:59:42.588253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_orders mart_revenue_daily', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:42.878136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '427e348f-4a49-4dd9-b0b1-b4442db8da99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001505918AF60>]}
[0m10:59:42.989312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '427e348f-4a49-4dd9-b0b1-b4442db8da99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015052FFF800>]}
[0m10:59:42.989312 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:59:43.415133 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:59:43.658504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:59:43.659162 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:59:43.724891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '427e348f-4a49-4dd9-b0b1-b4442db8da99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001505940D340>]}
[0m10:59:43.883839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '427e348f-4a49-4dd9-b0b1-b4442db8da99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001505AD9A3C0>]}
[0m10:59:43.885148 [info ] [MainThread]: Found 7 models, 11 data tests, 1 source, 433 macros
[0m10:59:43.885977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '427e348f-4a49-4dd9-b0b1-b4442db8da99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015058C05A60>]}
[0m10:59:43.888171 [info ] [MainThread]: 
[0m10:59:43.889565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:59:43.895747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m10:59:43.992869 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m10:59:43.993987 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m10:59:43.994989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:44.033759 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m10:59:44.034755 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m10:59:44.035759 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:59:44.047705 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m10:59:44.049269 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m10:59:44.051289 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m10:59:44.058506 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:44.059073 [debug] [MainThread]: On master: BEGIN
[0m10:59:44.059589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:44.088472 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m10:59:44.088472 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:44.089481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:59:44.098518 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m10:59:44.100519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '427e348f-4a49-4dd9-b0b1-b4442db8da99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001505ADCC440>]}
[0m10:59:44.101025 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:44.102108 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:44.103004 [debug] [MainThread]: On master: BEGIN
[0m10:59:44.104992 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:59:44.106044 [debug] [MainThread]: On master: COMMIT
[0m10:59:44.106044 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:44.107022 [debug] [MainThread]: On master: COMMIT
[0m10:59:44.108022 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:59:44.109023 [debug] [MainThread]: On master: Close
[0m10:59:44.109023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:59:44.110899 [info ] [MainThread]: 
[0m10:59:44.116157 [debug] [Thread-1 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m10:59:44.117827 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m10:59:44.119151 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m10:59:44.120463 [debug] [Thread-4 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m10:59:44.121469 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_mart_revenue_daily_channel__ads__email__direct  [RUN]
[0m10:59:44.122584 [info ] [Thread-2 (]: 2 of 4 START test not_null_mart_revenue_daily_order_date ....................... [RUN]
[0m10:59:44.123583 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m10:59:44.124584 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m10:59:44.125586 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f'
[0m10:59:44.126757 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097'
[0m10:59:44.126757 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64'
[0m10:59:44.127818 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a'
[0m10:59:44.128784 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m10:59:44.128784 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m10:59:44.130248 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m10:59:44.130248 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m10:59:44.155741 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m10:59:44.169962 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m10:59:44.175760 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:59:44.185480 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m10:59:44.186672 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m10:59:44.202024 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m10:59:44.210698 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m10:59:44.224745 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m10:59:44.225323 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m10:59:44.225323 [debug] [Thread-3 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:59:44.232067 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m10:59:44.237364 [debug] [Thread-4 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m10:59:44.241956 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m10:59:44.243952 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m10:59:44.243952 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m10:59:44.243952 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m10:59:44.245460 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:59:44.246469 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: BEGIN
[0m10:59:44.247468 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: BEGIN
[0m10:59:44.248977 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:59:44.249981 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m10:59:44.250979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:59:44.251982 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:59:44.251982 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:59:44.288278 [debug] [Thread-3 (]: SQL status: BEGIN in 0.035 seconds
[0m10:59:44.288278 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:59:44.289433 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "attrib_analytics"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m10:59:44.291430 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m10:59:44.292431 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m10:59:44.293525 [debug] [Thread-2 (]: SQL status: BEGIN in 0.041 seconds
[0m10:59:44.293525 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "attrib_analytics"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:59:44.294530 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m10:59:44.294530 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "attrib_analytics"."public"."mart_revenue_daily"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m10:59:44.300856 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:59:44.301547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m10:59:44.302177 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m10:59:44.302723 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:59:44.308806 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: ROLLBACK
[0m10:59:44.308806 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m10:59:44.310804 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m10:59:44.313318 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m10:59:44.314316 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        channel as value_field,
        count(*) as n_records

    from "attrib_analytics"."public"."mart_revenue_daily"
    group by channel

)

select *
from all_values
where value_field not in (
    'ads','email','direct'
)



  
  
      
    ) dbt_internal_test
[0m10:59:44.315318 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: Close
[0m10:59:44.316317 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m10:59:44.316317 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m10:59:44.318406 [info ] [Thread-2 (]: 2 of 4 PASS not_null_mart_revenue_daily_order_date ............................. [[32mPASS[0m in 0.19s]
[0m10:59:44.321582 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.19s]
[0m10:59:44.324581 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m10:59:44.323581 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.20s]
[0m10:59:44.326593 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m10:59:44.328099 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m10:59:44.329631 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: ROLLBACK
[0m10:59:44.331631 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m10:59:44.333631 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: Close
[0m10:59:44.334177 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_mart_revenue_daily_channel__ads__email__direct ..... [[32mPASS[0m in 0.21s]
[0m10:59:44.335606 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m10:59:44.337625 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:44.337625 [debug] [MainThread]: On master: BEGIN
[0m10:59:44.339135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:44.387064 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m10:59:44.387064 [debug] [MainThread]: On master: COMMIT
[0m10:59:44.388065 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:44.389062 [debug] [MainThread]: On master: COMMIT
[0m10:59:44.390765 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:59:44.390765 [debug] [MainThread]: On master: Close
[0m10:59:44.392287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:44.392287 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m10:59:44.393295 [debug] [MainThread]: Connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f' was properly closed.
[0m10:59:44.393295 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097' was properly closed.
[0m10:59:44.394466 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m10:59:44.394973 [debug] [MainThread]: Connection 'test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m10:59:44.394973 [info ] [MainThread]: 
[0m10:59:44.394973 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m10:59:44.398056 [debug] [MainThread]: Command end result
[0m10:59:44.463244 [info ] [MainThread]: 
[0m10:59:44.463789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:59:44.466292 [info ] [MainThread]: 
[0m10:59:44.466292 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:59:44.466292 [debug] [MainThread]: Command `dbt test` succeeded at 10:59:44.466292 after 2.06 seconds
[0m10:59:44.466292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015058AC0DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015058AC2DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015058AC2FF0>]}
[0m10:59:44.472259 [debug] [MainThread]: Flushing usage events
[0m11:31:46.602059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B308E870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B57861B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B52E2F90>]}


============================== 11:31:46.612893 | 33e11bc5-7fa0-496d-961e-944cad267f43 ==============================
[0m11:31:46.612893 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:31:46.613412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:31:47.047947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33e11bc5-7fa0-496d-961e-944cad267f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B77B76B0>]}
[0m11:31:47.130036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33e11bc5-7fa0-496d-961e-944cad267f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B5630740>]}
[0m11:31:47.134168 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:31:47.625304 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:31:47.775959 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:31:47.779970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33e11bc5-7fa0-496d-961e-944cad267f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B77DE7E0>]}
[0m11:31:48.967730 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:31:48.967730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '33e11bc5-7fa0-496d-961e-944cad267f43', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B7C4C710>]}
[0m11:31:49.478479 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.attribution_dbt
- seeds.attribution_dbt.orders_seed
[0m11:31:49.493074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33e11bc5-7fa0-496d-961e-944cad267f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B7D11F40>]}
[0m11:31:49.732860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33e11bc5-7fa0-496d-961e-944cad267f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B7CED2B0>]}
[0m11:31:49.732860 [info ] [MainThread]: Found 7 models, 11 data tests, 1 source, 433 macros
[0m11:31:49.737210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e11bc5-7fa0-496d-961e-944cad267f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B7C5BFE0>]}
[0m11:31:49.739804 [info ] [MainThread]: 
[0m11:31:49.739804 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:31:49.743298 [debug] [MainThread]: Command end result
[0m11:31:49.792743 [info ] [MainThread]: 
[0m11:31:49.792743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:31:49.796122 [info ] [MainThread]: 
[0m11:31:49.797168 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m11:31:49.800614 [debug] [MainThread]: Command `dbt seed` succeeded at 11:31:49.797168 after 3.61 seconds
[0m11:31:49.800614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B62B3E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B7B8FCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B373C6B0>]}
[0m11:31:49.800614 [debug] [MainThread]: Flushing usage events
[0m11:39:53.187089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F1CD5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EE0DCDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EE0DC890>]}


============================== 11:39:53.193034 | 9c0168d8-4d69-4386-bd97-27147f9f284d ==============================
[0m11:39:53.193034 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:39:53.193034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:39:53.604398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c0168d8-4d69-4386-bd97-27147f9f284d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F1E78740>]}
[0m11:39:53.682799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c0168d8-4d69-4386-bd97-27147f9f284d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F15C69C0>]}
[0m11:39:53.692310 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:39:54.184012 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:39:54.518874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:39:54.520185 [debug] [MainThread]: Partial parsing: added file: attribution_dbt://seeds\orders_seed.csv
[0m11:39:54.850839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c0168d8-4d69-4386-bd97-27147f9f284d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F37A50D0>]}
[0m11:39:55.017278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c0168d8-4d69-4386-bd97-27147f9f284d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F3869E80>]}
[0m11:39:55.020306 [info ] [MainThread]: Found 7 models, 11 data tests, 1 seed, 1 source, 433 macros
[0m11:39:55.020306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c0168d8-4d69-4386-bd97-27147f9f284d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F348B710>]}
[0m11:39:55.023249 [info ] [MainThread]: 
[0m11:39:55.026799 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:39:55.028471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m11:39:55.179902 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m11:39:55.179902 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m11:39:55.186403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:55.378324 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.192 seconds
[0m11:39:55.382162 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m11:39:55.383808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_attrib_analytics, now create_attrib_analytics_public_public)
[0m11:39:55.385055 [debug] [ThreadPool]: Creating schema "database: "attrib_analytics"
schema: "public_public"
"
[0m11:39:55.396356 [debug] [ThreadPool]: Using postgres connection "create_attrib_analytics_public_public"
[0m11:39:55.396887 [debug] [ThreadPool]: On create_attrib_analytics_public_public: BEGIN
[0m11:39:55.397461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:55.426097 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m11:39:55.426617 [debug] [ThreadPool]: Using postgres connection "create_attrib_analytics_public_public"
[0m11:39:55.427703 [debug] [ThreadPool]: On create_attrib_analytics_public_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_analytics_public_public"} */
create schema if not exists "public_public"
[0m11:39:55.442619 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.015 seconds
[0m11:39:55.442619 [debug] [ThreadPool]: On create_attrib_analytics_public_public: COMMIT
[0m11:39:55.442619 [debug] [ThreadPool]: Using postgres connection "create_attrib_analytics_public_public"
[0m11:39:55.442619 [debug] [ThreadPool]: On create_attrib_analytics_public_public: COMMIT
[0m11:39:55.451083 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m11:39:55.452660 [debug] [ThreadPool]: On create_attrib_analytics_public_public: Close
[0m11:39:55.458494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m11:39:55.458494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_public'
[0m11:39:55.463841 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m11:39:55.463841 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_public"
[0m11:39:55.473698 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m11:39:55.474732 [debug] [ThreadPool]: On list_attrib_analytics_public_public: BEGIN
[0m11:39:55.474732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:55.474732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:55.494132 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m11:39:55.494132 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m11:39:55.494132 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:39:55.521579 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m11:39:55.522113 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_public"
[0m11:39:55.522630 [debug] [ThreadPool]: On list_attrib_analytics_public_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:39:55.533738 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m11:39:55.533738 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.033 seconds
[0m11:39:55.537927 [debug] [ThreadPool]: On list_attrib_analytics_public_public: ROLLBACK
[0m11:39:55.539459 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m11:39:55.539459 [debug] [ThreadPool]: On list_attrib_analytics_public_public: Close
[0m11:39:55.539459 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m11:39:55.550928 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:55.554802 [debug] [MainThread]: On master: BEGIN
[0m11:39:55.554802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:55.572549 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m11:39:55.572549 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:55.572549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:39:55.589580 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m11:39:55.593873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c0168d8-4d69-4386-bd97-27147f9f284d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EF67CCE0>]}
[0m11:39:55.593873 [debug] [MainThread]: On master: ROLLBACK
[0m11:39:55.593873 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:55.593873 [debug] [MainThread]: On master: BEGIN
[0m11:39:55.597343 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:39:55.597343 [debug] [MainThread]: On master: COMMIT
[0m11:39:55.597343 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:55.598482 [debug] [MainThread]: On master: COMMIT
[0m11:39:55.599029 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:39:55.599029 [debug] [MainThread]: On master: Close
[0m11:39:55.599029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:39:55.601083 [info ] [MainThread]: 
[0m11:39:55.608855 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m11:39:55.608855 [info ] [Thread-1 (]: 1 of 1 START seed file public_public.orders_seed ............................... [RUN]
[0m11:39:55.611808 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m11:39:55.614246 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m11:39:55.614246 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m11:39:55.651786 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m11:39:55.651786 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m11:39:55.651786 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:39:55.676310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:39:55.676942 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m11:39:55.676942 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */

    create table "attrib_analytics"."public_public"."orders_seed" ("order_id" integer,"order_date" date,"channel" text,"amount" numeric(12,2))
  
[0m11:39:55.716447 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.041 seconds
[0m11:39:55.746700 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.attribution_dbt.orders_seed"
[0m11:39:55.774417 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m11:39:55.774417 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m11:39:55.774417 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m11:39:55.779316 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m11:39:55.784808 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m11:39:55.788257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c0168d8-4d69-4386-bd97-27147f9f284d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EF5D33B0>]}
[0m11:39:55.788257 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_public.orders_seed ........................... [[32mCREATE 0[0m in 0.18s]
[0m11:39:55.788257 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m11:39:55.788257 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:55.795063 [debug] [MainThread]: On master: BEGIN
[0m11:39:55.795063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:55.825874 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m11:39:55.826957 [debug] [MainThread]: On master: COMMIT
[0m11:39:55.826957 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:55.827970 [debug] [MainThread]: On master: COMMIT
[0m11:39:55.827970 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:39:55.827970 [debug] [MainThread]: On master: Close
[0m11:39:55.827970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:55.827970 [debug] [MainThread]: Connection 'create_attrib_analytics_public_public' was properly closed.
[0m11:39:55.832096 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m11:39:55.832096 [debug] [MainThread]: Connection 'list_attrib_analytics_public_public' was properly closed.
[0m11:39:55.832096 [debug] [MainThread]: Connection 'seed.attribution_dbt.orders_seed' was properly closed.
[0m11:39:55.832096 [info ] [MainThread]: 
[0m11:39:55.832096 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m11:39:55.836375 [debug] [MainThread]: Command end result
[0m11:39:55.874885 [info ] [MainThread]: 
[0m11:39:55.874885 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:55.877371 [info ] [MainThread]: 
[0m11:39:55.877371 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:39:55.877371 [debug] [MainThread]: Command `dbt seed` succeeded at 11:39:55.877371 after 2.96 seconds
[0m11:39:55.877371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F1D164B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F1AA97F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F14F0440>]}
[0m11:39:55.880958 [debug] [MainThread]: Flushing usage events
[0m11:48:35.313807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8516474D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8539F0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E851069AC0>]}


============================== 11:48:35.321031 | 2e7e6c82-3967-4cc8-8b54-7aed4f081598 ==============================
[0m11:48:35.321031 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:48:35.321031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_orders mart_revenue_daily --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m11:48:35.773411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e7e6c82-3967-4cc8-8b54-7aed4f081598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8542A9F10>]}
[0m11:48:35.874229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e7e6c82-3967-4cc8-8b54-7aed4f081598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E854309490>]}
[0m11:48:35.878327 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:48:36.345909 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:48:36.628310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:48:36.629419 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\staging\stg_orders.sql
[0m11:48:36.902785 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:48:36.904881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2e7e6c82-3967-4cc8-8b54-7aed4f081598', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E855C37770>]}
[0m11:48:37.143512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e7e6c82-3967-4cc8-8b54-7aed4f081598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E855C51310>]}
[0m11:48:37.323742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e7e6c82-3967-4cc8-8b54-7aed4f081598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E855A4CDA0>]}
[0m11:48:37.325750 [info ] [MainThread]: Found 7 models, 11 data tests, 1 seed, 1 source, 433 macros
[0m11:48:37.325750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7e6c82-3967-4cc8-8b54-7aed4f081598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E855DF9B80>]}
[0m11:48:37.329928 [info ] [MainThread]: 
[0m11:48:37.329928 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:48:37.334784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m11:48:37.428836 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m11:48:37.430846 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m11:48:37.430846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:37.546642 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.118 seconds
[0m11:48:37.550198 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m11:48:37.555119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m11:48:37.561916 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_public'
[0m11:48:37.564422 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m11:48:37.566982 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_public"
[0m11:48:37.567988 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m11:48:37.567988 [debug] [ThreadPool]: On list_attrib_analytics_public_public: BEGIN
[0m11:48:37.569496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:37.570247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:37.597967 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m11:48:37.598972 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m11:48:37.598972 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m11:48:37.598972 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_public"
[0m11:48:37.600983 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:48:37.600983 [debug] [ThreadPool]: On list_attrib_analytics_public_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:48:37.616977 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m11:48:37.616977 [debug] [ThreadPool]: On list_attrib_analytics_public_public: ROLLBACK
[0m11:48:37.616977 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.019 seconds
[0m11:48:37.623131 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m11:48:37.623131 [debug] [ThreadPool]: On list_attrib_analytics_public_public: Close
[0m11:48:37.623131 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m11:48:37.633555 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:37.633555 [debug] [MainThread]: On master: BEGIN
[0m11:48:37.633555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:48:37.671024 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m11:48:37.671024 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:37.673053 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:48:37.681346 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m11:48:37.681346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7e6c82-3967-4cc8-8b54-7aed4f081598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E855A4FC50>]}
[0m11:48:37.681346 [debug] [MainThread]: On master: ROLLBACK
[0m11:48:37.681346 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:37.681346 [debug] [MainThread]: On master: BEGIN
[0m11:48:37.686843 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:48:37.686843 [debug] [MainThread]: On master: COMMIT
[0m11:48:37.686843 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:37.688892 [debug] [MainThread]: On master: COMMIT
[0m11:48:37.689420 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:48:37.690060 [debug] [MainThread]: On master: Close
[0m11:48:37.690060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:48:37.690060 [info ] [MainThread]: 
[0m11:48:37.701350 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_orders
[0m11:48:37.703081 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_orders ................................. [RUN]
[0m11:48:37.704910 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m11:48:37.706859 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_orders
[0m11:48:37.726359 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m11:48:37.729875 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_orders
[0m11:48:37.779618 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_orders"
[0m11:48:37.782363 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m11:48:37.782887 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: BEGIN
[0m11:48:37.782887 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:48:37.825958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m11:48:37.826534 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m11:48:37.827689 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */

  
    

  create  table "attrib_analytics"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    select
	order_id,
    cast(order_date as date) as order_date,
    lower(channel) as channel,
    cast(amount as numeric(12,2)) as amount
from "attrib_analytics"."public_public"."orders_seed"
  );
  
[0m11:48:37.855467 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.027 seconds
[0m11:48:37.865783 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m11:48:37.865783 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:48:37.871387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:48:37.876131 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m11:48:37.876131 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:48:37.879805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:48:37.906170 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m11:48:37.906728 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m11:48:37.907300 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m11:48:37.913189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m11:48:37.922764 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public"."stg_orders__dbt_backup"
[0m11:48:37.931220 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m11:48:37.931220 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
drop table if exists "attrib_analytics"."public"."stg_orders__dbt_backup" cascade
[0m11:48:37.963113 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.032 seconds
[0m11:48:37.965122 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: Close
[0m11:48:37.970155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7e6c82-3967-4cc8-8b54-7aed4f081598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E851A77080>]}
[0m11:48:37.970155 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_orders ............................ [[32mSELECT 0[0m in 0.26s]
[0m11:48:37.972182 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_orders
[0m11:48:37.972182 [debug] [Thread-3 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m11:48:37.976171 [info ] [Thread-3 (]: 2 of 2 START sql table model public.mart_revenue_daily ......................... [RUN]
[0m11:48:37.977198 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_daily'
[0m11:48:37.978182 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m11:48:37.980696 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m11:48:37.980696 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m11:48:37.984913 [debug] [Thread-3 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_daily"
[0m11:48:37.991011 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m11:48:37.992083 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: BEGIN
[0m11:48:37.993091 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:48:38.017374 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m11:48:38.021735 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m11:48:38.022761 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
  order_date,
  channel,
  sum(amount) as revenue
from "attrib_analytics"."public"."stg_orders"
group by 1,2
  );
  
[0m11:48:38.042452 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.022 seconds
[0m11:48:38.049575 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m11:48:38.049575 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily" rename to "mart_revenue_daily__dbt_backup"
[0m11:48:38.049575 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:48:38.055530 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m11:48:38.057050 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp" rename to "mart_revenue_daily"
[0m11:48:38.057050 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:48:38.057050 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m11:48:38.057050 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m11:48:38.057050 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m11:48:38.063007 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m11:48:38.071212 [debug] [Thread-3 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_daily__dbt_backup"
[0m11:48:38.073260 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m11:48:38.073260 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_daily__dbt_backup" cascade
[0m11:48:38.086911 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m11:48:38.088933 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: Close
[0m11:48:38.090467 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7e6c82-3967-4cc8-8b54-7aed4f081598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85649AF30>]}
[0m11:48:38.090467 [info ] [Thread-3 (]: 2 of 2 OK created sql table model public.mart_revenue_daily .................... [[32mSELECT 0[0m in 0.11s]
[0m11:48:38.092554 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m11:48:38.095199 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:38.095199 [debug] [MainThread]: On master: BEGIN
[0m11:48:38.095199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:48:38.120728 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m11:48:38.124890 [debug] [MainThread]: On master: COMMIT
[0m11:48:38.124890 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:38.124890 [debug] [MainThread]: On master: COMMIT
[0m11:48:38.128398 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:48:38.128398 [debug] [MainThread]: On master: Close
[0m11:48:38.128398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:38.128398 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m11:48:38.130406 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m11:48:38.130406 [debug] [MainThread]: Connection 'list_attrib_analytics_public_public' was properly closed.
[0m11:48:38.130406 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_orders' was properly closed.
[0m11:48:38.132413 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_daily' was properly closed.
[0m11:48:38.132413 [info ] [MainThread]: 
[0m11:48:38.132413 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m11:48:38.135679 [debug] [MainThread]: Command end result
[0m11:48:38.166967 [info ] [MainThread]: 
[0m11:48:38.166967 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:48:38.169053 [info ] [MainThread]: 
[0m11:48:38.169053 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:48:38.169053 [debug] [MainThread]: Command `dbt run` succeeded at 11:48:38.169053 after 3.19 seconds
[0m11:48:38.169053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84E2FCD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8542CFFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8542CF7A0>]}
[0m11:48:38.169053 [debug] [MainThread]: Flushing usage events
[0m11:48:51.745835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025241889A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025241BA3E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523EA0C080>]}


============================== 11:48:51.751165 | 81b45646-658e-4a73-afee-6b0d8ea20824 ==============================
[0m11:48:51.751165 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:48:51.753188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_orders mart_revenue_daily', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:48:52.025030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81b45646-658e-4a73-afee-6b0d8ea20824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002524305DDF0>]}
[0m11:48:52.096916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81b45646-658e-4a73-afee-6b0d8ea20824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025240FB3320>]}
[0m11:48:52.096916 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:48:52.412059 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:48:52.689197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:52.689702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:52.768831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81b45646-658e-4a73-afee-6b0d8ea20824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025243197B30>]}
[0m11:48:52.964908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81b45646-658e-4a73-afee-6b0d8ea20824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252435F4E60>]}
[0m11:48:52.966793 [info ] [MainThread]: Found 7 models, 11 data tests, 1 seed, 1 source, 433 macros
[0m11:48:52.968076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b45646-658e-4a73-afee-6b0d8ea20824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252434C0FE0>]}
[0m11:48:52.971505 [info ] [MainThread]: 
[0m11:48:52.971505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:48:52.978848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_public'
[0m11:48:52.981960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m11:48:53.090910 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_public"
[0m11:48:53.092918 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m11:48:53.092918 [debug] [ThreadPool]: On list_attrib_analytics_public_public: BEGIN
[0m11:48:53.092918 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m11:48:53.094926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:53.096025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:53.156535 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m11:48:53.157208 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m11:48:53.158269 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m11:48:53.158788 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_public"
[0m11:48:53.159317 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:48:53.160407 [debug] [ThreadPool]: On list_attrib_analytics_public_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m11:48:53.167399 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m11:48:53.170337 [debug] [ThreadPool]: On list_attrib_analytics_public_public: ROLLBACK
[0m11:48:53.170872 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m11:48:53.173052 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m11:48:53.173754 [debug] [ThreadPool]: On list_attrib_analytics_public_public: Close
[0m11:48:53.175280 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m11:48:53.185360 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:53.185922 [debug] [MainThread]: On master: BEGIN
[0m11:48:53.186455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:48:53.208758 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m11:48:53.210183 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:53.210183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:48:53.223770 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m11:48:53.225884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b45646-658e-4a73-afee-6b0d8ea20824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025243085F10>]}
[0m11:48:53.226413 [debug] [MainThread]: On master: ROLLBACK
[0m11:48:53.227477 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:53.228236 [debug] [MainThread]: On master: BEGIN
[0m11:48:53.230615 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:48:53.231225 [debug] [MainThread]: On master: COMMIT
[0m11:48:53.231846 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:53.232375 [debug] [MainThread]: On master: COMMIT
[0m11:48:53.233529 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:48:53.234730 [debug] [MainThread]: On master: Close
[0m11:48:53.235690 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:48:53.236742 [info ] [MainThread]: 
[0m11:48:53.244281 [debug] [Thread-1 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m11:48:53.245368 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m11:48:53.245902 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m11:48:53.246461 [debug] [Thread-4 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m11:48:53.246996 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_mart_revenue_daily_channel__ads__email__direct  [RUN]
[0m11:48:53.246996 [info ] [Thread-2 (]: 2 of 4 START test not_null_mart_revenue_daily_order_date ....................... [RUN]
[0m11:48:53.246996 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m11:48:53.250151 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f'
[0m11:48:53.246996 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m11:48:53.251772 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097'
[0m11:48:53.252337 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64'
[0m11:48:53.252850 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m11:48:53.253853 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a'
[0m11:48:53.256916 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m11:48:53.257478 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m11:48:53.283428 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m11:48:53.283428 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m11:48:53.293915 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m11:48:53.293915 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:48:53.308830 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m11:48:53.308830 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m11:48:53.313082 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m11:48:53.315426 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m11:48:53.345139 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m11:48:53.348435 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m11:48:53.351545 [debug] [Thread-3 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:48:53.352604 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m11:48:53.356232 [debug] [Thread-4 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m11:48:53.356232 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m11:48:53.360005 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: BEGIN
[0m11:48:53.361053 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m11:48:53.361838 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:48:53.362844 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:48:53.363486 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m11:48:53.363486 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: BEGIN
[0m11:48:53.364594 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m11:48:53.365589 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m11:48:53.366540 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:48:53.367048 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:48:53.367048 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:48:53.386503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m11:48:53.386503 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m11:48:53.388501 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        channel as value_field,
        count(*) as n_records

    from "attrib_analytics"."public"."mart_revenue_daily"
    group by channel

)

select *
from all_values
where value_field not in (
    'ads','email','direct'
)



  
  
      
    ) dbt_internal_test
[0m11:48:53.394252 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m11:48:53.394668 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m11:48:53.395893 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m11:48:53.401644 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: ROLLBACK
[0m11:48:53.401644 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m11:48:53.401644 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "attrib_analytics"."public"."mart_revenue_daily"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m11:48:53.401644 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:48:53.405799 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: Close
[0m11:48:53.405799 [debug] [Thread-4 (]: SQL status: BEGIN in 0.038 seconds
[0m11:48:53.405799 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "attrib_analytics"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m11:48:53.408308 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m11:48:53.410448 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:48:53.408308 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_mart_revenue_daily_channel__ads__email__direct ..... [[32mPASS[0m in 0.16s]
[0m11:48:53.410954 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "attrib_analytics"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:48:53.415091 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: ROLLBACK
[0m11:48:53.416241 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:48:53.417289 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m11:48:53.420238 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m11:48:53.421323 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: Close
[0m11:48:53.424729 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m11:48:53.425685 [debug] [Thread-3 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m11:48:53.423565 [info ] [Thread-2 (]: 2 of 4 PASS not_null_mart_revenue_daily_order_date ............................. [[32mPASS[0m in 0.17s]
[0m11:48:53.428797 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m11:48:53.430482 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m11:48:53.430998 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.18s]
[0m11:48:53.433028 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m11:48:53.433028 [debug] [Thread-4 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m11:48:53.435061 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.18s]
[0m11:48:53.436475 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m11:48:53.438500 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:53.441212 [debug] [MainThread]: On master: BEGIN
[0m11:48:53.441854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:48:53.467773 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m11:48:53.467773 [debug] [MainThread]: On master: COMMIT
[0m11:48:53.467773 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:53.467773 [debug] [MainThread]: On master: COMMIT
[0m11:48:53.475370 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:48:53.475370 [debug] [MainThread]: On master: Close
[0m11:48:53.475370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:53.478774 [debug] [MainThread]: Connection 'list_attrib_analytics_public_public' was properly closed.
[0m11:48:53.478774 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m11:48:53.478774 [debug] [MainThread]: Connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f' was properly closed.
[0m11:48:53.480526 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097' was properly closed.
[0m11:48:53.481045 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m11:48:53.481045 [debug] [MainThread]: Connection 'test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m11:48:53.481045 [info ] [MainThread]: 
[0m11:48:53.483682 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m11:48:53.483682 [debug] [MainThread]: Command end result
[0m11:48:53.534158 [info ] [MainThread]: 
[0m11:48:53.536179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:48:53.538095 [info ] [MainThread]: 
[0m11:48:53.538095 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:48:53.540586 [debug] [MainThread]: Command `dbt test` succeeded at 11:48:53.540586 after 1.98 seconds
[0m11:48:53.540586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025241783B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523EA0C080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002524359E3C0>]}
[0m11:48:53.542349 [debug] [MainThread]: Flushing usage events
[0m11:50:53.606483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0416E4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0407C4AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0407C6240>]}


============================== 11:50:53.617812 | 89b0a092-cc2f-4ba4-8b0f-f6685e1ffd6c ==============================
[0m11:50:53.617812 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:50:53.618601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:54.165397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89b0a092-cc2f-4ba4-8b0f-f6685e1ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F043B8FF80>]}
[0m11:50:54.245346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89b0a092-cc2f-4ba4-8b0f-f6685e1ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F043B2B890>]}
[0m11:50:54.246678 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:50:54.655150 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:50:54.796873 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:50:54.796873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89b0a092-cc2f-4ba4-8b0f-f6685e1ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F043B8FDA0>]}
[0m11:50:56.381203 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:50:56.381203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '89b0a092-cc2f-4ba4-8b0f-f6685e1ffd6c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F045AA4590>]}
[0m11:50:56.890593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89b0a092-cc2f-4ba4-8b0f-f6685e1ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F045E5DD90>]}
[0m11:50:57.088288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89b0a092-cc2f-4ba4-8b0f-f6685e1ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F045CC38F0>]}
[0m11:50:57.091016 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 1 source, 433 macros
[0m11:50:57.091016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b0a092-cc2f-4ba4-8b0f-f6685e1ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F045BCE570>]}
[0m11:50:57.098647 [info ] [MainThread]: 
[0m11:50:57.098647 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:50:57.101635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m11:50:57.192044 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m11:50:57.192044 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m11:50:57.193186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:57.284118 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.091 seconds
[0m11:50:57.286981 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m11:50:57.288869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_attrib_analytics, now create_attrib_analytics_public_)
[0m11:50:57.289944 [debug] [ThreadPool]: Creating schema "database: "attrib_analytics"
schema: "public_"
"
[0m11:50:57.297897 [debug] [ThreadPool]: Using postgres connection "create_attrib_analytics_public_"
[0m11:50:57.297897 [debug] [ThreadPool]: On create_attrib_analytics_public_: BEGIN
[0m11:50:57.297897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:57.312706 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m11:50:57.316429 [debug] [ThreadPool]: Using postgres connection "create_attrib_analytics_public_"
[0m11:50:57.316429 [debug] [ThreadPool]: On create_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_analytics_public_"} */
create schema if not exists "public_"
[0m11:50:57.321999 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m11:50:57.323253 [debug] [ThreadPool]: On create_attrib_analytics_public_: COMMIT
[0m11:50:57.323253 [debug] [ThreadPool]: Using postgres connection "create_attrib_analytics_public_"
[0m11:50:57.323253 [debug] [ThreadPool]: On create_attrib_analytics_public_: COMMIT
[0m11:50:57.330493 [debug] [ThreadPool]: SQL status: COMMIT in 0.006 seconds
[0m11:50:57.330493 [debug] [ThreadPool]: On create_attrib_analytics_public_: Close
[0m11:50:57.338568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m11:50:57.338568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m11:50:57.347972 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m11:50:57.347972 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m11:50:57.347972 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m11:50:57.347972 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m11:50:57.347972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:57.347972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:57.370866 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m11:50:57.370866 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m11:50:57.370866 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:50:57.370866 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m11:50:57.370866 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m11:50:57.370866 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m11:50:57.380098 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m11:50:57.380098 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m11:50:57.380098 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m11:50:57.380098 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m11:50:57.380098 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m11:50:57.380098 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m11:50:57.389363 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:57.395138 [debug] [MainThread]: On master: BEGIN
[0m11:50:57.395699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:50:57.421327 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m11:50:57.421327 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:57.421327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:50:57.427071 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m11:50:57.431901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b0a092-cc2f-4ba4-8b0f-f6685e1ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F045E620F0>]}
[0m11:50:57.431901 [debug] [MainThread]: On master: ROLLBACK
[0m11:50:57.431901 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:57.431901 [debug] [MainThread]: On master: BEGIN
[0m11:50:57.434533 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:50:57.434533 [debug] [MainThread]: On master: COMMIT
[0m11:50:57.434533 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:57.434533 [debug] [MainThread]: On master: COMMIT
[0m11:50:57.434533 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:50:57.434533 [debug] [MainThread]: On master: Close
[0m11:50:57.434533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:50:57.434533 [info ] [MainThread]: 
[0m11:50:57.443648 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m11:50:57.443648 [info ] [Thread-1 (]: 1 of 1 START seed file public_.orders_seed ..................................... [RUN]
[0m11:50:57.451150 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m11:50:57.451150 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m11:50:57.453163 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m11:50:57.483065 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m11:50:57.484127 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m11:50:57.484127 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:50:57.504740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m11:50:57.504740 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m11:50:57.504740 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */

    create table "attrib_analytics"."public_"."orders_seed" ("order_id" integer,"order_date" date,"channel" text,"amount" numeric(12,2))
  
[0m11:50:57.518274 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.013 seconds
[0m11:50:57.543626 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.attribution_dbt.orders_seed"
[0m11:50:57.569556 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m11:50:57.569556 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m11:50:57.569556 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m11:50:57.569556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m11:50:57.578843 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m11:50:57.579350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b0a092-cc2f-4ba4-8b0f-f6685e1ffd6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F045CC17C0>]}
[0m11:50:57.579350 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_.orders_seed ................................. [[32mCREATE 0[0m in 0.13s]
[0m11:50:57.579350 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m11:50:57.587454 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:57.587454 [debug] [MainThread]: On master: BEGIN
[0m11:50:57.587454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:50:57.597732 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m11:50:57.608110 [debug] [MainThread]: On master: COMMIT
[0m11:50:57.608110 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:57.608110 [debug] [MainThread]: On master: COMMIT
[0m11:50:57.608110 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:50:57.608110 [debug] [MainThread]: On master: Close
[0m11:50:57.610900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:57.611701 [debug] [MainThread]: Connection 'create_attrib_analytics_public_' was properly closed.
[0m11:50:57.612290 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m11:50:57.612290 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m11:50:57.612290 [debug] [MainThread]: Connection 'seed.attribution_dbt.orders_seed' was properly closed.
[0m11:50:57.612290 [info ] [MainThread]: 
[0m11:50:57.612290 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m11:50:57.618408 [debug] [MainThread]: Command end result
[0m11:50:57.654314 [info ] [MainThread]: 
[0m11:50:57.654314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:57.654314 [info ] [MainThread]: 
[0m11:50:57.654314 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:50:57.658702 [debug] [MainThread]: Command `dbt seed` succeeded at 11:50:57.658702 after 4.38 seconds
[0m11:50:57.658702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0442CC5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0434A2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F045EF13D0>]}
[0m11:50:57.660336 [debug] [MainThread]: Flushing usage events
[0m12:37:46.549194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E4747EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E4747E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E4746630>]}


============================== 12:37:46.563725 | 1805ca05-59a2-4c01-bea2-402c5b8e0235 ==============================
[0m12:37:46.563725 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:37:46.563725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:37:46.908190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1805ca05-59a2-4c01-bea2-402c5b8e0235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E1DB91F0>]}
[0m12:37:46.966945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1805ca05-59a2-4c01-bea2-402c5b8e0235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E4B88320>]}
[0m12:37:46.966945 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:37:47.226941 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:37:47.506705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:47.506705 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://seeds\orders_seed.csv
[0m12:37:47.759502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1805ca05-59a2-4c01-bea2-402c5b8e0235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E6562990>]}
[0m12:37:47.923009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1805ca05-59a2-4c01-bea2-402c5b8e0235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E64FB3E0>]}
[0m12:37:47.923009 [info ] [MainThread]: Found 7 models, 11 data tests, 1 seed, 1 source, 433 macros
[0m12:37:47.923009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1805ca05-59a2-4c01-bea2-402c5b8e0235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E60F1CD0>]}
[0m12:37:47.927384 [info ] [MainThread]: 
[0m12:37:47.927384 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:37:47.932094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m12:37:48.107489 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m12:37:48.111147 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:37:48.111147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:48.315581 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.204 seconds
[0m12:37:48.317308 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m12:37:48.322939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m12:37:48.323944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m12:37:48.330021 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m12:37:48.332022 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:37:48.333022 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m12:37:48.333022 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m12:37:48.334023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:48.334023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:48.362925 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m12:37:48.363925 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:37:48.363925 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m12:37:48.365431 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:37:48.365431 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m12:37:48.366438 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m12:37:48.398034 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.032 seconds
[0m12:37:48.400041 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m12:37:48.401039 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m12:37:48.409222 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.042 seconds
[0m12:37:48.410223 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m12:37:48.411223 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m12:37:48.416728 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:48.416728 [debug] [MainThread]: On master: BEGIN
[0m12:37:48.418359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:48.434971 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m12:37:48.435977 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:48.435977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:37:48.464523 [debug] [MainThread]: SQL status: SELECT 0 in 0.028 seconds
[0m12:37:48.466614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1805ca05-59a2-4c01-bea2-402c5b8e0235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E65345F0>]}
[0m12:37:48.466614 [debug] [MainThread]: On master: ROLLBACK
[0m12:37:48.468132 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:48.469138 [debug] [MainThread]: On master: BEGIN
[0m12:37:48.470640 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:37:48.470640 [debug] [MainThread]: On master: COMMIT
[0m12:37:48.471646 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:48.471646 [debug] [MainThread]: On master: COMMIT
[0m12:37:48.472644 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:37:48.472644 [debug] [MainThread]: On master: Close
[0m12:37:48.473648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:48.474648 [info ] [MainThread]: 
[0m12:37:48.481150 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m12:37:48.481737 [info ] [Thread-1 (]: 1 of 1 START seed file public_.orders_seed ..................................... [RUN]
[0m12:37:48.482743 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m12:37:48.483245 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m12:37:48.483245 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m12:37:48.515775 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public_"."orders_seed"
[0m12:37:48.521775 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m12:37:48.522279 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */
drop table if exists "attrib_analytics"."public_"."orders_seed" cascade
[0m12:37:48.522279 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:37:48.593033 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.071 seconds
[0m12:37:48.601063 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m12:37:48.602062 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m12:37:48.603063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m12:37:48.603063 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m12:37:48.604064 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */

    create table "attrib_analytics"."public_"."orders_seed" ("order_id" integer,"order_date" date,"channel" text,"amount" numeric(12,2))
  
[0m12:37:48.646490 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.042 seconds
[0m12:37:48.667546 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m12:37:48.668557 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: 
          insert into "attrib_analytics"."public_"."orders_seed" ("order_id", "order_date", "channel", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m12:37:48.688325 [debug] [Thread-1 (]: Postgres adapter: Postgres error: date/time field value out of range: "25/10/2025"
LINE 3:           ('1','25/10/2025','ads','120.5'),('2','26/10/2025'...
                       ^
HINT:  Perhaps you need a different "datestyle" setting.

[0m12:37:48.689326 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: ROLLBACK
[0m12:37:48.690964 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m12:37:49.033651 [debug] [Thread-1 (]: Database Error in seed orders_seed (seeds\orders_seed.csv)
  date/time field value out of range: "25/10/2025"
  LINE 3:           ('1','25/10/2025','ads','120.5'),('2','26/10/2025'...
                         ^
  HINT:  Perhaps you need a different "datestyle" setting.
[0m12:37:49.037675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1805ca05-59a2-4c01-bea2-402c5b8e0235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E6BCBA10>]}
[0m12:37:49.037675 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public_.orders_seed ............................. [[31mERROR[0m in 0.55s]
[0m12:37:49.037675 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m12:37:49.042655 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:49.042655 [debug] [MainThread]: On master: BEGIN
[0m12:37:49.044177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:49.062493 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m12:37:49.065051 [debug] [MainThread]: On master: COMMIT
[0m12:37:49.065786 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:49.065786 [debug] [MainThread]: On master: COMMIT
[0m12:37:49.065786 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:37:49.068827 [debug] [MainThread]: On master: Close
[0m12:37:49.069405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:49.069405 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m12:37:49.069405 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m12:37:49.069405 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m12:37:49.069405 [debug] [MainThread]: Connection 'seed.attribution_dbt.orders_seed' was properly closed.
[0m12:37:49.107064 [info ] [MainThread]: 
[0m12:37:49.162337 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m12:37:49.164457 [debug] [MainThread]: Command end result
[0m12:37:49.319839 [info ] [MainThread]: 
[0m12:37:49.330027 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:37:49.345860 [info ] [MainThread]: 
[0m12:37:49.346974 [error] [MainThread]:   Database Error in seed orders_seed (seeds\orders_seed.csv)
  date/time field value out of range: "25/10/2025"
  LINE 3:           ('1','25/10/2025','ads','120.5'),('2','26/10/2025'...
                         ^
  HINT:  Perhaps you need a different "datestyle" setting.
[0m12:37:49.346974 [info ] [MainThread]: 
[0m12:37:49.346974 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:37:49.350605 [debug] [MainThread]: Command `dbt seed` failed at 12:37:49.350605 after 3.07 seconds
[0m12:37:49.350605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E0E84E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E653BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E484EFC0>]}
[0m12:37:49.350605 [debug] [MainThread]: Flushing usage events
[0m12:37:52.882682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBC0C21E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBC83CB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBC413BC0>]}


============================== 12:37:52.887890 | 79208ba2-5e4c-4a19-9b2b-72c35206b55d ==============================
[0m12:37:52.887890 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:37:52.887890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_orders mart_revenue_daily --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:37:53.054366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79208ba2-5e4c-4a19-9b2b-72c35206b55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBCB08D40>]}
[0m12:37:53.107173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79208ba2-5e4c-4a19-9b2b-72c35206b55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBCBFCB30>]}
[0m12:37:53.112276 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:37:53.303521 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:37:53.466291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:53.466291 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:53.519073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79208ba2-5e4c-4a19-9b2b-72c35206b55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBE30BC80>]}
[0m12:37:53.639656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79208ba2-5e4c-4a19-9b2b-72c35206b55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBE65A660>]}
[0m12:37:53.639656 [info ] [MainThread]: Found 7 models, 11 data tests, 1 seed, 1 source, 433 macros
[0m12:37:53.639656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79208ba2-5e4c-4a19-9b2b-72c35206b55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBE4CBAA0>]}
[0m12:37:53.642422 [info ] [MainThread]: 
[0m12:37:53.644178 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:37:53.648219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m12:37:53.716806 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m12:37:53.716806 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:37:53.717906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:53.740445 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.027 seconds
[0m12:37:53.746426 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m12:37:53.746948 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m12:37:53.749467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m12:37:53.752644 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:37:53.752644 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m12:37:53.752644 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m12:37:53.760133 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m12:37:53.760133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:53.760133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:53.795759 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m12:37:53.796768 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m12:37:53.796768 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m12:37:53.797768 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:37:53.797768 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m12:37:53.798764 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:37:53.801866 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:37:53.801866 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m12:37:53.801866 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m12:37:53.801866 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m12:37:53.801866 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m12:37:53.807450 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m12:37:53.812127 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:53.812127 [debug] [MainThread]: On master: BEGIN
[0m12:37:53.815462 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:53.842386 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m12:37:53.842901 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:53.842901 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:37:53.847061 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:37:53.849728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79208ba2-5e4c-4a19-9b2b-72c35206b55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBE42CB90>]}
[0m12:37:53.849728 [debug] [MainThread]: On master: ROLLBACK
[0m12:37:53.849728 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:53.849728 [debug] [MainThread]: On master: BEGIN
[0m12:37:53.853250 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:37:53.853250 [debug] [MainThread]: On master: COMMIT
[0m12:37:53.853250 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:53.853250 [debug] [MainThread]: On master: COMMIT
[0m12:37:53.853250 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:37:53.853250 [debug] [MainThread]: On master: Close
[0m12:37:53.857180 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:53.857180 [info ] [MainThread]: 
[0m12:37:53.863440 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_orders
[0m12:37:53.863440 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_orders ................................. [RUN]
[0m12:37:53.863440 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m12:37:53.863440 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_orders
[0m12:37:53.874739 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m12:37:53.874739 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_orders
[0m12:37:53.920538 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_orders"
[0m12:37:53.924086 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:37:53.924086 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: BEGIN
[0m12:37:53.926171 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:37:53.949695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m12:37:53.949695 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:37:53.949695 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */

  
    

  create  table "attrib_analytics"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    select
	order_id,
    cast(order_date as date) as order_date,
    lower(channel) as channel,
    cast(amount as numeric(12,2)) as amount
from "attrib_analytics"."public_"."orders_seed"
  );
  
[0m12:37:53.967279 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.017 seconds
[0m12:37:53.977671 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:37:53.977671 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:37:53.977671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:37:53.987729 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:37:53.988753 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:37:53.992001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:37:54.009324 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m12:37:54.009324 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:37:54.010325 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m12:37:54.018602 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m12:37:54.018602 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public"."stg_orders__dbt_backup"
[0m12:37:54.029272 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:37:54.029272 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
drop table if exists "attrib_analytics"."public"."stg_orders__dbt_backup" cascade
[0m12:37:54.039527 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:37:54.039527 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: Close
[0m12:37:54.039527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79208ba2-5e4c-4a19-9b2b-72c35206b55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBA483380>]}
[0m12:37:54.039527 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_orders ............................ [[32mSELECT 0[0m in 0.18s]
[0m12:37:54.039527 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_orders
[0m12:37:54.048978 [debug] [Thread-3 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m12:37:54.050507 [info ] [Thread-3 (]: 2 of 2 START sql table model public.mart_revenue_daily ......................... [RUN]
[0m12:37:54.051026 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_daily'
[0m12:37:54.051026 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m12:37:54.051026 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m12:37:54.051026 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m12:37:54.060403 [debug] [Thread-3 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_daily"
[0m12:37:54.062465 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:37:54.062465 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: BEGIN
[0m12:37:54.064735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:37:54.091653 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m12:37:54.091653 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:37:54.091653 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
  order_date,
  channel,
  sum(amount) as revenue
from "attrib_analytics"."public"."stg_orders"
group by 1,2
  );
  
[0m12:37:54.115903 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.021 seconds
[0m12:37:54.118903 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:37:54.118903 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily" rename to "mart_revenue_daily__dbt_backup"
[0m12:37:54.120904 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:37:54.123422 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:37:54.124426 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp" rename to "mart_revenue_daily"
[0m12:37:54.125424 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:37:54.126421 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m12:37:54.126421 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:37:54.126421 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m12:37:54.131141 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m12:37:54.134714 [debug] [Thread-3 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_daily__dbt_backup"
[0m12:37:54.134714 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:37:54.134714 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_daily__dbt_backup" cascade
[0m12:37:54.142601 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:37:54.143121 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: Close
[0m12:37:54.143121 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79208ba2-5e4c-4a19-9b2b-72c35206b55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBEC86EA0>]}
[0m12:37:54.143121 [info ] [Thread-3 (]: 2 of 2 OK created sql table model public.mart_revenue_daily .................... [[32mSELECT 0[0m in 0.09s]
[0m12:37:54.146761 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m12:37:54.153435 [error] [MainThread]: CANCEL query list_attrib_analytics ............................................. [[31mCANCEL[0m]
[0m12:37:54.153435 [error] [MainThread]: CANCEL query list_attrib_analytics_public ...................................... [[31mCANCEL[0m]
[0m12:37:54.153435 [error] [MainThread]: CANCEL query list_attrib_analytics_public_ ..................................... [[31mCANCEL[0m]
[0m12:37:54.157553 [error] [MainThread]: CANCEL query model.attribution_dbt.stg_orders .................................. [[31mCANCEL[0m]
[0m12:37:54.158061 [error] [MainThread]: CANCEL query model.attribution_dbt.mart_revenue_daily .......................... [[31mCANCEL[0m]
[0m12:37:54.158598 [info ] [MainThread]: 
[0m12:37:54.159665 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m12:37:54.160204 [info ] [MainThread]: 
[0m12:37:54.160730 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:37:54.161256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:54.161781 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m12:37:54.162307 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m12:37:54.162823 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m12:37:54.162823 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_orders' was properly closed.
[0m12:37:54.163379 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_daily' was properly closed.
[0m12:37:54.163895 [info ] [MainThread]: 
[0m12:37:54.164428 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m12:37:54.164949 [error] [MainThread]: Encountered an error:

[0m12:37:54.242788 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\task\runnable.py", line 487, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\task\runnable.py", line 397, in execute_nodes
    self.run_queue(pool)
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\task\runnable.py", line 315, in run_queue
    self.job_queue.join()
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\graph\queue.py", line 198, in join
    self.inner.join()
  File "C:\Users\danie\AppData\Local\Programs\Python\Python312\Lib\queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "C:\Users\danie\AppData\Local\Programs\Python\Python312\Lib\threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m12:37:54.246590 [debug] [MainThread]: Command `dbt run` failed at 12:37:54.246590 after 1.50 seconds
[0m12:37:54.246590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBC0C21E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBEA670B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BBEC87710>]}
[0m12:37:54.246590 [debug] [MainThread]: Flushing usage events
[0m12:39:57.144512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DAC194140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DAC283D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DAC1D11F0>]}


============================== 12:39:57.151439 | 2cef5c73-8175-4c58-8a25-c2131553a378 ==============================
[0m12:39:57.151439 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:39:57.152459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:57.379783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cef5c73-8175-4c58-8a25-c2131553a378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DAC1970E0>]}
[0m12:39:57.423300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cef5c73-8175-4c58-8a25-c2131553a378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DAB7B0380>]}
[0m12:39:57.423300 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:57.634722 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:39:57.832867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:39:57.834416 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://seeds\orders_seed.csv
[0m12:39:58.081091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cef5c73-8175-4c58-8a25-c2131553a378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DADC82480>]}
[0m12:39:58.217519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cef5c73-8175-4c58-8a25-c2131553a378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DADC23110>]}
[0m12:39:58.219534 [info ] [MainThread]: Found 7 models, 11 data tests, 1 seed, 1 source, 433 macros
[0m12:39:58.219534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cef5c73-8175-4c58-8a25-c2131553a378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DADC83350>]}
[0m12:39:58.223554 [info ] [MainThread]: 
[0m12:39:58.223554 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:58.225085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m12:39:58.313911 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m12:39:58.313911 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:39:58.318315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:58.388114 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.070 seconds
[0m12:39:58.389766 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m12:39:58.395668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m12:39:58.396755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m12:39:58.402849 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m12:39:58.405053 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:39:58.405579 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m12:39:58.406119 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m12:39:58.406119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:58.406661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:58.431518 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m12:39:58.431518 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m12:39:58.432555 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m12:39:58.432555 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:39:58.432555 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m12:39:58.432555 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:39:58.440849 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m12:39:58.440849 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m12:39:58.440849 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m12:39:58.440849 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m12:39:58.440849 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m12:39:58.447531 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m12:39:58.452053 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:58.452053 [debug] [MainThread]: On master: BEGIN
[0m12:39:58.455094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:58.472012 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m12:39:58.472012 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:58.472012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:58.483496 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m12:39:58.483496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cef5c73-8175-4c58-8a25-c2131553a378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA9AFCC50>]}
[0m12:39:58.483496 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:58.483496 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:58.483496 [debug] [MainThread]: On master: BEGIN
[0m12:39:58.492826 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:39:58.492826 [debug] [MainThread]: On master: COMMIT
[0m12:39:58.492826 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:58.492826 [debug] [MainThread]: On master: COMMIT
[0m12:39:58.495502 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:39:58.495502 [debug] [MainThread]: On master: Close
[0m12:39:58.495502 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:58.495502 [info ] [MainThread]: 
[0m12:39:58.503053 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m12:39:58.503053 [info ] [Thread-1 (]: 1 of 1 START seed file public_.orders_seed ..................................... [RUN]
[0m12:39:58.503053 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m12:39:58.503053 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m12:39:58.503053 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m12:39:58.534315 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public_"."orders_seed"
[0m12:39:58.543475 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m12:39:58.544532 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */
drop table if exists "attrib_analytics"."public_"."orders_seed" cascade
[0m12:39:58.544532 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:58.581845 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.037 seconds
[0m12:39:58.586647 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m12:39:58.586647 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m12:39:58.586647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m12:39:58.586647 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m12:39:58.591745 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */

    create table "attrib_analytics"."public_"."orders_seed" ("order_id" integer,"order_date" date,"channel" text,"amount" numeric(12,2))
  
[0m12:39:58.618264 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.030 seconds
[0m12:39:58.628898 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m12:39:58.628898 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: 
          insert into "attrib_analytics"."public_"."orders_seed" ("order_id", "order_date", "channel", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m12:39:58.641475 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.008 seconds
[0m12:39:58.649496 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.attribution_dbt.orders_seed"
[0m12:39:58.673019 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m12:39:58.673019 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m12:39:58.673019 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m12:39:58.687306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m12:39:58.689550 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m12:39:58.691069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cef5c73-8175-4c58-8a25-c2131553a378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA9A57110>]}
[0m12:39:58.691069 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_.orders_seed ................................. [[32mCREATE 3[0m in 0.19s]
[0m12:39:58.691069 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m12:39:58.691069 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:58.691069 [debug] [MainThread]: On master: BEGIN
[0m12:39:58.697392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:58.730838 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m12:39:58.731364 [debug] [MainThread]: On master: COMMIT
[0m12:39:58.731364 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:58.731917 [debug] [MainThread]: On master: COMMIT
[0m12:39:58.732938 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:39:58.732938 [debug] [MainThread]: On master: Close
[0m12:39:58.732938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:58.732938 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m12:39:58.732938 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m12:39:58.732938 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m12:39:58.732938 [debug] [MainThread]: Connection 'seed.attribution_dbt.orders_seed' was properly closed.
[0m12:39:58.735504 [info ] [MainThread]: 
[0m12:39:58.736082 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m12:39:58.736082 [debug] [MainThread]: Command end result
[0m12:39:58.763642 [info ] [MainThread]: 
[0m12:39:58.763642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:58.763642 [info ] [MainThread]: 
[0m12:39:58.763642 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:58.767273 [debug] [MainThread]: Command `dbt seed` succeeded at 12:39:58.767273 after 1.79 seconds
[0m12:39:58.767954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DAC2BB920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DAC157260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DAC155850>]}
[0m12:39:58.767954 [debug] [MainThread]: Flushing usage events
[0m12:40:11.809574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA39A7B770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3A2B3FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA37B4B5F0>]}


============================== 12:40:11.813760 | 46410018-cb4a-4e70-811c-c57805736a35 ==============================
[0m12:40:11.813760 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:40:11.813760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_orders mart_revenue_daily --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:40:11.968314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46410018-cb4a-4e70-811c-c57805736a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA39A12420>]}
[0m12:40:12.020935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46410018-cb4a-4e70-811c-c57805736a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3A3FDD90>]}
[0m12:40:12.022944 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:40:12.209396 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:40:12.393394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:12.393394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:12.444579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46410018-cb4a-4e70-811c-c57805736a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3B85B170>]}
[0m12:40:12.559678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46410018-cb4a-4e70-811c-c57805736a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3BBAABA0>]}
[0m12:40:12.559678 [info ] [MainThread]: Found 7 models, 11 data tests, 1 seed, 1 source, 433 macros
[0m12:40:12.559678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46410018-cb4a-4e70-811c-c57805736a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3B997E60>]}
[0m12:40:12.559678 [info ] [MainThread]: 
[0m12:40:12.559678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:40:12.570435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m12:40:12.634374 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m12:40:12.634374 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:40:12.634374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:12.657449 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.027 seconds
[0m12:40:12.663699 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m12:40:12.666238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m12:40:12.666238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m12:40:12.671548 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:40:12.676215 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m12:40:12.676215 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m12:40:12.676215 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m12:40:12.676215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:12.676215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:12.687589 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m12:40:12.694647 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m12:40:12.694647 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m12:40:12.697966 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:40:12.697966 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m12:40:12.697966 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m12:40:12.705039 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m12:40:12.705039 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m12:40:12.705039 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:40:12.705039 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m12:40:12.713803 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m12:40:12.715102 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m12:40:12.719766 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:12.719766 [debug] [MainThread]: On master: BEGIN
[0m12:40:12.719766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:12.758013 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m12:40:12.758013 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:12.758013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:40:12.761725 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:40:12.761725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46410018-cb4a-4e70-811c-c57805736a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3BBABCB0>]}
[0m12:40:12.761725 [debug] [MainThread]: On master: ROLLBACK
[0m12:40:12.767360 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:12.768399 [debug] [MainThread]: On master: BEGIN
[0m12:40:12.768399 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:40:12.768399 [debug] [MainThread]: On master: COMMIT
[0m12:40:12.768399 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:12.768399 [debug] [MainThread]: On master: COMMIT
[0m12:40:12.772005 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:40:12.772005 [debug] [MainThread]: On master: Close
[0m12:40:12.772005 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:12.772005 [info ] [MainThread]: 
[0m12:40:12.778975 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_orders
[0m12:40:12.778975 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_orders ................................. [RUN]
[0m12:40:12.778975 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m12:40:12.778975 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_orders
[0m12:40:12.789461 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m12:40:12.789461 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_orders
[0m12:40:12.825599 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_orders"
[0m12:40:12.825599 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:40:12.825599 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: BEGIN
[0m12:40:12.825599 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:12.851263 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m12:40:12.851263 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:40:12.851263 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */

  
    

  create  table "attrib_analytics"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    select
	order_id,
    cast(order_date as date) as order_date,
    lower(channel) as channel,
    cast(amount as numeric(12,2)) as amount
from "attrib_analytics"."public_"."orders_seed"
  );
  
[0m12:40:12.863518 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.013 seconds
[0m12:40:12.872971 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:40:12.872971 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:40:12.872971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:40:12.881463 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:40:12.881463 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:40:12.882472 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:40:12.895656 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m12:40:12.895656 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:40:12.895656 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m12:40:12.906250 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:40:12.913130 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public"."stg_orders__dbt_backup"
[0m12:40:12.915722 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m12:40:12.915722 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
drop table if exists "attrib_analytics"."public"."stg_orders__dbt_backup" cascade
[0m12:40:12.927603 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m12:40:12.933437 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: Close
[0m12:40:12.934443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46410018-cb4a-4e70-811c-c57805736a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA37A86CC0>]}
[0m12:40:12.936851 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_orders ............................ [[32mSELECT 3[0m in 0.16s]
[0m12:40:12.936851 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_orders
[0m12:40:12.936851 [debug] [Thread-3 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m12:40:12.936851 [info ] [Thread-3 (]: 2 of 2 START sql table model public.mart_revenue_daily ......................... [RUN]
[0m12:40:12.936851 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_daily'
[0m12:40:12.936851 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m12:40:12.943444 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m12:40:12.943444 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m12:40:12.945053 [debug] [Thread-3 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_daily"
[0m12:40:12.945053 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:40:12.945053 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: BEGIN
[0m12:40:12.945053 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:40:12.976691 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m12:40:12.976691 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:40:12.976691 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
  order_date,
  channel,
  sum(amount) as revenue
from "attrib_analytics"."public"."stg_orders"
group by 1,2
  );
  
[0m12:40:12.997991 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.015 seconds
[0m12:40:13.000381 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:40:13.000381 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily" rename to "mart_revenue_daily__dbt_backup"
[0m12:40:13.000381 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:40:13.000381 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:40:13.000381 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp" rename to "mart_revenue_daily"
[0m12:40:13.007593 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:40:13.007593 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m12:40:13.009959 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:40:13.009959 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m12:40:13.016476 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m12:40:13.018074 [debug] [Thread-3 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_daily__dbt_backup"
[0m12:40:13.018074 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m12:40:13.018074 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_daily__dbt_backup" cascade
[0m12:40:13.028310 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:40:13.031695 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: Close
[0m12:40:13.032427 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46410018-cb4a-4e70-811c-c57805736a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3C274E00>]}
[0m12:40:13.032427 [info ] [Thread-3 (]: 2 of 2 OK created sql table model public.mart_revenue_daily .................... [[32mSELECT 3[0m in 0.10s]
[0m12:40:13.032427 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m12:40:13.032427 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:13.032427 [debug] [MainThread]: On master: BEGIN
[0m12:40:13.032427 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:13.071286 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:40:13.071286 [debug] [MainThread]: On master: COMMIT
[0m12:40:13.071286 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:13.071286 [debug] [MainThread]: On master: COMMIT
[0m12:40:13.071286 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:40:13.071286 [debug] [MainThread]: On master: Close
[0m12:40:13.071286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:13.071286 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m12:40:13.079081 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m12:40:13.079081 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m12:40:13.079727 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_orders' was properly closed.
[0m12:40:13.079727 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_daily' was properly closed.
[0m12:40:13.080248 [info ] [MainThread]: 
[0m12:40:13.080248 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m12:40:13.080248 [debug] [MainThread]: Command end result
[0m12:40:13.108291 [info ] [MainThread]: 
[0m12:40:13.108291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:13.111777 [info ] [MainThread]: 
[0m12:40:13.112332 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:40:13.112332 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:13.112332 after 1.45 seconds
[0m12:40:13.112332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA393640B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA393641A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA39F59730>]}
[0m12:40:13.112332 [debug] [MainThread]: Flushing usage events
[0m13:49:42.927994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3AF58380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3AF59730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3AF584D0>]}


============================== 13:49:42.935779 | 34c32852-bec3-48f6-9300-b3e114abc27f ==============================
[0m13:49:42.935779 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:49:42.935779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m13:49:43.504810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3AFB88C0>]}
[0m13:49:43.557849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3ADEF2C0>]}
[0m13:49:43.557849 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:49:44.094215 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:49:47.139743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:47.139743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:47.193181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3C61CAA0>]}
[0m13:49:47.403386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3C84AB10>]}
[0m13:49:47.404354 [info ] [MainThread]: Found 7 models, 11 data tests, 1 seed, 1 source, 433 macros
[0m13:49:47.408933 [info ] [MainThread]: 
[0m13:49:47.408933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:49:47.414662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m13:49:47.426596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m13:49:50.959049 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m13:49:50.959049 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:49:50.959049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:50.963712 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m13:49:50.963712 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:49:50.963712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:51.082935 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.120 seconds
[0m13:49:51.082935 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.119 seconds
[0m13:49:51.082935 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m13:49:51.082935 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m13:49:51.082935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m13:49:51.093518 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m13:49:51.097126 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m13:49:51.097126 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m13:49:51.097126 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m13:49:51.097126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:51.097126 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m13:49:51.097126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:51.124347 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m13:49:51.124347 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m13:49:51.124347 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m13:49:51.130318 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m13:49:51.131320 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m13:49:51.131320 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:49:51.145873 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m13:49:51.147244 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m13:49:51.149255 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.017 seconds
[0m13:49:51.149255 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m13:49:51.149255 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m13:49:51.153358 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m13:49:51.158333 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:51.158333 [debug] [MainThread]: On master: BEGIN
[0m13:49:51.160860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:51.193493 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m13:49:51.194115 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:51.194115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:49:51.217251 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m13:49:51.219061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3C61D5B0>]}
[0m13:49:51.220191 [debug] [MainThread]: On master: ROLLBACK
[0m13:49:51.221790 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:51.222371 [debug] [MainThread]: On master: BEGIN
[0m13:49:51.225076 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:49:51.225624 [debug] [MainThread]: On master: COMMIT
[0m13:49:51.226693 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:51.227224 [debug] [MainThread]: On master: COMMIT
[0m13:49:51.228819 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:49:51.229357 [debug] [MainThread]: On master: Close
[0m13:49:51.230451 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:49:51.231527 [info ] [MainThread]: 
[0m13:49:51.240029 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_chain_blocks
[0m13:49:51.241114 [debug] [Thread-2 (]: Began running node model.attribution_dbt.stg_chain_mempool
[0m13:49:51.241652 [debug] [Thread-3 (]: Began running node model.attribution_dbt.stg_gold_attribution
[0m13:49:51.242782 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_gold_sessions
[0m13:49:51.243325 [info ] [Thread-1 (]: 1 of 19 START sql table model public.stg_chain_blocks .......................... [RUN]
[0m13:49:51.244929 [info ] [Thread-2 (]: 2 of 19 START sql table model public.stg_chain_mempool ......................... [RUN]
[0m13:49:51.245994 [info ] [Thread-3 (]: 3 of 19 START sql table model public.stg_gold_attribution ...................... [RUN]
[0m13:49:51.245994 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_chain_blocks'
[0m13:49:51.250271 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_chain_mempool'
[0m13:49:51.245994 [info ] [Thread-4 (]: 4 of 19 START sql table model public.stg_gold_sessions ......................... [RUN]
[0m13:49:51.251291 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_gold_attribution'
[0m13:49:51.253313 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_chain_blocks
[0m13:49:51.253313 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.stg_chain_mempool
[0m13:49:51.253313 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_gold_sessions'
[0m13:49:51.253313 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.stg_gold_attribution
[0m13:49:51.269817 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_blocks"
[0m13:49:51.272635 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.stg_chain_mempool"
[0m13:49:51.272635 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_gold_sessions
[0m13:49:51.277208 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_attribution"
[0m13:49:51.280305 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_gold_sessions"
[0m13:49:51.283417 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_chain_blocks
[0m13:49:51.283417 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.stg_chain_mempool
[0m13:49:51.285577 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.stg_gold_attribution
[0m13:49:51.328664 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_gold_sessions
[0m13:49:51.343040 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_chain_blocks"
[0m13:49:51.345880 [debug] [Thread-2 (]: Writing runtime sql for node "model.attribution_dbt.stg_chain_mempool"
[0m13:49:51.352679 [debug] [Thread-3 (]: Writing runtime sql for node "model.attribution_dbt.stg_gold_attribution"
[0m13:49:51.356046 [debug] [Thread-4 (]: Writing runtime sql for node "model.attribution_dbt.stg_gold_sessions"
[0m13:49:51.358811 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_chain_blocks"
[0m13:49:51.359986 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.stg_gold_attribution"
[0m13:49:51.360515 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: BEGIN
[0m13:49:51.361054 [debug] [Thread-3 (]: On model.attribution_dbt.stg_gold_attribution: BEGIN
[0m13:49:51.362163 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_gold_sessions"
[0m13:49:51.362693 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.stg_chain_mempool"
[0m13:49:51.363213 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:49:51.363739 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:49:51.363739 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: BEGIN
[0m13:49:51.364286 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: BEGIN
[0m13:49:51.364286 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:49:51.364286 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:49:51.383667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:49:51.383667 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m13:49:51.385686 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_chain_blocks"
[0m13:49:51.385686 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.stg_gold_attribution"
[0m13:49:51.385686 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_blocks"} */

  
    

  create  table "attrib_analytics"."public"."stg_chain_blocks__dbt_tmp"
  
  
    as
  
  (
    ï»¿select * from read_parquet('s3://dp-silver/chain_blocks/date=*/*.parquet')
  );
  
[0m13:49:51.385686 [debug] [Thread-3 (]: On model.attribution_dbt.stg_gold_attribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_attribution"} */

  
    

  create  table "attrib_analytics"."public"."stg_gold_attribution__dbt_tmp"
  
  
    as
  
  (
    ï»¿select * from read_parquet('s3://dp-gold/web2_attribution/date=*/*.parquet')
  );
  
[0m13:49:51.385686 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m13:49:51.385686 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_gold_sessions"
[0m13:49:51.390943 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_gold_sessions"} */

  
    

  create  table "attrib_analytics"."public"."stg_gold_sessions__dbt_tmp"
  
  
    as
  
  (
    ï»¿select * from read_parquet('s3://dp-gold/web2_sessions/date=*/*.parquet')
  );
  
[0m13:49:51.390943 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "ï»¿select"
LINE 12:     ï»¿select * from read_parquet('s3://dp-silver/chain_blocks...
             ^

[0m13:49:51.392691 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "ï»¿select"
LINE 12:     ï»¿select * from read_parquet('s3://dp-gold/web2_sessions/...
             ^

[0m13:49:51.393311 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m13:49:51.393844 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "ï»¿select"
LINE 12:     ï»¿select * from read_parquet('s3://dp-gold/web2_attributi...
             ^

[0m13:49:51.393844 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: ROLLBACK
[0m13:49:51.393844 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: ROLLBACK
[0m13:49:51.395383 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.stg_chain_mempool"
[0m13:49:51.395383 [debug] [Thread-3 (]: On model.attribution_dbt.stg_gold_attribution: ROLLBACK
[0m13:49:51.395383 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_chain_mempool"} */

  
    

  create  table "attrib_analytics"."public"."stg_chain_mempool__dbt_tmp"
  
  
    as
  
  (
    ï»¿select * from read_parquet('s3://dp-silver/chain_mempool/date=*/*.parquet')
  );
  
[0m13:49:51.395383 [debug] [Thread-4 (]: On model.attribution_dbt.stg_gold_sessions: Close
[0m13:49:51.395383 [debug] [Thread-1 (]: On model.attribution_dbt.stg_chain_blocks: Close
[0m13:49:51.395383 [debug] [Thread-3 (]: On model.attribution_dbt.stg_gold_attribution: Close
[0m13:49:51.395383 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "ï»¿select"
LINE 12:     ï»¿select * from read_parquet('s3://dp-silver/chain_mempoo...
             ^

[0m13:49:51.403217 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: ROLLBACK
[0m13:49:51.404222 [debug] [Thread-2 (]: On model.attribution_dbt.stg_chain_mempool: Close
[0m13:49:51.549699 [debug] [Thread-1 (]: Database Error in model stg_chain_blocks (models\staging\stg_chain_blocks.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select * from read_parquet('s3://dp-silver/chain_blocks...
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_chain_blocks.sql
[0m13:49:51.549699 [debug] [Thread-2 (]: Database Error in model stg_chain_mempool (models\staging\stg_chain_mempool.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select * from read_parquet('s3://dp-silver/chain_mempoo...
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_chain_mempool.sql
[0m13:49:51.549699 [debug] [Thread-4 (]: Database Error in model stg_gold_sessions (models\staging\stg_gold_sessions.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select * from read_parquet('s3://dp-gold/web2_sessions/...
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_gold_sessions.sql
[0m13:49:51.549699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3CDFEF00>]}
[0m13:49:51.549699 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3CEC7E00>]}
[0m13:49:51.555624 [debug] [Thread-3 (]: Database Error in model stg_gold_attribution (models\staging\stg_gold_attribution.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select * from read_parquet('s3://dp-gold/web2_attributi...
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_gold_attribution.sql
[0m13:49:51.555624 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3CF5E5A0>]}
[0m13:49:51.555624 [error] [Thread-1 (]: 1 of 19 ERROR creating sql table model public.stg_chain_blocks ................. [[31mERROR[0m in 0.30s]
[0m13:49:51.555624 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3CE73E60>]}
[0m13:49:51.555624 [error] [Thread-2 (]: 2 of 19 ERROR creating sql table model public.stg_chain_mempool ................ [[31mERROR[0m in 0.30s]
[0m13:49:51.559952 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_chain_blocks
[0m13:49:51.559952 [error] [Thread-4 (]: 4 of 19 ERROR creating sql table model public.stg_gold_sessions ................ [[31mERROR[0m in 0.30s]
[0m13:49:51.559952 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.stg_chain_mempool
[0m13:49:51.559952 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_web2
[0m13:49:51.559952 [error] [Thread-3 (]: 3 of 19 ERROR creating sql table model public.stg_gold_attribution ............. [[31mERROR[0m in 0.30s]
[0m13:49:51.564994 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_gold_sessions
[0m13:49:51.566004 [debug] [Thread-2 (]: Began running node seed.attribution_dbt.orders_seed
[0m13:49:51.567003 [info ] [Thread-1 (]: 5 of 19 START sql table model public.stg_web2 .................................. [RUN]
[0m13:49:51.568011 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.stg_gold_attribution
[0m13:49:51.569108 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m13:49:51.569108 [info ] [Thread-2 (]: 6 of 19 START seed file public_.orders_seed .................................... [RUN]
[0m13:49:51.570112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_chain_blocks, now model.attribution_dbt.stg_web2)
[0m13:49:51.570112 [debug] [Thread-3 (]: Began running node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m13:49:51.571652 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_chain_mempool, now seed.attribution_dbt.orders_seed)
[0m13:49:51.571652 [info ] [Thread-4 (]: 7 of 19 SKIP test not_null_stg_chain_blocks_height ............................. [[33mSKIP[0m]
[0m13:49:51.572773 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_web2
[0m13:49:51.573858 [debug] [Thread-2 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m13:49:51.574320 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962
[0m13:49:51.572773 [info ] [Thread-3 (]: 8 of 19 SKIP test unique_stg_chain_blocks_height ............................... [[33mSKIP[0m]
[0m13:49:51.575938 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_web2"
[0m13:49:51.575938 [debug] [Thread-2 (]: Began executing node seed.attribution_dbt.orders_seed
[0m13:49:51.576922 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m13:49:51.577883 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157
[0m13:49:51.597379 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_web2
[0m13:49:51.603432 [debug] [Thread-2 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m13:49:51.597379 [info ] [Thread-4 (]: 9 of 19 SKIP test not_null_stg_chain_mempool_txid .............................. [[33mSKIP[0m]
[0m13:49:51.603432 [debug] [Thread-3 (]: Began running node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m13:49:51.603432 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_web2"
[0m13:49:51.603432 [debug] [Thread-2 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m13:49:51.611828 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120
[0m13:49:51.612430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:51.612430 [info ] [Thread-3 (]: 10 of 19 SKIP test unique_stg_chain_mempool_txid ............................... [[33mSKIP[0m]
[0m13:49:51.612430 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969
[0m13:49:51.612430 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_web2"
[0m13:49:51.612430 [debug] [Thread-1 (]: On model.attribution_dbt.stg_web2: BEGIN
[0m13:49:51.612430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:51.628456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:49:51.632573 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_web2"
[0m13:49:51.632573 [debug] [Thread-1 (]: On model.attribution_dbt.stg_web2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_web2"} */

  
    

  create  table "attrib_analytics"."public"."stg_web2__dbt_tmp"
  
  
    as
  
  (
    ï»¿select * from read_parquet('s3://dp-silver/web2/date=*/*.parquet')
  );
  
[0m13:49:51.634589 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "ï»¿select"
LINE 12:     ï»¿select * from read_parquet('s3://dp-silver/web2/date=*/...
             ^

[0m13:49:51.634589 [debug] [Thread-1 (]: On model.attribution_dbt.stg_web2: ROLLBACK
[0m13:49:51.635597 [debug] [Thread-1 (]: On model.attribution_dbt.stg_web2: Close
[0m13:49:51.635597 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m13:49:51.635597 [debug] [Thread-2 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m13:49:51.635597 [debug] [Thread-2 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */
truncate table "attrib_analytics"."public_"."orders_seed"
[0m13:49:51.635597 [debug] [Thread-1 (]: Database Error in model stg_web2 (models\staging\stg_web2.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select * from read_parquet('s3://dp-silver/web2/date=*/...
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_web2.sql
[0m13:49:51.635597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3D08CEC0>]}
[0m13:49:51.635597 [error] [Thread-1 (]: 5 of 19 ERROR creating sql table model public.stg_web2 ......................... [[31mERROR[0m in 0.07s]
[0m13:49:51.635597 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_web2
[0m13:49:51.642840 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m13:49:51.644820 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m13:49:51.644820 [debug] [Thread-1 (]: Began running node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m13:49:51.644820 [info ] [Thread-4 (]: 11 of 19 SKIP test not_null_stg_web2_event_id .................................. [[33mSKIP[0m]
[0m13:49:51.644820 [info ] [Thread-3 (]: 12 of 19 SKIP test not_null_stg_web2_ts ........................................ [[33mSKIP[0m]
[0m13:49:51.644820 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc
[0m13:49:51.644820 [info ] [Thread-1 (]: 13 of 19 SKIP test unique_stg_web2_event_id .................................... [[33mSKIP[0m]
[0m13:49:51.644820 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6
[0m13:49:51.650452 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.unique_stg_web2_event_id.250b5fae02
[0m13:49:51.669721 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.029 seconds
[0m13:49:51.687229 [debug] [Thread-2 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m13:49:51.687229 [debug] [Thread-2 (]: On seed.attribution_dbt.orders_seed: 
          insert into "attrib_analytics"."public_"."orders_seed" ("order_id", "order_date", "channel", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:49:51.694526 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.008 seconds
[0m13:49:51.699701 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.attribution_dbt.orders_seed"
[0m13:49:51.719805 [debug] [Thread-2 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m13:49:51.720443 [debug] [Thread-2 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m13:49:51.721076 [debug] [Thread-2 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m13:49:51.734610 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m13:49:51.737114 [debug] [Thread-2 (]: On seed.attribution_dbt.orders_seed: Close
[0m13:49:51.737825 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3CDFCBC0>]}
[0m13:49:51.739017 [info ] [Thread-2 (]: 6 of 19 OK loaded seed file public_.orders_seed ................................ [[32mINSERT 3[0m in 0.17s]
[0m13:49:51.740101 [debug] [Thread-2 (]: Finished running node seed.attribution_dbt.orders_seed
[0m13:49:51.741753 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_orders
[0m13:49:51.743194 [info ] [Thread-4 (]: 14 of 19 START sql table model public.stg_orders ............................... [RUN]
[0m13:49:51.744255 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_gold_sessions, now model.attribution_dbt.stg_orders)
[0m13:49:51.745365 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_orders
[0m13:49:51.749107 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m13:49:51.752837 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_orders
[0m13:49:51.758189 [debug] [Thread-4 (]: Writing runtime sql for node "model.attribution_dbt.stg_orders"
[0m13:49:51.760370 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:49:51.761508 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: BEGIN
[0m13:49:51.762583 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:51.784638 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m13:49:51.785199 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:49:51.785786 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */

  
    

  create  table "attrib_analytics"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    select
	order_id,
    cast(order_date as date) as order_date,
    lower(channel) as channel,
    cast(amount as numeric(12,2)) as amount
from "attrib_analytics"."public_"."orders_seed"
  );
  
[0m13:49:51.819161 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.033 seconds
[0m13:49:51.836814 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:49:51.837892 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:49:51.843704 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:49:51.848655 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:49:51.849727 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:49:51.851872 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:51.857674 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m13:49:51.858536 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:49:51.859560 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m13:49:51.865450 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m13:49:51.875819 [debug] [Thread-4 (]: Applying DROP to: "attrib_analytics"."public"."stg_orders__dbt_backup"
[0m13:49:51.883436 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:49:51.884451 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
drop table if exists "attrib_analytics"."public"."stg_orders__dbt_backup" cascade
[0m13:49:51.909964 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.025 seconds
[0m13:49:51.912107 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: Close
[0m13:49:51.913834 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3CDFF3E0>]}
[0m13:49:51.914373 [info ] [Thread-4 (]: 14 of 19 OK created sql table model public.stg_orders .......................... [[32mSELECT 3[0m in 0.17s]
[0m13:49:51.915452 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_orders
[0m13:49:51.916536 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m13:49:51.917085 [debug] [Thread-2 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m13:49:51.917627 [info ] [Thread-1 (]: 15 of 19 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:49:51.918719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_web2, now test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:49:51.918160 [info ] [Thread-2 (]: 16 of 19 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:49:51.919293 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m13:49:51.919852 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.attribution_dbt.orders_seed, now test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m13:49:51.932818 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:49:51.933379 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m13:49:51.941594 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m13:49:51.942112 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m13:49:51.962844 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:49:51.962844 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m13:49:51.962844 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m13:49:51.962844 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:49:51.968659 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m13:49:51.962844 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:49:51.969256 [debug] [Thread-2 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:49:51.969256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:51.969256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:51.985116 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m13:49:51.985116 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m13:49:51.987634 [debug] [Thread-2 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "attrib_analytics"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:49:51.987634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:49:51.987634 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:49:51.987634 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "attrib_analytics"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:51.991936 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:49:51.991936 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:49:51.993968 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:49:51.993968 [debug] [Thread-2 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:49:51.993968 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:49:51.993968 [debug] [Thread-2 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:49:52.001002 [info ] [Thread-1 (]: 15 of 19 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.08s]
[0m13:49:52.002031 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m13:49:52.001002 [info ] [Thread-2 (]: 16 of 19 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.08s]
[0m13:49:52.004192 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m13:49:52.005199 [debug] [Thread-4 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m13:49:52.006199 [info ] [Thread-4 (]: 17 of 19 START sql table model public.mart_revenue_daily ....................... [RUN]
[0m13:49:52.006199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_orders, now model.attribution_dbt.mart_revenue_daily)
[0m13:49:52.007204 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m13:49:52.009203 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m13:49:52.010204 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m13:49:52.013203 [debug] [Thread-4 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_daily"
[0m13:49:52.015717 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:49:52.016442 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: BEGIN
[0m13:49:52.017537 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:52.035615 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m13:49:52.035615 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:49:52.035615 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
  order_date,
  channel,
  sum(amount) as revenue
from "attrib_analytics"."public"."stg_orders"
group by 1,2
  );
  
[0m13:49:52.056310 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.019 seconds
[0m13:49:52.059750 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:49:52.059750 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily" rename to "mart_revenue_daily__dbt_backup"
[0m13:49:52.059750 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:49:52.066746 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:49:52.066746 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp" rename to "mart_revenue_daily"
[0m13:49:52.068305 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:52.068305 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m13:49:52.070976 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:49:52.070976 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m13:49:52.077239 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m13:49:52.077239 [debug] [Thread-4 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_daily__dbt_backup"
[0m13:49:52.077239 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:49:52.080844 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_daily__dbt_backup" cascade
[0m13:49:52.091783 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m13:49:52.091783 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: Close
[0m13:49:52.091783 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c32852-bec3-48f6-9300-b3e114abc27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3D051A60>]}
[0m13:49:52.091783 [info ] [Thread-4 (]: 17 of 19 OK created sql table model public.mart_revenue_daily .................. [[32mSELECT 3[0m in 0.09s]
[0m13:49:52.096655 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m13:49:52.097322 [debug] [Thread-1 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m13:49:52.097942 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m13:49:52.097942 [info ] [Thread-1 (]: 18 of 19 START test accepted_values_mart_revenue_daily_channel__ads__email__direct  [RUN]
[0m13:49:52.099479 [info ] [Thread-2 (]: 19 of 19 START test not_null_mart_revenue_daily_order_date ..................... [RUN]
[0m13:49:52.100491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f)
[0m13:49:52.101489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a, now test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097)
[0m13:49:52.101489 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m13:49:52.101489 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m13:49:52.110187 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m13:49:52.113985 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m13:49:52.116518 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m13:49:52.120031 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m13:49:52.120031 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m13:49:52.123100 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m13:49:52.125723 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m13:49:52.126717 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: BEGIN
[0m13:49:52.126717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:52.126717 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m13:49:52.126717 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: BEGIN
[0m13:49:52.126717 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:52.143296 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m13:49:52.143296 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m13:49:52.143296 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "attrib_analytics"."public"."mart_revenue_daily"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m13:49:52.145313 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:49:52.147505 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: ROLLBACK
[0m13:49:52.147505 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: Close
[0m13:49:52.150054 [info ] [Thread-2 (]: 19 of 19 PASS not_null_mart_revenue_daily_order_date ........................... [[32mPASS[0m in 0.05s]
[0m13:49:52.151738 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m13:49:52.151738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m13:49:52.151738 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m13:49:52.151738 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        channel as value_field,
        count(*) as n_records

    from "attrib_analytics"."public"."mart_revenue_daily"
    group by channel

)

select *
from all_values
where value_field not in (
    'ads','email','direct'
)



  
  
      
    ) dbt_internal_test
[0m13:49:52.151738 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:49:52.159284 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: ROLLBACK
[0m13:49:52.160295 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: Close
[0m13:49:52.160295 [info ] [Thread-1 (]: 18 of 19 PASS accepted_values_mart_revenue_daily_channel__ads__email__direct ... [[32mPASS[0m in 0.06s]
[0m13:49:52.160295 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m13:49:52.163351 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:52.163351 [debug] [MainThread]: On master: BEGIN
[0m13:49:52.163351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:52.175218 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m13:49:52.179781 [debug] [MainThread]: On master: COMMIT
[0m13:49:52.179781 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:52.180823 [debug] [MainThread]: On master: COMMIT
[0m13:49:52.180823 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:49:52.180823 [debug] [MainThread]: On master: Close
[0m13:49:52.180823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:52.180823 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m13:49:52.180823 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m13:49:52.180823 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m13:49:52.180823 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m13:49:52.180823 [debug] [MainThread]: Connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f' was properly closed.
[0m13:49:52.180823 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097' was properly closed.
[0m13:49:52.180823 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_gold_attribution' was properly closed.
[0m13:49:52.180823 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_daily' was properly closed.
[0m13:49:52.180823 [info ] [MainThread]: 
[0m13:49:52.180823 [info ] [MainThread]: Finished running 7 table models, 11 data tests, 1 seed in 0 hours 0 minutes and 4.77 seconds (4.77s).
[0m13:49:52.180823 [debug] [MainThread]: Command end result
[0m13:49:52.212169 [info ] [MainThread]: 
[0m13:49:52.212169 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m13:49:52.212169 [info ] [MainThread]: 
[0m13:49:52.212169 [error] [MainThread]:   Database Error in model stg_chain_blocks (models\staging\stg_chain_blocks.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select * from read_parquet('s3://dp-silver/chain_blocks...
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_chain_blocks.sql
[0m13:49:52.220325 [info ] [MainThread]: 
[0m13:49:52.220325 [error] [MainThread]:   Database Error in model stg_chain_mempool (models\staging\stg_chain_mempool.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select * from read_parquet('s3://dp-silver/chain_mempoo...
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_chain_mempool.sql
[0m13:49:52.222424 [info ] [MainThread]: 
[0m13:49:52.223110 [error] [MainThread]:   Database Error in model stg_gold_sessions (models\staging\stg_gold_sessions.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select * from read_parquet('s3://dp-gold/web2_sessions/...
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_gold_sessions.sql
[0m13:49:52.224120 [info ] [MainThread]: 
[0m13:49:52.225121 [error] [MainThread]:   Database Error in model stg_gold_attribution (models\staging\stg_gold_attribution.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select * from read_parquet('s3://dp-gold/web2_attributi...
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_gold_attribution.sql
[0m13:49:52.225121 [info ] [MainThread]: 
[0m13:49:52.226120 [error] [MainThread]:   Database Error in model stg_web2 (models\staging\stg_web2.sql)
  syntax error at or near "ï»¿select"
  LINE 12:     ï»¿select * from read_parquet('s3://dp-silver/web2/date=*/...
               ^
  compiled code at target\run\attribution_dbt\models\staging\stg_web2.sql
[0m13:49:52.226120 [info ] [MainThread]: 
[0m13:49:52.227627 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=5 SKIP=7 TOTAL=19
[0m13:49:52.228636 [debug] [MainThread]: Command `dbt build` failed at 13:49:52.228636 after 9.55 seconds
[0m13:49:52.228636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3AF583E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3ACFF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3A704B60>]}
[0m13:49:52.229637 [debug] [MainThread]: Flushing usage events
[0m13:59:36.900174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E6556ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E618723C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E6489A0C0>]}


============================== 13:59:36.910729 | 09237b46-1c1e-44f0-801f-8f4f0eb2e40a ==============================
[0m13:59:36.910729 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:59:36.916149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:59:37.361126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09237b46-1c1e-44f0-801f-8f4f0eb2e40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E62E77D70>]}
[0m13:59:37.444217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09237b46-1c1e-44f0-801f-8f4f0eb2e40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E64BB48F0>]}
[0m13:59:37.449012 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:59:38.070072 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:59:38.368393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m13:59:38.368393 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\staging\stg_web2.sql
[0m13:59:38.368393 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\staging\stg_gold_sessions.sql
[0m13:59:38.368393 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\staging\stg_gold_attribution.sql
[0m13:59:38.368393 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\staging\stg_chain_blocks.sql
[0m13:59:38.368393 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\staging\stg_chain_mempool.sql
[0m13:59:38.787725 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:59:38.787725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '09237b46-1c1e-44f0-801f-8f4f0eb2e40a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E6707A210>]}
[0m13:59:38.943762 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m13:59:38.943762 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m13:59:38.943762 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m13:59:38.943762 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m13:59:38.943762 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m13:59:38.943762 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m13:59:38.943762 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m13:59:39.037413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09237b46-1c1e-44f0-801f-8f4f0eb2e40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E6571B980>]}
[0m13:59:39.230854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09237b46-1c1e-44f0-801f-8f4f0eb2e40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E6720C1D0>]}
[0m13:59:39.230854 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 1 source, 433 macros
[0m13:59:39.240830 [info ] [MainThread]: 
[0m13:59:39.242841 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:39.250944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m13:59:39.269413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m13:59:39.371443 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m13:59:39.371443 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m13:59:39.374668 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:59:39.376285 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:59:39.377398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:39.378411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:39.570682 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.193 seconds
[0m13:59:39.570682 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.195 seconds
[0m13:59:39.570682 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m13:59:39.570682 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m13:59:39.570682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m13:59:39.580454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m13:59:39.591093 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m13:59:39.593116 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m13:59:39.593116 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m13:59:39.593116 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m13:59:39.593116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:39.593116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:39.614637 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m13:59:39.614637 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m13:59:39.617448 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m13:59:39.617763 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m13:59:39.617763 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m13:59:39.617763 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:59:39.636882 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.021 seconds
[0m13:59:39.636882 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.018 seconds
[0m13:59:39.640485 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m13:59:39.642161 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m13:59:39.643203 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m13:59:39.643203 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m13:59:39.652307 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:39.652307 [debug] [MainThread]: On master: BEGIN
[0m13:59:39.652307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:39.685063 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:59:39.689061 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:39.689815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:39.706219 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m13:59:39.706219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09237b46-1c1e-44f0-801f-8f4f0eb2e40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E6708B380>]}
[0m13:59:39.708242 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:39.708242 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:39.708242 [debug] [MainThread]: On master: BEGIN
[0m13:59:39.710949 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:59:39.710949 [debug] [MainThread]: On master: COMMIT
[0m13:59:39.710949 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:39.714210 [debug] [MainThread]: On master: COMMIT
[0m13:59:39.714210 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:59:39.714210 [debug] [MainThread]: On master: Close
[0m13:59:39.716220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:39.716220 [info ] [MainThread]: 
[0m13:59:39.726622 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m13:59:39.726622 [info ] [Thread-1 (]: 1 of 7 START seed file public_.orders_seed ..................................... [RUN]
[0m13:59:39.729842 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m13:59:39.729842 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m13:59:39.729842 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m13:59:39.773616 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m13:59:39.774623 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m13:59:39.774623 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:59:39.821173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m13:59:39.822701 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m13:59:39.822701 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */
truncate table "attrib_analytics"."public_"."orders_seed"
[0m13:59:39.839560 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.017 seconds
[0m13:59:39.855008 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m13:59:39.855008 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: 
          insert into "attrib_analytics"."public_"."orders_seed" ("order_id", "order_date", "channel", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:59:39.864493 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.005 seconds
[0m13:59:39.874293 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.attribution_dbt.orders_seed"
[0m13:59:39.886964 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m13:59:39.886964 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m13:59:39.886964 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m13:59:39.898823 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m13:59:39.903043 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m13:59:39.905461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09237b46-1c1e-44f0-801f-8f4f0eb2e40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E677EB920>]}
[0m13:59:39.905461 [info ] [Thread-1 (]: 1 of 7 OK loaded seed file public_.orders_seed ................................. [[32mINSERT 3[0m in 0.17s]
[0m13:59:39.905461 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m13:59:39.905461 [debug] [Thread-3 (]: Began running node model.attribution_dbt.stg_orders
[0m13:59:39.905461 [info ] [Thread-3 (]: 2 of 7 START sql table model public.stg_orders ................................. [RUN]
[0m13:59:39.912002 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m13:59:39.912002 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.stg_orders
[0m13:59:39.921035 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m13:59:39.921035 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.stg_orders
[0m13:59:39.966941 [debug] [Thread-3 (]: Writing runtime sql for node "model.attribution_dbt.stg_orders"
[0m13:59:39.969481 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:59:39.969481 [debug] [Thread-3 (]: On model.attribution_dbt.stg_orders: BEGIN
[0m13:59:39.969481 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:59:39.990902 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m13:59:39.990902 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:59:39.990902 [debug] [Thread-3 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */

  
    

  create  table "attrib_analytics"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    select
	order_id,
    cast(order_date as date) as order_date,
    lower(channel) as channel,
    cast(amount as numeric(12,2)) as amount
from "attrib_analytics"."public_"."orders_seed"
  );
  
[0m13:59:40.014760 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.025 seconds
[0m13:59:40.037039 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:59:40.037704 [debug] [Thread-3 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:59:40.037704 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:59:40.044552 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:59:40.044552 [debug] [Thread-3 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:59:40.047065 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:40.054151 [debug] [Thread-3 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m13:59:40.054151 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:59:40.054151 [debug] [Thread-3 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m13:59:40.063644 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m13:59:40.068480 [debug] [Thread-3 (]: Applying DROP to: "attrib_analytics"."public"."stg_orders__dbt_backup"
[0m13:59:40.074259 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m13:59:40.074259 [debug] [Thread-3 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
drop table if exists "attrib_analytics"."public"."stg_orders__dbt_backup" cascade
[0m13:59:40.094935 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.017 seconds
[0m13:59:40.094935 [debug] [Thread-3 (]: On model.attribution_dbt.stg_orders: Close
[0m13:59:40.099110 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09237b46-1c1e-44f0-801f-8f4f0eb2e40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E67860830>]}
[0m13:59:40.101034 [info ] [Thread-3 (]: 2 of 7 OK created sql table model public.stg_orders ............................ [[32mSELECT 3[0m in 0.18s]
[0m13:59:40.101596 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.stg_orders
[0m13:59:40.101596 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m13:59:40.105260 [debug] [Thread-1 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m13:59:40.105260 [info ] [Thread-2 (]: 3 of 7 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:59:40.105260 [info ] [Thread-1 (]: 4 of 7 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:59:40.108931 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:59:40.108931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.attribution_dbt.orders_seed, now test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m13:59:40.110995 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m13:59:40.110995 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m13:59:40.130587 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:59:40.136528 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m13:59:40.143114 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m13:59:40.218323 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m13:59:40.252012 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m13:59:40.255052 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:59:40.258555 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m13:59:40.259060 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:59:40.259060 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:59:40.259060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:40.259060 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:59:40.261579 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:59:40.279330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:59:40.281841 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m13:59:40.281841 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "attrib_analytics"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:59:40.289359 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:59:40.289865 [debug] [Thread-2 (]: SQL status: BEGIN in 0.029 seconds
[0m13:59:40.294426 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:59:40.296434 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:59:40.296434 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "attrib_analytics"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:59:40.298443 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:59:40.304805 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:59:40.303296 [info ] [Thread-1 (]: 4 of 7 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.19s]
[0m13:59:40.307278 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:59:40.307278 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m13:59:40.307278 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:59:40.307278 [info ] [Thread-2 (]: 3 of 7 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.20s]
[0m13:59:40.307278 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m13:59:40.313550 [debug] [Thread-3 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m13:59:40.313550 [info ] [Thread-3 (]: 5 of 7 START sql table model public.mart_revenue_daily ......................... [RUN]
[0m13:59:40.313550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_orders, now model.attribution_dbt.mart_revenue_daily)
[0m13:59:40.313550 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m13:59:40.321193 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m13:59:40.321726 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m13:59:40.325270 [debug] [Thread-3 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_daily"
[0m13:59:40.325270 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:59:40.329499 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: BEGIN
[0m13:59:40.330261 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:59:40.359548 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m13:59:40.360456 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:59:40.360987 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
  order_date,
  channel,
  sum(amount) as revenue
from "attrib_analytics"."public"."stg_orders"
group by 1,2
  );
  
[0m13:59:40.366904 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.013 seconds
[0m13:59:40.376866 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:59:40.376866 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily" rename to "mart_revenue_daily__dbt_backup"
[0m13:59:40.376866 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:40.382727 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:59:40.384253 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp" rename to "mart_revenue_daily"
[0m13:59:40.384253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:40.386956 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m13:59:40.386956 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:59:40.386956 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m13:59:40.393131 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m13:59:40.396659 [debug] [Thread-3 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_daily__dbt_backup"
[0m13:59:40.398678 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m13:59:40.398678 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_daily__dbt_backup" cascade
[0m13:59:40.410742 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m13:59:40.412749 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: Close
[0m13:59:40.414756 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09237b46-1c1e-44f0-801f-8f4f0eb2e40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E670C2330>]}
[0m13:59:40.416780 [info ] [Thread-3 (]: 5 of 7 OK created sql table model public.mart_revenue_daily .................... [[32mSELECT 3[0m in 0.10s]
[0m13:59:40.418099 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m13:59:40.420055 [debug] [Thread-1 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m13:59:40.420055 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m13:59:40.420055 [info ] [Thread-1 (]: 6 of 7 START test accepted_values_mart_revenue_daily_channel__ads__email__direct  [RUN]
[0m13:59:40.420055 [info ] [Thread-2 (]: 7 of 7 START test not_null_mart_revenue_daily_order_date ....................... [RUN]
[0m13:59:40.424836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a, now test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f)
[0m13:59:40.425165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097)
[0m13:59:40.425165 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m13:59:40.425165 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m13:59:40.438462 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m13:59:40.441610 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m13:59:40.441610 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m13:59:40.447080 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m13:59:40.447080 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m13:59:40.451421 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m13:59:40.451421 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m13:59:40.451421 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: BEGIN
[0m13:59:40.451421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:40.451421 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m13:59:40.451421 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: BEGIN
[0m13:59:40.457343 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:59:40.462977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:59:40.471471 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m13:59:40.471471 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        channel as value_field,
        count(*) as n_records

    from "attrib_analytics"."public"."mart_revenue_daily"
    group by channel

)

select *
from all_values
where value_field not in (
    'ads','email','direct'
)



  
  
      
    ) dbt_internal_test
[0m13:59:40.474170 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:59:40.476612 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: ROLLBACK
[0m13:59:40.478617 [debug] [Thread-1 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: Close
[0m13:59:40.480347 [info ] [Thread-1 (]: 6 of 7 PASS accepted_values_mart_revenue_daily_channel__ads__email__direct ..... [[32mPASS[0m in 0.06s]
[0m13:59:40.481853 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m13:59:40.484094 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m13:59:40.488897 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m13:59:40.488897 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "attrib_analytics"."public"."mart_revenue_daily"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m13:59:40.489567 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:59:40.492205 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: ROLLBACK
[0m13:59:40.492205 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: Close
[0m13:59:40.494900 [info ] [Thread-2 (]: 7 of 7 PASS not_null_mart_revenue_daily_order_date ............................. [[32mPASS[0m in 0.07s]
[0m13:59:40.494900 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m13:59:40.494900 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:40.494900 [debug] [MainThread]: On master: BEGIN
[0m13:59:40.494900 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:40.534431 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m13:59:40.534431 [debug] [MainThread]: On master: COMMIT
[0m13:59:40.534431 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:40.534431 [debug] [MainThread]: On master: COMMIT
[0m13:59:40.534431 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:59:40.534431 [debug] [MainThread]: On master: Close
[0m13:59:40.534431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:40.534431 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m13:59:40.534431 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m13:59:40.534431 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m13:59:40.534431 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m13:59:40.534431 [debug] [MainThread]: Connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f' was properly closed.
[0m13:59:40.542878 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_daily' was properly closed.
[0m13:59:40.542878 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097' was properly closed.
[0m13:59:40.543909 [info ] [MainThread]: 
[0m13:59:40.543909 [info ] [MainThread]: Finished running 1 seed, 2 table models, 4 data tests in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m13:59:40.547137 [debug] [MainThread]: Command end result
[0m13:59:40.585041 [info ] [MainThread]: 
[0m13:59:40.585041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:40.585041 [info ] [MainThread]: 
[0m13:59:40.585041 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:59:40.585041 [debug] [MainThread]: Command `dbt build` succeeded at 13:59:40.585041 after 4.00 seconds
[0m13:59:40.585041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E654590A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E65458830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E6545AFC0>]}
[0m13:59:40.585041 [debug] [MainThread]: Flushing usage events
[0m14:00:16.245693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3C82CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3ED12060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3F303F80>]}


============================== 14:00:16.256160 | d0fb2dfd-a7ed-471d-8db4-677e2352efc6 ==============================
[0m14:00:16.256160 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:00:16.259121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:00:16.464051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0fb2dfd-a7ed-471d-8db4-677e2352efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3F5BF1A0>]}
[0m14:00:16.516137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0fb2dfd-a7ed-471d-8db4-677e2352efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3F4CD220>]}
[0m14:00:16.516137 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:00:16.787622 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:00:17.098971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:17.098971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:17.166332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0fb2dfd-a7ed-471d-8db4-677e2352efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA40B21B80>]}
[0m14:00:17.336711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0fb2dfd-a7ed-471d-8db4-677e2352efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA40E72E70>]}
[0m14:00:17.336711 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 1 source, 433 macros
[0m14:00:17.336711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0fb2dfd-a7ed-471d-8db4-677e2352efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA40B22AE0>]}
[0m14:00:17.336711 [info ] [MainThread]: 
[0m14:00:17.336711 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:17.347272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m14:00:17.367086 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m14:00:17.467424 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:00:17.467424 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:00:17.467424 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m14:00:17.467424 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m14:00:17.467424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:17.470724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:17.506932 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m14:00:17.506932 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m14:00:17.506932 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:00:17.506932 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:00:17.506932 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:00:17.512246 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m14:00:17.514777 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m14:00:17.514777 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m14:00:17.519263 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m14:00:17.519263 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m14:00:17.523050 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m14:00:17.523050 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m14:00:17.532889 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:17.532889 [debug] [MainThread]: On master: BEGIN
[0m14:00:17.532889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:17.555002 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m14:00:17.555002 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:17.555002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:00:17.574084 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m14:00:17.574084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0fb2dfd-a7ed-471d-8db4-677e2352efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3F5FAC00>]}
[0m14:00:17.574084 [debug] [MainThread]: On master: ROLLBACK
[0m14:00:17.574084 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:17.574084 [debug] [MainThread]: On master: BEGIN
[0m14:00:17.574084 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:00:17.574084 [debug] [MainThread]: On master: COMMIT
[0m14:00:17.574084 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:17.574084 [debug] [MainThread]: On master: COMMIT
[0m14:00:17.582901 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:00:17.582901 [debug] [MainThread]: On master: Close
[0m14:00:17.584321 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:17.585740 [info ] [MainThread]: 
[0m14:00:17.588768 [debug] [Thread-1 (]: Began running node source.attribution_dbt.attrib.orders
[0m14:00:17.588768 [info ] [Thread-1 (]: 1 of 1 START freshness of attrib.orders ........................................ [RUN]
[0m14:00:17.594465 [debug] [Thread-1 (]: Acquiring new postgres connection 'source.attribution_dbt.attrib.orders'
[0m14:00:17.594465 [debug] [Thread-1 (]: Began compiling node source.attribution_dbt.attrib.orders
[0m14:00:17.594465 [debug] [Thread-1 (]: Began executing node source.attribution_dbt.attrib.orders
[0m14:00:17.596487 [debug] [Thread-1 (]: Using postgres connection "source.attribution_dbt.attrib.orders"
[0m14:00:17.596487 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders: BEGIN
[0m14:00:17.596487 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:00:17.619230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m14:00:17.619230 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders: COMMIT
[0m14:00:17.619230 [debug] [Thread-1 (]: Using postgres connection "source.attribution_dbt.attrib.orders"
[0m14:00:17.619230 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders: COMMIT
[0m14:00:17.623628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:00:17.631937 [debug] [Thread-1 (]: Using postgres connection "source.attribution_dbt.attrib.orders"
[0m14:00:17.631937 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "source.attribution_dbt.attrib.orders"} */
select
      max(order_date) as max_loaded_at,
      now() as snapshotted_at
    from "attrib_analytics"."public"."orders"
    
  
[0m14:00:17.651108 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m14:00:17.651108 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders: Close
[0m14:00:17.727335 [debug] [Thread-1 (]: Database Error in source orders (models\schema.yml)
  Expected a timestamp value when querying field 'last_modified' of table None but received value of type 'date' instead
[0m14:00:17.728775 [error] [Thread-1 (]: 1 of 1 ERROR freshness of attrib.orders ........................................ [[31mERROR[0m in 0.13s]
[0m14:00:17.730833 [debug] [Thread-1 (]: Finished running node source.attribution_dbt.attrib.orders
[0m14:00:17.735807 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:17.737206 [debug] [MainThread]: On master: BEGIN
[0m14:00:17.737206 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:17.754432 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m14:00:17.754950 [debug] [MainThread]: On master: COMMIT
[0m14:00:17.755465 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:17.755465 [debug] [MainThread]: On master: COMMIT
[0m14:00:17.756497 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:00:17.757043 [debug] [MainThread]: On master: Close
[0m14:00:17.758138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:17.758778 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m14:00:17.759352 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m14:00:17.759722 [debug] [MainThread]: Connection 'source.attribution_dbt.attrib.orders' was properly closed.
[0m14:00:17.760229 [info ] [MainThread]: 
[0m14:00:17.761361 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m14:00:17.800014 [info ] [MainThread]: 
[0m14:00:17.801999 [error] [MainThread]:   Database Error in source orders (models\schema.yml)
  Expected a timestamp value when querying field 'last_modified' of table None but received value of type 'date' instead
[0m14:00:17.801999 [info ] [MainThread]: Done.
[0m14:00:17.804650 [debug] [MainThread]: Command `dbt source freshness` failed at 14:00:17.804650 after 1.81 seconds
[0m14:00:17.804650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3C82CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3F59AE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3F18E1B0>]}
[0m14:00:17.804650 [debug] [MainThread]: Flushing usage events
[0m14:10:49.468768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8F709190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9206E1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF922501A0>]}


============================== 14:10:49.483542 | 2c51ebb7-2e5d-4073-a157-efafee1a3fcd ==============================
[0m14:10:49.483542 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:10:49.484558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt source freshness', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:49.942434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c51ebb7-2e5d-4073-a157-efafee1a3fcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF91BBCCB0>]}
[0m14:10:50.019798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c51ebb7-2e5d-4073-a157-efafee1a3fcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF923C5D90>]}
[0m14:10:50.021679 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:10:50.543260 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:10:50.840025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:10:50.840025 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\schema.yml
[0m14:10:51.130191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c51ebb7-2e5d-4073-a157-efafee1a3fcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF93D693D0>]}
[0m14:10:51.276909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c51ebb7-2e5d-4073-a157-efafee1a3fcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF939D6630>]}
[0m14:10:51.286614 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 1 source, 433 macros
[0m14:10:51.288200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c51ebb7-2e5d-4073-a157-efafee1a3fcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF93D680B0>]}
[0m14:10:51.291740 [info ] [MainThread]: 
[0m14:10:51.292763 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:10:51.299648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m14:10:51.308828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m14:10:51.389606 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:10:51.391123 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:10:51.391123 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m14:10:51.392787 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m14:10:51.392787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:51.392787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:51.548915 [debug] [ThreadPool]: SQL status: BEGIN in 0.156 seconds
[0m14:10:51.548915 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:10:51.550411 [debug] [ThreadPool]: SQL status: BEGIN in 0.158 seconds
[0m14:10:51.550411 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:10:51.550411 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:10:51.550411 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m14:10:51.569191 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.024 seconds
[0m14:10:51.569191 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.023 seconds
[0m14:10:51.569191 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m14:10:51.579650 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m14:10:51.580678 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m14:10:51.580678 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m14:10:51.590083 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:51.590083 [debug] [MainThread]: On master: BEGIN
[0m14:10:51.592110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:51.631791 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m14:10:51.631791 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:51.631791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:10:51.645494 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m14:10:51.646727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c51ebb7-2e5d-4073-a157-efafee1a3fcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF93951E50>]}
[0m14:10:51.646727 [debug] [MainThread]: On master: ROLLBACK
[0m14:10:51.652636 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:51.652636 [debug] [MainThread]: On master: BEGIN
[0m14:10:51.652636 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:10:51.652636 [debug] [MainThread]: On master: COMMIT
[0m14:10:51.652636 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:51.652636 [debug] [MainThread]: On master: COMMIT
[0m14:10:51.657579 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:10:51.657579 [debug] [MainThread]: On master: Close
[0m14:10:51.659608 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:10:51.660631 [info ] [MainThread]: 
[0m14:10:51.676650 [debug] [Thread-1 (]: Began running node source.attribution_dbt.attrib.orders_seed
[0m14:10:51.676650 [info ] [Thread-1 (]: 1 of 1 START freshness of attrib.orders_seed ................................... [RUN]
[0m14:10:51.678862 [debug] [Thread-1 (]: Acquiring new postgres connection 'source.attribution_dbt.attrib.orders_seed'
[0m14:10:51.678862 [debug] [Thread-1 (]: Began compiling node source.attribution_dbt.attrib.orders_seed
[0m14:10:51.678862 [debug] [Thread-1 (]: Began executing node source.attribution_dbt.attrib.orders_seed
[0m14:10:51.681178 [debug] [Thread-1 (]: Using postgres connection "source.attribution_dbt.attrib.orders_seed"
[0m14:10:51.681178 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders_seed: BEGIN
[0m14:10:51.681178 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:10:51.708631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m14:10:51.708631 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders_seed: COMMIT
[0m14:10:51.708631 [debug] [Thread-1 (]: Using postgres connection "source.attribution_dbt.attrib.orders_seed"
[0m14:10:51.708631 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders_seed: COMMIT
[0m14:10:51.708631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:10:51.718096 [debug] [Thread-1 (]: Using postgres connection "source.attribution_dbt.attrib.orders_seed"
[0m14:10:51.718096 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "source.attribution_dbt.attrib.orders_seed"} */
select
      max(order_ts) as max_loaded_at,
      now() as snapshotted_at
    from "attrib_analytics"."public_"."orders_seed"
    
  
[0m14:10:51.733793 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m14:10:51.736875 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders_seed: Close
[0m14:10:51.740666 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of attrib.orders_seed ............................. [[31mERROR STALE[0m in 0.06s]
[0m14:10:51.740666 [debug] [Thread-1 (]: Finished running node source.attribution_dbt.attrib.orders_seed
[0m14:10:51.749655 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:51.750420 [debug] [MainThread]: On master: BEGIN
[0m14:10:51.750420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:51.772576 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m14:10:51.772576 [debug] [MainThread]: On master: COMMIT
[0m14:10:51.778523 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:51.778523 [debug] [MainThread]: On master: COMMIT
[0m14:10:51.778523 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:10:51.778523 [debug] [MainThread]: On master: Close
[0m14:10:51.781624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:51.781624 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m14:10:51.781624 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m14:10:51.781624 [debug] [MainThread]: Connection 'source.attribution_dbt.attrib.orders_seed' was properly closed.
[0m14:10:51.781624 [info ] [MainThread]: 
[0m14:10:51.781624 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m14:10:51.824501 [info ] [MainThread]: 
[0m14:10:51.824501 [info ] [MainThread]: Done.
[0m14:10:51.824501 [debug] [MainThread]: Command `dbt source freshness` failed at 14:10:51.824501 after 2.60 seconds
[0m14:10:51.824501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9249FA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF92374A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF92374950>]}
[0m14:10:51.824501 [debug] [MainThread]: Flushing usage events
[0m14:12:36.519184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF3899340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF6477650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF64C4080>]}


============================== 14:12:36.529918 | 82d80c2b-0728-4b0e-ab99-58e846bd9ece ==============================
[0m14:12:36.529918 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:12:36.529918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:12:36.805492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82d80c2b-0728-4b0e-ab99-58e846bd9ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF7A81460>]}
[0m14:12:36.877763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82d80c2b-0728-4b0e-ab99-58e846bd9ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF3E6CC50>]}
[0m14:12:36.877763 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:12:37.169440 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:12:39.382257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:39.386181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:39.477163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82d80c2b-0728-4b0e-ab99-58e846bd9ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF7B97950>]}
[0m14:12:39.728856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82d80c2b-0728-4b0e-ab99-58e846bd9ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF7AD2150>]}
[0m14:12:39.728856 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 1 source, 433 macros
[0m14:12:39.730874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82d80c2b-0728-4b0e-ab99-58e846bd9ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF7AAD5B0>]}
[0m14:12:39.734725 [info ] [MainThread]: 
[0m14:12:39.738010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:12:39.745976 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m14:12:39.753652 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m14:12:39.877744 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:12:39.877744 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:12:39.877744 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m14:12:39.877744 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m14:12:39.877744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:39.883685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:39.965882 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m14:12:39.965882 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m14:12:39.965882 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:12:39.967997 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:12:39.967997 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m14:12:39.970470 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:12:39.982952 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m14:12:39.982952 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m14:12:39.987443 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m14:12:39.989668 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m14:12:39.989668 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m14:12:39.992838 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m14:12:40.002757 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:40.003330 [debug] [MainThread]: On master: BEGIN
[0m14:12:40.003330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:40.029593 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m14:12:40.034830 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:40.035452 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:12:40.042378 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m14:12:40.045171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82d80c2b-0728-4b0e-ab99-58e846bd9ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF7DBBE30>]}
[0m14:12:40.045708 [debug] [MainThread]: On master: ROLLBACK
[0m14:12:40.046227 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:40.046227 [debug] [MainThread]: On master: BEGIN
[0m14:12:40.046227 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:12:40.050915 [debug] [MainThread]: On master: COMMIT
[0m14:12:40.050915 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:40.050915 [debug] [MainThread]: On master: COMMIT
[0m14:12:40.050915 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:12:40.050915 [debug] [MainThread]: On master: Close
[0m14:12:40.050915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:12:40.054778 [info ] [MainThread]: 
[0m14:12:40.064381 [debug] [Thread-1 (]: Began running node source.attribution_dbt.attrib.orders_seed
[0m14:12:40.065888 [info ] [Thread-1 (]: 1 of 1 START freshness of attrib.orders_seed ................................... [RUN]
[0m14:12:40.068417 [debug] [Thread-1 (]: Acquiring new postgres connection 'source.attribution_dbt.attrib.orders_seed'
[0m14:12:40.068969 [debug] [Thread-1 (]: Began compiling node source.attribution_dbt.attrib.orders_seed
[0m14:12:40.068969 [debug] [Thread-1 (]: Began executing node source.attribution_dbt.attrib.orders_seed
[0m14:12:40.068969 [debug] [Thread-1 (]: Using postgres connection "source.attribution_dbt.attrib.orders_seed"
[0m14:12:40.068969 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders_seed: BEGIN
[0m14:12:40.068969 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:12:40.098436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m14:12:40.098436 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders_seed: COMMIT
[0m14:12:40.098436 [debug] [Thread-1 (]: Using postgres connection "source.attribution_dbt.attrib.orders_seed"
[0m14:12:40.100507 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders_seed: COMMIT
[0m14:12:40.101133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:12:40.113399 [debug] [Thread-1 (]: Using postgres connection "source.attribution_dbt.attrib.orders_seed"
[0m14:12:40.116534 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "source.attribution_dbt.attrib.orders_seed"} */
select
      max(order_ts) as max_loaded_at,
      now() as snapshotted_at
    from "attrib_analytics"."public_"."orders_seed"
    
  
[0m14:12:40.119783 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:12:40.119783 [debug] [Thread-1 (]: On source.attribution_dbt.attrib.orders_seed: Close
[0m14:12:40.124516 [info ] [Thread-1 (]: 1 of 1 PASS freshness of attrib.orders_seed .................................... [[32mPASS[0m in 0.06s]
[0m14:12:40.127512 [debug] [Thread-1 (]: Finished running node source.attribution_dbt.attrib.orders_seed
[0m14:12:40.130472 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:40.130472 [debug] [MainThread]: On master: BEGIN
[0m14:12:40.130472 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:40.154664 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m14:12:40.157016 [debug] [MainThread]: On master: COMMIT
[0m14:12:40.157016 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:40.157854 [debug] [MainThread]: On master: COMMIT
[0m14:12:40.159508 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:12:40.159508 [debug] [MainThread]: On master: Close
[0m14:12:40.159508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:40.159508 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m14:12:40.163629 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m14:12:40.164636 [debug] [MainThread]: Connection 'source.attribution_dbt.attrib.orders_seed' was properly closed.
[0m14:12:40.164636 [info ] [MainThread]: 
[0m14:12:40.164636 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m14:12:40.205469 [info ] [MainThread]: Done.
[0m14:12:40.211117 [debug] [MainThread]: Command `dbt source freshness` succeeded at 14:12:40.211117 after 3.97 seconds
[0m14:12:40.213124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF3FA8A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF61009E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF6100260>]}
[0m14:12:40.213124 [debug] [MainThread]: Flushing usage events
[0m14:19:38.770922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865C05CE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865C05CF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865C05C3E0>]}


============================== 14:19:38.777026 | d523f823-ebea-43b9-98d5-44355eb49d4c ==============================
[0m14:19:38.777026 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:19:38.782250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m14:19:39.129381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd523f823-ebea-43b9-98d5-44355eb49d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865D1EA510>]}
[0m14:19:39.197359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd523f823-ebea-43b9-98d5-44355eb49d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865AAF42F0>]}
[0m14:19:39.199905 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:19:39.534403 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:19:39.751842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:19:39.752857 [debug] [MainThread]: Partial parsing: added file: attribution_dbt://models\snapshots\orders_snapshot.sql
[0m14:19:39.986261 [error] [MainThread]: Encountered an error:
Compilation Error in model orders_snapshot (models\snapshots\orders_snapshot.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot orders_snapshot %}
[0m14:19:39.990857 [debug] [MainThread]: Command `dbt snapshot` failed at 14:19:39.990857 after 1.53 seconds
[0m14:19:39.991972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865C05C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865E76C470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865E965730>]}
[0m14:19:39.992979 [debug] [MainThread]: Flushing usage events
[0m14:25:07.434197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F206DF2D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F206DF1FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F207DD83E0>]}


============================== 14:25:07.446324 | 36925f60-f33f-4039-ab48-b88f13c9f990 ==============================
[0m14:25:07.446324 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:25:07.447832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:25:07.725944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36925f60-f33f-4039-ab48-b88f13c9f990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F207AABCE0>]}
[0m14:25:07.810320 [debug] [MainThread]: Command `dbt clean` succeeded at 14:25:07.810320 after 0.65 seconds
[0m14:25:07.812996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F207B48AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F206DF2D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20929E330>]}
[0m14:25:07.812996 [debug] [MainThread]: Flushing usage events
[0m14:25:23.818247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563602CF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025637F046B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256381B5820>]}


============================== 14:25:23.822549 | f802da29-0335-4c58-86fe-85ca8226b6f0 ==============================
[0m14:25:23.822549 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:25:23.827495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m14:25:24.104481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f802da29-0335-4c58-86fe-85ca8226b6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025638D98170>]}
[0m14:25:24.177796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f802da29-0335-4c58-86fe-85ca8226b6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256366A10D0>]}
[0m14:25:24.181825 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:25:24.519441 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:25:24.521448 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:25:24.521448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f802da29-0335-4c58-86fe-85ca8226b6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563A332CF0>]}
[0m14:25:27.269545 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:25:27.269545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f802da29-0335-4c58-86fe-85ca8226b6f0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563A68E450>]}
[0m14:25:27.597222 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m14:25:27.597222 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m14:25:27.597222 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m14:25:27.597222 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m14:25:27.601159 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m14:25:27.601159 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m14:25:27.601159 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m14:25:27.927076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f802da29-0335-4c58-86fe-85ca8226b6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563A68F530>]}
[0m14:25:29.323355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f802da29-0335-4c58-86fe-85ca8226b6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563A579130>]}
[0m14:25:29.327934 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m14:25:29.330386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f802da29-0335-4c58-86fe-85ca8226b6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025638D99190>]}
[0m14:25:29.337006 [info ] [MainThread]: 
[0m14:25:29.338236 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:29.341699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m14:25:31.045503 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m14:25:31.045503 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:25:31.045503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:31.175956 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.129 seconds
[0m14:25:31.175956 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m14:25:31.183063 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m14:25:31.186318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m14:25:31.194786 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:25:31.197378 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:25:31.197378 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m14:25:31.197378 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m14:25:31.197378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:31.197378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:31.228016 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m14:25:31.228637 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m14:25:31.229711 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:25:31.229711 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:25:31.229711 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m14:25:31.229711 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:25:31.257551 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.027 seconds
[0m14:25:31.259566 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.028 seconds
[0m14:25:31.260820 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m14:25:31.262862 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m14:25:31.265277 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m14:25:31.265277 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m14:25:31.273176 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:31.273176 [debug] [MainThread]: On master: BEGIN
[0m14:25:31.273176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:31.306049 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m14:25:31.309080 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:31.309590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:25:31.324441 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m14:25:31.324441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f802da29-0335-4c58-86fe-85ca8226b6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563A68D280>]}
[0m14:25:31.324441 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:31.324441 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:31.324441 [debug] [MainThread]: On master: BEGIN
[0m14:25:31.332567 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:25:31.332567 [debug] [MainThread]: On master: COMMIT
[0m14:25:31.332567 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:31.332567 [debug] [MainThread]: On master: COMMIT
[0m14:25:31.334586 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:25:31.334586 [debug] [MainThread]: On master: Close
[0m14:25:31.334586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:31.337226 [info ] [MainThread]: 
[0m14:25:31.343035 [debug] [Thread-1 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m14:25:31.348337 [info ] [Thread-1 (]: 1 of 1 START snapshot public_.orders_snapshot .................................. [RUN]
[0m14:25:31.348337 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m14:25:31.348337 [debug] [Thread-1 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m14:25:31.363299 [debug] [Thread-1 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m14:25:31.446801 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:25:31.446801 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_ts as varchar ), '')
        ) as dbt_scd_id,
        order_ts as dbt_updated_at,
        order_ts as dbt_valid_from,
        
  
  coalesce(nullif(order_ts, order_ts), null)
  as dbt_valid_to
from (
        

select * from "attrib_analytics"."public_"."orders_seed"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m14:25:31.452521 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:31.500827 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.049 seconds
[0m14:25:31.506527 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:25:31.509090 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:25:31.511989 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m14:25:31.511989 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.attribution_dbt.orders_snapshot"
[0m14:25:31.516423 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:25:31.516423 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: BEGIN
[0m14:25:31.518978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m14:25:31.518978 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:25:31.518978 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      
  
    

  create  table "attrib_analytics"."public_"."orders_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_ts as varchar ), '')
        ) as dbt_scd_id,
        order_ts as dbt_updated_at,
        order_ts as dbt_valid_from,
        
  
  coalesce(nullif(order_ts, order_ts), null)
  as dbt_valid_to
from (
        

select * from "attrib_analytics"."public_"."orders_seed"
    ) sbq



  );
  
  
[0m14:25:31.562650 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.042 seconds
[0m14:25:31.583701 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m14:25:31.583701 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:25:31.583701 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m14:25:31.586219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:25:31.593810 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: Close
[0m14:25:31.593810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f802da29-0335-4c58-86fe-85ca8226b6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563AED4980>]}
[0m14:25:31.596669 [info ] [Thread-1 (]: 1 of 1 OK snapshotted public_.orders_snapshot .................................. [[32mSELECT 3[0m in 0.25s]
[0m14:25:31.596669 [debug] [Thread-1 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m14:25:31.600832 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:31.602108 [debug] [MainThread]: On master: BEGIN
[0m14:25:31.602108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:31.626220 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m14:25:31.626220 [debug] [MainThread]: On master: COMMIT
[0m14:25:31.628732 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:31.628732 [debug] [MainThread]: On master: COMMIT
[0m14:25:31.628732 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:25:31.628732 [debug] [MainThread]: On master: Close
[0m14:25:31.628732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:31.628732 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m14:25:31.633207 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m14:25:31.633783 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m14:25:31.633783 [debug] [MainThread]: Connection 'snapshot.attribution_dbt.orders_snapshot' was properly closed.
[0m14:25:31.633783 [info ] [MainThread]: 
[0m14:25:31.633783 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m14:25:31.638764 [debug] [MainThread]: Command end result
[0m14:25:31.679647 [info ] [MainThread]: 
[0m14:25:31.680692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:31.680692 [info ] [MainThread]: 
[0m14:25:31.680692 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:25:31.680692 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:25:31.680692 after 8.06 seconds
[0m14:25:31.685318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025638203BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025637DB2B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025637DB2D50>]}
[0m14:25:31.685318 [debug] [MainThread]: Flushing usage events
[0m14:35:20.456299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6FDCC9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6801F1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6801F25D0>]}


============================== 14:35:20.472419 | b74e923f-b0ef-4a5f-b2a8-034be29b3dbd ==============================
[0m14:35:20.472419 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:35:20.473944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:35:21.193189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b74e923f-b0ef-4a5f-b2a8-034be29b3dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E681FBE5A0>]}
[0m14:35:21.392704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b74e923f-b0ef-4a5f-b2a8-034be29b3dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E680AC4530>]}
[0m14:35:21.400465 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:35:22.451631 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:35:23.240289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:23.240289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:23.463388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b74e923f-b0ef-4a5f-b2a8-034be29b3dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68091EF00>]}
[0m14:35:23.969392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b74e923f-b0ef-4a5f-b2a8-034be29b3dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68244F770>]}
[0m14:35:23.971059 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m14:35:23.974002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b74e923f-b0ef-4a5f-b2a8-034be29b3dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6822355E0>]}
[0m14:35:23.981854 [info ] [MainThread]: 
[0m14:35:23.984545 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:35:23.989433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m14:35:24.286693 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m14:35:24.288460 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:35:24.290575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:24.404828 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.115 seconds
[0m14:35:24.408451 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m14:35:24.418675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m14:35:24.433197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m14:35:24.436227 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:35:24.440972 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:35:24.440972 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m14:35:24.440972 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m14:35:24.446559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:24.446559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:24.482394 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m14:35:24.486640 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:35:24.489184 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m14:35:24.509392 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.023 seconds
[0m14:35:24.515454 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m14:35:24.515454 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m14:35:24.520892 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m14:35:24.521855 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:35:24.521855 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:35:24.557815 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.033 seconds
[0m14:35:24.561370 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m14:35:24.566355 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m14:35:24.584122 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:24.584122 [debug] [MainThread]: On master: BEGIN
[0m14:35:24.584122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:24.607423 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m14:35:24.616188 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:24.617211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:35:24.635722 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m14:35:24.639809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b74e923f-b0ef-4a5f-b2a8-034be29b3dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6829D55B0>]}
[0m14:35:24.641031 [debug] [MainThread]: On master: ROLLBACK
[0m14:35:24.643222 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:24.644245 [debug] [MainThread]: On master: BEGIN
[0m14:35:24.646569 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:35:24.648182 [debug] [MainThread]: On master: COMMIT
[0m14:35:24.648813 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:24.649336 [debug] [MainThread]: On master: COMMIT
[0m14:35:24.650269 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:35:24.651729 [debug] [MainThread]: On master: Close
[0m14:35:24.651729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:35:24.653731 [info ] [MainThread]: 
[0m14:35:24.664295 [debug] [Thread-1 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m14:35:24.664295 [info ] [Thread-1 (]: 1 of 1 START snapshot public_.orders_snapshot .................................. [RUN]
[0m14:35:24.664295 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m14:35:24.669262 [debug] [Thread-1 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m14:35:24.680462 [debug] [Thread-1 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m14:35:24.793115 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:24.793115 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: BEGIN
[0m14:35:24.793115 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:35:24.817640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m14:35:24.818731 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:24.818731 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m14:35:24.845266 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.026 seconds
[0m14:35:24.941855 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:24.941855 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

        
  
    

  create temporary table "orders_snapshot__dbt_tmp143524921608"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select * from "attrib_analytics"."public_"."orders_seed"

    ),

    snapshotted_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from "attrib_analytics"."public_"."orders_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            order_ts as dbt_updated_at,
            order_ts as dbt_valid_from,
            
  
  coalesce(nullif(order_ts, order_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            order_ts as dbt_updated_at,
            order_ts as dbt_valid_from,
            order_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.order_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.order_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m14:35:24.984917 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.042 seconds
[0m14:35:24.991009 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:24.991009 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp143524921608'
        
      order by ordinal_position

  
[0m14:35:25.000264 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m14:35:25.006343 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:25.006343 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m14:35:25.011549 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.005 seconds
[0m14:35:25.018898 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:25.018898 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp143524921608'
        
      order by ordinal_position

  
[0m14:35:25.026351 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.005 seconds
[0m14:35:25.030360 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:25.032368 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m14:35:25.036204 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m14:35:25.048109 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:25.048109 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp143524921608'
        
      order by ordinal_position

  
[0m14:35:25.052453 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m14:35:25.077699 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:25.078717 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        

select * from "attrib_analytics"."public_"."orders_seed"

    ),

    snapshotted_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from "attrib_analytics"."public_"."orders_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            order_ts as dbt_updated_at,
            order_ts as dbt_valid_from,
            
  
  coalesce(nullif(order_ts, order_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            order_ts as dbt_updated_at,
            order_ts as dbt_valid_from,
            order_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.order_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.order_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m14:35:25.080970 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m14:35:25.084930 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:25.087437 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:35:25.087437 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m14:35:25.087437 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:25.090860 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:25.090860 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      update "attrib_analytics"."public_"."orders_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "orders_snapshot__dbt_tmp143524921608" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "attrib_analytics"."public_"."orders_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "attrib_analytics"."public_"."orders_snapshot".dbt_valid_to is null;

    insert into "attrib_analytics"."public_"."orders_snapshot" ("order_id", "order_date", "channel", "amount", "order_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."order_date",DBT_INTERNAL_SOURCE."channel",DBT_INTERNAL_SOURCE."amount",DBT_INTERNAL_SOURCE."order_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "orders_snapshot__dbt_tmp143524921608" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:35:25.096114 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m14:35:25.112411 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m14:35:25.112411 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:35:25.112411 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m14:35:25.118476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:35:25.118476 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: Close
[0m14:35:25.127469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b74e923f-b0ef-4a5f-b2a8-034be29b3dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E682AF64B0>]}
[0m14:35:25.129006 [info ] [Thread-1 (]: 1 of 1 OK snapshotted public_.orders_snapshot .................................. [[32mINSERT 0 0[0m in 0.45s]
[0m14:35:25.129006 [debug] [Thread-1 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m14:35:25.133483 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:25.133483 [debug] [MainThread]: On master: BEGIN
[0m14:35:25.135494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:25.152879 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m14:35:25.152879 [debug] [MainThread]: On master: COMMIT
[0m14:35:25.158536 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:25.159254 [debug] [MainThread]: On master: COMMIT
[0m14:35:25.160354 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:35:25.160354 [debug] [MainThread]: On master: Close
[0m14:35:25.163192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:25.164289 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m14:35:25.164289 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m14:35:25.164289 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m14:35:25.164289 [debug] [MainThread]: Connection 'snapshot.attribution_dbt.orders_snapshot' was properly closed.
[0m14:35:25.170486 [info ] [MainThread]: 
[0m14:35:25.170486 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m14:35:25.175737 [debug] [MainThread]: Command end result
[0m14:35:25.212778 [info ] [MainThread]: 
[0m14:35:25.212778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:25.212778 [info ] [MainThread]: 
[0m14:35:25.212778 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:35:25.212778 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:35:25.212778 after 5.39 seconds
[0m14:35:25.223457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E680877980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E680900440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6809012B0>]}
[0m14:35:25.224495 [debug] [MainThread]: Flushing usage events
[0m14:42:20.679039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001710492C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017106EBC8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017106EBCA10>]}


============================== 14:42:20.689667 | ff524ffd-08d3-45da-84cb-53529526f8ef ==============================
[0m14:42:20.689667 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:42:20.689667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select orders_snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:21.151855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff524ffd-08d3-45da-84cb-53529526f8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017109154500>]}
[0m14:42:21.241934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff524ffd-08d3-45da-84cb-53529526f8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017107848A40>]}
[0m14:42:21.244698 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:42:21.794599 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:42:22.118274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:42:22.118832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:42:22.271993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff524ffd-08d3-45da-84cb-53529526f8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017107BE83E0>]}
[0m14:42:22.757317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff524ffd-08d3-45da-84cb-53529526f8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171095E1610>]}
[0m14:42:22.759314 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m14:42:22.763189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff524ffd-08d3-45da-84cb-53529526f8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171092514F0>]}
[0m14:42:22.769461 [info ] [MainThread]: 
[0m14:42:22.771598 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:42:22.775410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m14:42:23.182661 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m14:42:23.185501 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:42:23.186488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:23.369422 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.183 seconds
[0m14:42:23.373645 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m14:42:23.388611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m14:42:23.390773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m14:42:23.403337 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:42:23.408870 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:42:23.410876 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m14:42:23.411882 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m14:42:23.413399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:23.414110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:23.446356 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m14:42:23.446356 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:42:23.446356 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:42:23.457631 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m14:42:23.458748 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:42:23.459297 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m14:42:23.481412 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.030 seconds
[0m14:42:23.482540 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.022 seconds
[0m14:42:23.489165 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m14:42:23.493942 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m14:42:23.496168 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m14:42:23.497591 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m14:42:23.508424 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:23.509971 [debug] [MainThread]: On master: BEGIN
[0m14:42:23.511770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:23.551433 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m14:42:23.551433 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:23.553576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:42:23.572740 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m14:42:23.578938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff524ffd-08d3-45da-84cb-53529526f8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017109155C10>]}
[0m14:42:23.580100 [debug] [MainThread]: On master: ROLLBACK
[0m14:42:23.582217 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:23.583307 [debug] [MainThread]: On master: BEGIN
[0m14:42:23.585981 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:42:23.587681 [debug] [MainThread]: On master: COMMIT
[0m14:42:23.588880 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:23.589978 [debug] [MainThread]: On master: COMMIT
[0m14:42:23.591653 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:42:23.593897 [debug] [MainThread]: On master: Close
[0m14:42:23.595887 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:23.596398 [info ] [MainThread]: 
[0m14:42:23.611026 [debug] [Thread-1 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m14:42:23.613148 [info ] [Thread-1 (]: 1 of 1 START snapshot public_.orders_snapshot .................................. [RUN]
[0m14:42:23.614855 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m14:42:23.614855 [debug] [Thread-1 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m14:42:23.652543 [debug] [Thread-1 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m14:42:23.894447 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:23.896131 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: BEGIN
[0m14:42:23.897215 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:23.940697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m14:42:23.941726 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:23.944556 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m14:42:23.989544 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.043 seconds
[0m14:42:24.180394 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:24.182799 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

        
  
    

  create temporary table "orders_snapshot__dbt_tmp144224151216"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select * from "attrib_analytics"."public_"."orders_seed"

    ),

    snapshotted_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from "attrib_analytics"."public_"."orders_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            order_ts as dbt_updated_at,
            order_ts as dbt_valid_from,
            
  
  coalesce(nullif(order_ts, order_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            order_ts as dbt_updated_at,
            order_ts as dbt_valid_from,
            order_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.order_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.order_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m14:42:24.228305 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.044 seconds
[0m14:42:24.236936 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:24.238076 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp144224151216'
        
      order by ordinal_position

  
[0m14:42:24.246183 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m14:42:24.259528 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:24.261212 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m14:42:24.268786 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m14:42:24.280113 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:24.281410 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp144224151216'
        
      order by ordinal_position

  
[0m14:42:24.289578 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.007 seconds
[0m14:42:24.295051 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:24.297136 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m14:42:24.303518 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m14:42:24.319867 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:24.321595 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp144224151216'
        
      order by ordinal_position

  
[0m14:42:24.330917 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.010 seconds
[0m14:42:24.388734 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:24.390313 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        

select * from "attrib_analytics"."public_"."orders_seed"

    ),

    snapshotted_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from "attrib_analytics"."public_"."orders_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            order_ts as dbt_updated_at,
            order_ts as dbt_valid_from,
            
  
  coalesce(nullif(order_ts, order_ts), null)
  as dbt_valid_to
,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            order_ts as dbt_updated_at,
            order_ts as dbt_valid_from,
            order_ts as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.order_ts)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.order_ts)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m14:42:24.397729 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m14:42:24.418994 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:24.420039 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:42:24.447004 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.029 seconds
[0m14:42:24.451779 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:24.459054 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:24.461250 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      update "attrib_analytics"."public_"."orders_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "orders_snapshot__dbt_tmp144224151216" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "attrib_analytics"."public_"."orders_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "attrib_analytics"."public_"."orders_snapshot".dbt_valid_to is null;

    insert into "attrib_analytics"."public_"."orders_snapshot" ("order_id", "order_date", "channel", "amount", "order_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."order_date",DBT_INTERNAL_SOURCE."channel",DBT_INTERNAL_SOURCE."amount",DBT_INTERNAL_SOURCE."order_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "orders_snapshot__dbt_tmp144224151216" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:42:24.468364 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.005 seconds
[0m14:42:24.521494 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m14:42:24.522592 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:42:24.523211 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m14:42:24.529318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:42:24.541112 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: Close
[0m14:42:24.544488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff524ffd-08d3-45da-84cb-53529526f8ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171053A7020>]}
[0m14:42:24.546003 [info ] [Thread-1 (]: 1 of 1 OK snapshotted public_.orders_snapshot .................................. [[32mINSERT 0 0[0m in 0.93s]
[0m14:42:24.548575 [debug] [Thread-1 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m14:42:24.551927 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:24.552555 [debug] [MainThread]: On master: BEGIN
[0m14:42:24.553565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:24.587862 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m14:42:24.589498 [debug] [MainThread]: On master: COMMIT
[0m14:42:24.590543 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:24.591607 [debug] [MainThread]: On master: COMMIT
[0m14:42:24.594261 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:42:24.595313 [debug] [MainThread]: On master: Close
[0m14:42:24.597136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:24.597660 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m14:42:24.598910 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m14:42:24.599509 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m14:42:24.600585 [debug] [MainThread]: Connection 'snapshot.attribution_dbt.orders_snapshot' was properly closed.
[0m14:42:24.601659 [info ] [MainThread]: 
[0m14:42:24.602779 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m14:42:24.606083 [debug] [MainThread]: Command end result
[0m14:42:24.693121 [info ] [MainThread]: 
[0m14:42:24.695238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:42:24.696847 [info ] [MainThread]: 
[0m14:42:24.698027 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:42:24.700011 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:42:24.700011 after 4.38 seconds
[0m14:42:24.701657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017107C0F740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017107C0FFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001710787BB60>]}
[0m14:42:24.701657 [debug] [MainThread]: Flushing usage events
[0m14:47:20.770643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E443EB3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E42100A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E44540860>]}


============================== 14:47:20.780153 | bb711c99-c827-4c2f-af7e-524562d27b19 ==============================
[0m14:47:20.780153 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:47:20.783007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select orders_snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:21.171113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb711c99-c827-4c2f-af7e-524562d27b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E44EC8890>]}
[0m14:47:21.256348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb711c99-c827-4c2f-af7e-524562d27b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4630D130>]}
[0m14:47:21.256348 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:47:21.737787 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:47:21.997834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:47:21.997834 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://snapshots\orders_snapshot.sql
[0m14:47:22.178481 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot orders_snapshot (snapshots\orders_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m14:47:22.178481 [debug] [MainThread]: Command `dbt snapshot` failed at 14:47:22.178481 after 1.68 seconds
[0m14:47:22.183645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E443EB3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E46655C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E46722750>]}
[0m14:47:22.183645 [debug] [MainThread]: Flushing usage events
[0m14:58:11.521653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57B0488F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57A6CD070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57D24BE60>]}


============================== 14:58:11.527166 | c12d9a51-37d1-4386-b5e9-e2876c3c9c22 ==============================
[0m14:58:11.527166 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:58:11.527166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --select orders_snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:58:11.837693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c12d9a51-37d1-4386-b5e9-e2876c3c9c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57D498E60>]}
[0m14:58:11.890040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c12d9a51-37d1-4386-b5e9-e2876c3c9c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57E8E5C40>]}
[0m14:58:11.892561 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:58:12.315663 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:58:12.599826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:58:12.601890 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://snapshots\orders_snapshot.sql
[0m14:58:12.847015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c12d9a51-37d1-4386-b5e9-e2876c3c9c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57EE77E30>]}
[0m14:58:12.993370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c12d9a51-37d1-4386-b5e9-e2876c3c9c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57EB77770>]}
[0m14:58:12.993370 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 snapshot, 1 source, 433 macros
[0m14:58:12.996408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12d9a51-37d1-4386-b5e9-e2876c3c9c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57AD833B0>]}
[0m14:58:12.998701 [info ] [MainThread]: 
[0m14:58:13.000207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:13.000207 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m14:58:13.089514 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m14:58:13.089514 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:58:13.089514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:13.208673 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.120 seconds
[0m14:58:13.208673 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m14:58:13.217609 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m14:58:13.217609 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m14:58:13.220781 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:58:13.220781 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:58:13.220781 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m14:58:13.220781 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m14:58:13.220781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:13.220781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:13.253745 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m14:58:13.254754 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m14:58:13.255751 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:58:13.262267 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m14:58:13.263267 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m14:58:13.263267 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m14:58:13.271167 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.021 seconds
[0m14:58:13.271167 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m14:58:13.271167 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m14:58:13.271167 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m14:58:13.281508 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m14:58:13.281508 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m14:58:13.284789 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:13.284789 [debug] [MainThread]: On master: BEGIN
[0m14:58:13.284789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:13.310770 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m14:58:13.310770 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:13.312783 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:58:13.323073 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m14:58:13.323073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12d9a51-37d1-4386-b5e9-e2876c3c9c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57EE41520>]}
[0m14:58:13.327919 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:13.327919 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:13.329425 [debug] [MainThread]: On master: BEGIN
[0m14:58:13.329425 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:58:13.329425 [debug] [MainThread]: On master: COMMIT
[0m14:58:13.329425 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:13.329425 [debug] [MainThread]: On master: COMMIT
[0m14:58:13.333738 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:58:13.333738 [debug] [MainThread]: On master: Close
[0m14:58:13.333738 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:58:13.333738 [info ] [MainThread]: 
[0m14:58:13.343581 [debug] [Thread-1 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m14:58:13.343581 [info ] [Thread-1 (]: 1 of 1 START snapshot public_.orders_snapshot .................................. [RUN]
[0m14:58:13.345595 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m14:58:13.345595 [debug] [Thread-1 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m14:58:13.353756 [debug] [Thread-1 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m14:58:13.405693 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.405693 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select amount, channel from (
                

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public_"."orders_seed"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:58:13.405693 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:58:13.448036 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.042 seconds
[0m14:58:13.462481 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.463481 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: BEGIN
[0m14:58:13.465397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m14:58:13.465397 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.466451 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m14:58:13.499498 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.034 seconds
[0m14:58:13.509847 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.509847 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m14:58:13.509847 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m14:58:13.569481 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.569481 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

        
  
    

  create temporary table "orders_snapshot__dbt_tmp145813556326"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public_"."orders_seed"

    ),

    snapshotted_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from "attrib_analytics"."public_"."orders_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m14:58:13.598754 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.028 seconds
[0m14:58:13.601293 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.602309 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp145813556326'
        
      order by ordinal_position

  
[0m14:58:13.605642 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m14:58:13.607649 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.609154 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m14:58:13.613347 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m14:58:13.615869 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.615869 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp145813556326'
        
      order by ordinal_position

  
[0m14:58:13.620401 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m14:58:13.623588 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.623588 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m14:58:13.629246 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m14:58:13.636513 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.637032 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp145813556326'
        
      order by ordinal_position

  
[0m14:58:13.640543 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m14:58:13.652312 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.652312 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public_"."orders_seed"

    ),

    snapshotted_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from "attrib_analytics"."public_"."orders_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m14:58:13.656184 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m14:58:13.659111 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.659111 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m14:58:13.659111 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m14:58:13.659111 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.665249 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.665249 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      update "attrib_analytics"."public_"."orders_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "orders_snapshot__dbt_tmp145813556326" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "attrib_analytics"."public_"."orders_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "attrib_analytics"."public_"."orders_snapshot".dbt_valid_to is null;

    insert into "attrib_analytics"."public_"."orders_snapshot" ("order_id", "channel", "amount", "order_date", "order_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."channel",DBT_INTERNAL_SOURCE."amount",DBT_INTERNAL_SOURCE."order_date",DBT_INTERNAL_SOURCE."order_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "orders_snapshot__dbt_tmp145813556326" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m14:58:13.674937 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.010 seconds
[0m14:58:13.688326 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m14:58:13.690166 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m14:58:13.690166 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m14:58:13.697452 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m14:58:13.700308 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: Close
[0m14:58:13.702316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12d9a51-37d1-4386-b5e9-e2876c3c9c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57CB7D310>]}
[0m14:58:13.703408 [info ] [Thread-1 (]: 1 of 1 OK snapshotted public_.orders_snapshot .................................. [[32mINSERT 0 1[0m in 0.36s]
[0m14:58:13.704331 [debug] [Thread-1 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m14:58:13.704331 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:13.704331 [debug] [MainThread]: On master: BEGIN
[0m14:58:13.704331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:13.729451 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m14:58:13.729451 [debug] [MainThread]: On master: COMMIT
[0m14:58:13.729451 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:13.732548 [debug] [MainThread]: On master: COMMIT
[0m14:58:13.732548 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:58:13.732548 [debug] [MainThread]: On master: Close
[0m14:58:13.732548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:13.732548 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m14:58:13.732548 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m14:58:13.736125 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m14:58:13.736125 [debug] [MainThread]: Connection 'snapshot.attribution_dbt.orders_snapshot' was properly closed.
[0m14:58:13.736727 [info ] [MainThread]: 
[0m14:58:13.736727 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m14:58:13.739889 [debug] [MainThread]: Command end result
[0m14:58:13.764484 [info ] [MainThread]: 
[0m14:58:13.768020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:58:13.768020 [info ] [MainThread]: 
[0m14:58:13.769705 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:58:13.771234 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:58:13.771234 after 2.49 seconds
[0m14:58:13.771234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57A6CD070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57B0488F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57E9EFA70>]}
[0m14:58:13.771234 [debug] [MainThread]: Flushing usage events
[0m15:10:52.712020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185FE6C1A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185FE6C1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185FE6C0290>]}


============================== 15:10:52.712020 | b0728534-9b57-4444-ba49-95f8e5e21f96 ==============================
[0m15:10:52.712020 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:10:52.722254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:10:53.043163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0728534-9b57-4444-ba49-95f8e5e21f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185FE989910>]}
[0m15:10:53.093220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0728534-9b57-4444-ba49-95f8e5e21f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185FE9AC740>]}
[0m15:10:53.097105 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:10:53.493119 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:10:53.733344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:10:53.733344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:10:53.783507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0728534-9b57-4444-ba49-95f8e5e21f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185FFE17AA0>]}
[0m15:10:53.947052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0728534-9b57-4444-ba49-95f8e5e21f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185801A7F80>]}
[0m15:10:53.947052 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 snapshot, 1 source, 433 macros
[0m15:10:53.947052 [info ] [MainThread]: 
[0m15:10:53.947052 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:53.957642 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m15:10:53.968053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m15:10:54.041149 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m15:10:54.049326 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m15:10:54.049946 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:10:54.049946 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:10:54.049946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:54.051473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:54.154483 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.104 seconds
[0m15:10:54.154483 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.105 seconds
[0m15:10:54.154483 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m15:10:54.159592 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m15:10:54.159592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m15:10:54.165132 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m15:10:54.165132 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m15:10:54.165132 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m15:10:54.165132 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m15:10:54.165132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:54.172290 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m15:10:54.172290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:54.197357 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m15:10:54.197357 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m15:10:54.197357 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m15:10:54.197357 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m15:10:54.197357 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:10:54.206273 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m15:10:54.227507 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.021 seconds
[0m15:10:54.227507 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.021 seconds
[0m15:10:54.229017 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m15:10:54.229017 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m15:10:54.232011 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m15:10:54.232011 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m15:10:54.238087 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:54.238087 [debug] [MainThread]: On master: BEGIN
[0m15:10:54.238087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:54.261139 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m15:10:54.261139 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:54.261139 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:10:54.284549 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m15:10:54.284549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0728534-9b57-4444-ba49-95f8e5e21f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018580529C70>]}
[0m15:10:54.284549 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:54.289684 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:54.289684 [debug] [MainThread]: On master: BEGIN
[0m15:10:54.293219 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:10:54.293739 [debug] [MainThread]: On master: COMMIT
[0m15:10:54.293739 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:54.293739 [debug] [MainThread]: On master: COMMIT
[0m15:10:54.293739 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:10:54.293739 [debug] [MainThread]: On master: Close
[0m15:10:54.293739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:54.293739 [info ] [MainThread]: 
[0m15:10:54.300750 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m15:10:54.300750 [debug] [Thread-2 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m15:10:54.300750 [info ] [Thread-1 (]: 1 of 8 START seed file public_.orders_seed ..................................... [RUN]
[0m15:10:54.300750 [info ] [Thread-2 (]: 2 of 8 START snapshot public_.orders_snapshot .................................. [RUN]
[0m15:10:54.300750 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m15:10:54.300750 [debug] [Thread-2 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m15:10:54.300750 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m15:10:54.300750 [debug] [Thread-2 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m15:10:54.300750 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m15:10:54.318170 [debug] [Thread-2 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m15:10:54.383042 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.383042 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select amount, channel from (
                

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public_"."orders_seed"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m15:10:54.383042 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:10:54.394375 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m15:10:54.394375 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m15:10:54.394375 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:10:54.421091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m15:10:54.421091 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m15:10:54.422099 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */
truncate table "attrib_analytics"."public_"."orders_seed"
[0m15:10:54.424097 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.037 seconds
[0m15:10:54.437129 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.437129 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: BEGIN
[0m15:10:54.439133 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m15:10:54.440134 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.440134 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m15:10:54.473990 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.033 seconds
[0m15:10:54.482745 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.482745 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m15:10:54.487441 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.004 seconds
[0m15:10:54.533919 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.533919 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

        
  
    

  create temporary table "orders_snapshot__dbt_tmp151054518745"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public_"."orders_seed"

    ),

    snapshotted_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from "attrib_analytics"."public_"."orders_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:10:54.569343 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.035 seconds
[0m15:10:54.571857 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.572856 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp151054518745'
        
      order by ordinal_position

  
[0m15:10:54.576370 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.003 seconds
[0m15:10:54.579454 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.579454 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m15:10:54.582364 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.004 seconds
[0m15:10:54.588489 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.588489 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp151054518745'
        
      order by ordinal_position

  
[0m15:10:54.592117 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.003 seconds
[0m15:10:54.595334 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.595931 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m15:10:54.597461 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.003 seconds
[0m15:10:54.602350 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.602350 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp151054518745'
        
      order by ordinal_position

  
[0m15:10:54.602350 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.003 seconds
[0m15:10:54.613549 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.613549 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public_"."orders_seed"

    ),

    snapshotted_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from "attrib_analytics"."public_"."orders_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m15:10:54.623611 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.002 seconds
[0m15:10:54.627647 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.627647 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m15:10:54.629163 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.001 seconds
[0m15:10:54.629163 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.629163 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.629163 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      update "attrib_analytics"."public_"."orders_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "orders_snapshot__dbt_tmp151054518745" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "attrib_analytics"."public_"."orders_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "attrib_analytics"."public_"."orders_snapshot".dbt_valid_to is null;

    insert into "attrib_analytics"."public_"."orders_snapshot" ("order_id", "channel", "amount", "order_date", "order_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."channel",DBT_INTERNAL_SOURCE."amount",DBT_INTERNAL_SOURCE."order_date",DBT_INTERNAL_SOURCE."order_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "orders_snapshot__dbt_tmp151054518745" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:10:54.634484 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m15:10:54.645378 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m15:10:54.645378 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m15:10:54.645378 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m15:10:54.659066 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m15:10:54.663545 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: Close
[0m15:10:54.665503 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0728534-9b57-4444-ba49-95f8e5e21f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185FBFC7080>]}
[0m15:10:54.666098 [info ] [Thread-2 (]: 2 of 8 OK snapshotted public_.orders_snapshot .................................. [[32mINSERT 0 0[0m in 0.36s]
[0m15:10:54.667104 [debug] [Thread-2 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m15:10:54.671583 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.249 seconds
[0m15:10:54.688418 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m15:10:54.689458 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: 
          insert into "attrib_analytics"."public_"."orders_seed" ("order_id", "order_date", "channel", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m15:10:54.694428 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.005 seconds
[0m15:10:54.696440 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.attribution_dbt.orders_seed"
[0m15:10:54.696440 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m15:10:54.696440 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m15:10:54.696440 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m15:10:54.709374 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:10:54.717140 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m15:10:54.717140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0728534-9b57-4444-ba49-95f8e5e21f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185FFF96330>]}
[0m15:10:54.717140 [info ] [Thread-1 (]: 1 of 8 OK loaded seed file public_.orders_seed ................................. [[32mINSERT 3[0m in 0.42s]
[0m15:10:54.717140 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m15:10:54.721903 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_orders
[0m15:10:54.721903 [info ] [Thread-4 (]: 3 of 8 START sql table model public.stg_orders ................................. [RUN]
[0m15:10:54.721903 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m15:10:54.721903 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_orders
[0m15:10:54.725440 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m15:10:54.727542 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_orders
[0m15:10:54.753725 [debug] [Thread-4 (]: Writing runtime sql for node "model.attribution_dbt.stg_orders"
[0m15:10:54.757272 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m15:10:54.757272 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: BEGIN
[0m15:10:54.758406 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:10:54.773205 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m15:10:54.779015 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m15:10:54.779015 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */

  
    

  create  table "attrib_analytics"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    select
	order_id,
    cast(order_date as date) as order_date,
    lower(channel) as channel,
    cast(amount as numeric(12,2)) as amount
from "attrib_analytics"."public_"."orders_seed"
  );
  
[0m15:10:54.801562 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.023 seconds
[0m15:10:54.810074 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m15:10:54.810074 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:10:54.814662 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:10:54.818190 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m15:10:54.818190 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:10:54.821268 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:10:54.821268 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m15:10:54.821268 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m15:10:54.821268 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m15:10:54.833682 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m15:10:54.837355 [debug] [Thread-4 (]: Applying DROP to: "attrib_analytics"."public"."stg_orders__dbt_backup"
[0m15:10:54.841555 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m15:10:54.841555 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
drop table if exists "attrib_analytics"."public"."stg_orders__dbt_backup" cascade
[0m15:10:54.856532 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:10:54.856532 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: Close
[0m15:10:54.862235 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0728534-9b57-4444-ba49-95f8e5e21f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185809E91F0>]}
[0m15:10:54.862235 [info ] [Thread-4 (]: 3 of 8 OK created sql table model public.stg_orders ............................ [[32mSELECT 3[0m in 0.14s]
[0m15:10:54.862235 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_orders
[0m15:10:54.862235 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m15:10:54.862235 [debug] [Thread-1 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m15:10:54.862235 [info ] [Thread-2 (]: 4 of 8 START test not_null_stg_orders_order_id ................................. [RUN]
[0m15:10:54.862235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.attribution_dbt.orders_snapshot, now test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:10:54.869241 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m15:10:54.862235 [info ] [Thread-1 (]: 5 of 8 START test unique_stg_orders_order_id ................................... [RUN]
[0m15:10:54.878046 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:10:54.878046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.attribution_dbt.orders_seed, now test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m15:10:54.878046 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m15:10:54.885544 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m15:10:54.885544 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m15:10:54.907414 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:10:54.907414 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m15:10:54.908419 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m15:10:54.908419 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:10:54.908419 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:10:54.908419 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:54.908419 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m15:10:54.914535 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:10:54.914535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:54.924978 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m15:10:54.924978 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:10:54.924978 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "attrib_analytics"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:10:54.935061 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m15:10:54.940433 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:10:54.940433 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:10:54.940433 [info ] [Thread-2 (]: 4 of 8 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.08s]
[0m15:10:54.945558 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m15:10:54.949085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m15:10:54.949085 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m15:10:54.949085 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "attrib_analytics"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:10:54.955671 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:10:54.958002 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:10:54.958002 [debug] [Thread-1 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:10:54.958002 [info ] [Thread-1 (]: 5 of 8 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.08s]
[0m15:10:54.958002 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m15:10:54.962131 [debug] [Thread-4 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m15:10:54.962131 [info ] [Thread-4 (]: 6 of 8 START sql table model public.mart_revenue_daily ......................... [RUN]
[0m15:10:54.962131 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_orders, now model.attribution_dbt.mart_revenue_daily)
[0m15:10:54.962131 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m15:10:54.966005 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m15:10:54.966005 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m15:10:54.971420 [debug] [Thread-4 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_daily"
[0m15:10:54.973431 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m15:10:54.973431 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: BEGIN
[0m15:10:54.973431 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:10:54.997215 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m15:10:54.997215 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m15:10:54.997215 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
  order_date,
  channel,
  sum(amount) as revenue
from "attrib_analytics"."public"."stg_orders"
group by 1,2
  );
  
[0m15:10:55.020820 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.020 seconds
[0m15:10:55.024837 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m15:10:55.024837 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily" rename to "mart_revenue_daily__dbt_backup"
[0m15:10:55.026842 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:10:55.029449 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m15:10:55.029449 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp" rename to "mart_revenue_daily"
[0m15:10:55.029449 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:10:55.033980 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m15:10:55.033980 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m15:10:55.033980 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m15:10:55.038189 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m15:10:55.038189 [debug] [Thread-4 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_daily__dbt_backup"
[0m15:10:55.045255 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m15:10:55.045255 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_daily__dbt_backup" cascade
[0m15:10:55.050310 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m15:10:55.050310 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: Close
[0m15:10:55.050310 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0728534-9b57-4444-ba49-95f8e5e21f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185809E8260>]}
[0m15:10:55.050310 [info ] [Thread-4 (]: 6 of 8 OK created sql table model public.mart_revenue_daily .................... [[32mSELECT 3[0m in 0.09s]
[0m15:10:55.058758 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m15:10:55.058758 [debug] [Thread-2 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m15:10:55.058758 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m15:10:55.061284 [info ] [Thread-2 (]: 7 of 8 START test accepted_values_mart_revenue_daily_channel__ads__email__direct  [RUN]
[0m15:10:55.061284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f)
[0m15:10:55.061284 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m15:10:55.069039 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m15:10:55.061284 [info ] [Thread-1 (]: 8 of 8 START test not_null_mart_revenue_daily_order_date ....................... [RUN]
[0m15:10:55.069039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a, now test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097)
[0m15:10:55.069039 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m15:10:55.079256 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m15:10:55.079256 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m15:10:55.081941 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m15:10:55.081941 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m15:10:55.081941 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m15:10:55.081941 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m15:10:55.081941 [debug] [Thread-2 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: BEGIN
[0m15:10:55.081941 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:55.081941 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m15:10:55.081941 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: BEGIN
[0m15:10:55.089872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:55.126715 [debug] [Thread-2 (]: SQL status: BEGIN in 0.039 seconds
[0m15:10:55.126715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m15:10:55.126715 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m15:10:55.126715 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m15:10:55.126715 [debug] [Thread-2 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        channel as value_field,
        count(*) as n_records

    from "attrib_analytics"."public"."mart_revenue_daily"
    group by channel

)

select *
from all_values
where value_field not in (
    'ads','email','direct'
)



  
  
      
    ) dbt_internal_test
[0m15:10:55.126715 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "attrib_analytics"."public"."mart_revenue_daily"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m15:10:55.131295 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:10:55.131295 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:10:55.131295 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: ROLLBACK
[0m15:10:55.131295 [debug] [Thread-2 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: ROLLBACK
[0m15:10:55.131295 [debug] [Thread-2 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: Close
[0m15:10:55.131295 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: Close
[0m15:10:55.131295 [info ] [Thread-2 (]: 7 of 8 PASS accepted_values_mart_revenue_daily_channel__ads__email__direct ..... [[32mPASS[0m in 0.07s]
[0m15:10:55.131295 [info ] [Thread-1 (]: 8 of 8 PASS not_null_mart_revenue_daily_order_date ............................. [[32mPASS[0m in 0.06s]
[0m15:10:55.141893 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m15:10:55.141893 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m15:10:55.141893 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:55.141893 [debug] [MainThread]: On master: BEGIN
[0m15:10:55.141893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:55.162656 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m15:10:55.162656 [debug] [MainThread]: On master: COMMIT
[0m15:10:55.162656 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:55.162656 [debug] [MainThread]: On master: COMMIT
[0m15:10:55.172876 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:10:55.173432 [debug] [MainThread]: On master: Close
[0m15:10:55.173945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:55.173945 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m15:10:55.173945 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m15:10:55.173945 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m15:10:55.173945 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m15:10:55.173945 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097' was properly closed.
[0m15:10:55.173945 [debug] [MainThread]: Connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f' was properly closed.
[0m15:10:55.173945 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_daily' was properly closed.
[0m15:10:55.173945 [info ] [MainThread]: 
[0m15:10:55.173945 [info ] [MainThread]: Finished running 1 snapshot, 1 seed, 2 table models, 4 data tests in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m15:10:55.173945 [debug] [MainThread]: Command end result
[0m15:10:55.205528 [info ] [MainThread]: 
[0m15:10:55.205528 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:10:55.205528 [info ] [MainThread]: 
[0m15:10:55.205528 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:10:55.205528 [debug] [MainThread]: Command `dbt build` succeeded at 15:10:55.205528 after 2.70 seconds
[0m15:10:55.205528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185FDB72420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185FDF827B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185FC1A9310>]}
[0m15:10:55.205528 [debug] [MainThread]: Flushing usage events
[0m18:00:48.002163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDB24E570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDAD30A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDAD32C60>]}


============================== 18:00:48.005471 | 89349937-652f-4eb3-a3e8-016b7512ef64 ==============================
[0m18:00:48.005471 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:00:48.012032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:00:49.042499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89349937-652f-4eb3-a3e8-016b7512ef64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDB7B3350>]}
[0m18:00:49.138241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89349937-652f-4eb3-a3e8-016b7512ef64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDB3299D0>]}
[0m18:00:49.140789 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:00:50.154548 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:00:54.333796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:54.334303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:54.578320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89349937-652f-4eb3-a3e8-016b7512ef64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDCC0BA70>]}
[0m18:00:55.170549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89349937-652f-4eb3-a3e8-016b7512ef64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDCE1F230>]}
[0m18:00:55.172215 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 snapshot, 1 source, 433 macros
[0m18:00:55.174282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89349937-652f-4eb3-a3e8-016b7512ef64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDCF5E270>]}
[0m18:00:55.179524 [info ] [MainThread]: 
[0m18:00:55.180909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:00:55.184824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m18:01:07.327441 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m18:01:07.330247 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:01:07.333687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:07.584086 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.252 seconds
[0m18:01:07.589746 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m18:01:07.606596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m18:01:07.608796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m18:01:07.630961 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m18:01:07.635831 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m18:01:07.637770 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m18:01:07.639446 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m18:01:07.640796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:07.641885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:07.671185 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m18:01:07.671185 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m18:01:07.674907 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m18:01:07.677659 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m18:01:07.680539 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m18:01:07.681056 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:01:07.712252 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.039 seconds
[0m18:01:07.719214 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m18:01:07.720403 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.038 seconds
[0m18:01:07.720403 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m18:01:07.726453 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m18:01:07.729038 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m18:01:07.748525 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:07.749599 [debug] [MainThread]: On master: BEGIN
[0m18:01:07.751130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:07.784513 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m18:01:07.789544 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:07.792111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:01:07.835144 [debug] [MainThread]: SQL status: SELECT 0 in 0.041 seconds
[0m18:01:07.838464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89349937-652f-4eb3-a3e8-016b7512ef64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDD4CD8B0>]}
[0m18:01:07.840111 [debug] [MainThread]: On master: ROLLBACK
[0m18:01:07.841690 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:07.843531 [debug] [MainThread]: On master: BEGIN
[0m18:01:07.847201 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:01:07.847756 [debug] [MainThread]: On master: COMMIT
[0m18:01:07.847756 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:07.847756 [debug] [MainThread]: On master: COMMIT
[0m18:01:07.853290 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:01:07.853290 [debug] [MainThread]: On master: Close
[0m18:01:07.857049 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:01:07.857049 [info ] [MainThread]: 
[0m18:01:07.870739 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m18:01:07.872142 [info ] [Thread-1 (]: 1 of 1 START seed file public_.orders_seed ..................................... [RUN]
[0m18:01:07.872142 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m18:01:07.875764 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m18:01:07.876829 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m18:01:07.958786 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public_"."orders_seed"
[0m18:01:07.972688 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:01:07.972688 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */
drop table if exists "attrib_analytics"."public_"."orders_seed" cascade
[0m18:01:07.972688 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:08.138584 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.165 seconds
[0m18:01:08.173212 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:01:08.173212 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m18:01:08.178205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m18:01:08.178205 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:01:08.180670 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */

    create table "attrib_analytics"."public_"."orders_seed" ("order_id" integer,"order_date" date,"channel" text,"amount" numeric(12,2))
  
[0m18:01:08.230877 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.051 seconds
[0m18:01:08.308530 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:01:08.308530 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: 
          insert into "attrib_analytics"."public_"."orders_seed" ("order_id", "order_date", "channel", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m18:01:08.314238 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.004 seconds
[0m18:01:08.335206 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.attribution_dbt.orders_seed"
[0m18:01:08.420601 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m18:01:08.422073 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:01:08.422073 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m18:01:08.432489 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m18:01:08.438208 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m18:01:08.444591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89349937-652f-4eb3-a3e8-016b7512ef64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD8E16F30>]}
[0m18:01:08.444591 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_.orders_seed ................................. [[32mCREATE 3[0m in 0.57s]
[0m18:01:08.450144 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m18:01:08.454253 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:08.456858 [debug] [MainThread]: On master: BEGIN
[0m18:01:08.456858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:08.486721 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m18:01:08.488564 [debug] [MainThread]: On master: COMMIT
[0m18:01:08.489079 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:08.489079 [debug] [MainThread]: On master: COMMIT
[0m18:01:08.491922 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:01:08.491922 [debug] [MainThread]: On master: Close
[0m18:01:08.491922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:08.491922 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m18:01:08.496210 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m18:01:08.496210 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m18:01:08.498229 [debug] [MainThread]: Connection 'seed.attribution_dbt.orders_seed' was properly closed.
[0m18:01:08.498229 [info ] [MainThread]: 
[0m18:01:08.502136 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 13.32 seconds (13.32s).
[0m18:01:08.503693 [debug] [MainThread]: Command end result
[0m18:01:08.596510 [info ] [MainThread]: 
[0m18:01:08.601498 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:08.603514 [info ] [MainThread]: 
[0m18:01:08.606116 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:01:08.608532 [debug] [MainThread]: Command `dbt seed` succeeded at 18:01:08.608532 after 21.00 seconds
[0m18:01:08.610612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDB67F980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDB6B9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDB21FB60>]}
[0m18:01:08.610612 [debug] [MainThread]: Flushing usage events
[0m18:20:19.912330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E3C91AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E695C680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E695E180>]}


============================== 18:20:19.929270 | ba5dc9bf-d468-4895-af18-3f0b0e2e0fe9 ==============================
[0m18:20:19.929270 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:20:19.933972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:20:20.784578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba5dc9bf-d468-4895-af18-3f0b0e2e0fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E6D35BB0>]}
[0m18:20:21.007154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba5dc9bf-d468-4895-af18-3f0b0e2e0fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E5E84380>]}
[0m18:20:21.010071 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:20:22.069596 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:20:22.798888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:20:22.798888 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:20:23.044078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba5dc9bf-d468-4895-af18-3f0b0e2e0fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E84C11F0>]}
[0m18:20:23.603664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba5dc9bf-d468-4895-af18-3f0b0e2e0fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E86CEAE0>]}
[0m18:20:23.605974 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 snapshot, 1 source, 433 macros
[0m18:20:23.616628 [info ] [MainThread]: 
[0m18:20:23.616628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:20:23.629288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m18:20:23.637474 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m18:20:23.947937 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m18:20:23.947937 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m18:20:23.947937 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:20:23.952343 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:20:23.952343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:23.955526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:24.155023 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.201 seconds
[0m18:20:24.156965 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.201 seconds
[0m18:20:24.162071 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m18:20:24.165973 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m18:20:24.178440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m18:20:24.191746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m18:20:24.205624 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m18:20:24.213782 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m18:20:24.216845 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m18:20:24.216845 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m18:20:24.218183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:24.218183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:24.258455 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m18:20:24.260628 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m18:20:24.261645 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m18:20:24.261645 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m18:20:24.265211 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m18:20:24.265211 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:20:24.300207 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.034 seconds
[0m18:20:24.300207 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.035 seconds
[0m18:20:24.308539 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m18:20:24.314323 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m18:20:24.317132 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m18:20:24.317702 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m18:20:24.332607 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:24.332607 [debug] [MainThread]: On master: BEGIN
[0m18:20:24.332607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:24.365407 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m18:20:24.372439 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:24.373907 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:20:24.406022 [debug] [MainThread]: SQL status: SELECT 0 in 0.030 seconds
[0m18:20:24.410049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba5dc9bf-d468-4895-af18-3f0b0e2e0fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E72FFB90>]}
[0m18:20:24.412090 [debug] [MainThread]: On master: ROLLBACK
[0m18:20:24.415680 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:24.415680 [debug] [MainThread]: On master: BEGIN
[0m18:20:24.420295 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:20:24.421410 [debug] [MainThread]: On master: COMMIT
[0m18:20:24.421916 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:24.421916 [debug] [MainThread]: On master: COMMIT
[0m18:20:24.425938 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:20:24.425938 [debug] [MainThread]: On master: Close
[0m18:20:24.429332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:20:24.429839 [info ] [MainThread]: 
[0m18:20:24.445456 [debug] [Thread-2 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m18:20:24.437892 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m18:20:24.447873 [info ] [Thread-2 (]: 2 of 8 START snapshot public_.orders_snapshot .................................. [RUN]
[0m18:20:24.447873 [info ] [Thread-1 (]: 1 of 8 START seed file public_.orders_seed ..................................... [RUN]
[0m18:20:24.447873 [debug] [Thread-2 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m18:20:24.455546 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m18:20:24.457360 [debug] [Thread-2 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m18:20:24.457360 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m18:20:24.488367 [debug] [Thread-2 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m18:20:24.488367 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m18:20:24.741962 [debug] [Thread-2 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m18:20:24.741962 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select amount, channel from (
                

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public_"."orders_seed"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m18:20:24.779068 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:20:24.781175 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:20:24.783397 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m18:20:24.783397 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:20:24.814394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m18:20:24.818931 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:20:24.821538 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */
truncate table "attrib_analytics"."public_"."orders_seed"
[0m18:20:24.843352 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "order_ts" does not exist
LINE 11:   order_ts
           ^
HINT:  Perhaps you meant to reference the column "orders_seed.order_id".

[0m18:20:24.843352 [debug] [Thread-2 (]: On snapshot.attribution_dbt.orders_snapshot: Close
[0m18:20:24.861188 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.038 seconds
[0m18:20:24.924940 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:20:24.926957 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: 
          insert into "attrib_analytics"."public_"."orders_seed" ("order_id", "order_date", "channel", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m18:20:24.934460 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.006 seconds
[0m18:20:24.956377 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.attribution_dbt.orders_seed"
[0m18:20:25.014707 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m18:20:25.014707 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:20:25.014707 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m18:20:25.032028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m18:20:25.039270 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m18:20:25.045546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5dc9bf-d468-4895-af18-3f0b0e2e0fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E45A3440>]}
[0m18:20:25.045546 [info ] [Thread-1 (]: 1 of 8 OK loaded seed file public_.orders_seed ................................. [[32mINSERT 3[0m in 0.59s]
[0m18:20:25.047767 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m18:20:25.048991 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_orders
[0m18:20:25.053326 [info ] [Thread-4 (]: 3 of 8 START sql table model public.stg_orders ................................. [RUN]
[0m18:20:25.057301 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m18:20:25.057301 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_orders
[0m18:20:25.063007 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m18:20:25.073794 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_orders
[0m18:20:25.190955 [debug] [Thread-4 (]: Writing runtime sql for node "model.attribution_dbt.stg_orders"
[0m18:20:25.199390 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m18:20:25.201418 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: BEGIN
[0m18:20:25.203439 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:20:25.239949 [debug] [Thread-4 (]: SQL status: BEGIN in 0.038 seconds
[0m18:20:25.239949 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m18:20:25.239949 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */

  
    

  create  table "attrib_analytics"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    select
	order_id,
    cast(order_date as date) as order_date,
    lower(channel) as channel,
    cast(amount as numeric(12,2)) as amount
from "attrib_analytics"."public_"."orders_seed"
  );
  
[0m18:20:25.284344 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.039 seconds
[0m18:20:25.316310 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m18:20:25.317935 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m18:20:25.325851 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m18:20:25.339359 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m18:20:25.343973 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m18:20:25.343973 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:20:25.358438 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m18:20:25.358438 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m18:20:25.358438 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m18:20:25.367698 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m18:20:25.389466 [debug] [Thread-4 (]: Applying DROP to: "attrib_analytics"."public"."stg_orders__dbt_backup"
[0m18:20:25.408100 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m18:20:25.408100 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
drop table if exists "attrib_analytics"."public"."stg_orders__dbt_backup" cascade
[0m18:20:25.423270 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m18:20:25.428571 [debug] [Thread-4 (]: On model.attribution_dbt.stg_orders: Close
[0m18:20:25.429566 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5dc9bf-d468-4895-af18-3f0b0e2e0fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E8EF08F0>]}
[0m18:20:25.429566 [info ] [Thread-4 (]: 3 of 8 OK created sql table model public.stg_orders ............................ [[32mSELECT 3[0m in 0.37s]
[0m18:20:25.429566 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_orders
[0m18:20:25.437969 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m18:20:25.439519 [debug] [Thread-3 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m18:20:25.439519 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_orders_order_id ................................. [RUN]
[0m18:20:25.443617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.attribution_dbt.orders_seed, now test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m18:20:25.439519 [info ] [Thread-3 (]: 5 of 8 START test unique_stg_orders_order_id ................................... [RUN]
[0m18:20:25.444631 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m18:20:25.445676 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a'
[0m18:20:25.489362 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:20:25.489977 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m18:20:25.514444 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m18:20:25.514444 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m18:20:25.528108 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m18:20:25.584789 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:20:25.593359 [debug] [Thread-3 (]: Writing runtime sql for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m18:20:25.598463 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m18:20:25.602258 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m18:20:25.604759 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:20:25.606202 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:20:25.606202 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m18:20:25.610051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:25.641221 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m18:20:25.643408 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m18:20:25.644052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m18:20:25.646218 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "attrib_analytics"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:20:25.647374 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:20:25.647374 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "attrib_analytics"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m18:20:25.659485 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m18:20:25.659485 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m18:20:25.669513 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m18:20:25.675823 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m18:20:25.678422 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m18:20:25.679096 [debug] [Thread-3 (]: On test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m18:20:25.682526 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.24s]
[0m18:20:25.684654 [info ] [Thread-3 (]: 5 of 8 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.24s]
[0m18:20:25.685672 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m18:20:25.690658 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m18:20:25.692237 [debug] [Thread-4 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m18:20:25.695003 [info ] [Thread-4 (]: 6 of 8 START sql table model public.mart_revenue_daily ......................... [RUN]
[0m18:20:25.696843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_orders, now model.attribution_dbt.mart_revenue_daily)
[0m18:20:25.697859 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m18:20:25.704679 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m18:20:25.709568 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m18:20:25.717960 [debug] [Thread-4 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_daily"
[0m18:20:25.721739 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m18:20:25.723053 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: BEGIN
[0m18:20:25.725781 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:20:25.760270 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m18:20:25.761742 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m18:20:25.764599 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
  order_date,
  channel,
  sum(amount) as revenue
from "attrib_analytics"."public"."stg_orders"
group by 1,2
  );
  
[0m18:20:25.794987 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.030 seconds
[0m18:20:25.805737 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m18:20:25.805737 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily" rename to "mart_revenue_daily__dbt_backup"
[0m18:20:25.814116 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m18:20:25.817399 [debug] [Thread-2 (]: Database Error in snapshot orders_snapshot (snapshots\orders_snapshot.sql)
  column "order_ts" does not exist
  LINE 11:   order_ts
             ^
  HINT:  Perhaps you meant to reference the column "orders_seed.order_id".
[0m18:20:25.828670 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m18:20:25.830027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5dc9bf-d468-4895-af18-3f0b0e2e0fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E8D24B00>]}
[0m18:20:25.830027 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp" rename to "mart_revenue_daily"
[0m18:20:25.834760 [error] [Thread-2 (]: 2 of 8 ERROR snapshotting public_.orders_snapshot .............................. [[31mERROR[0m in 1.38s]
[0m18:20:25.840287 [debug] [Thread-2 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m18:20:25.840287 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m18:20:25.847356 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m18:20:25.847356 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m18:20:25.847356 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m18:20:25.858495 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m18:20:25.866473 [debug] [Thread-4 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_daily__dbt_backup"
[0m18:20:25.870133 [debug] [Thread-4 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m18:20:25.872242 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_daily__dbt_backup" cascade
[0m18:20:25.885928 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m18:20:25.891764 [debug] [Thread-4 (]: On model.attribution_dbt.mart_revenue_daily: Close
[0m18:20:25.894733 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5dc9bf-d468-4895-af18-3f0b0e2e0fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E8D32390>]}
[0m18:20:25.898578 [info ] [Thread-4 (]: 6 of 8 OK created sql table model public.mart_revenue_daily .................... [[32mSELECT 3[0m in 0.20s]
[0m18:20:25.904932 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m18:20:25.911098 [debug] [Thread-3 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m18:20:25.911098 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m18:20:25.914905 [info ] [Thread-3 (]: 7 of 8 START test accepted_values_mart_revenue_daily_channel__ads__email__direct  [RUN]
[0m18:20:25.919411 [info ] [Thread-1 (]: 8 of 8 START test not_null_mart_revenue_daily_order_date ....................... [RUN]
[0m18:20:25.925839 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a, now test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f)
[0m18:20:25.926481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097)
[0m18:20:25.929636 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m18:20:25.930330 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m18:20:25.966683 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m18:20:25.980656 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m18:20:25.982176 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m18:20:25.982176 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m18:20:25.991608 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m18:20:25.999942 [debug] [Thread-3 (]: Writing runtime sql for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m18:20:26.005770 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m18:20:26.006973 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m18:20:26.006973 [debug] [Thread-3 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: BEGIN
[0m18:20:26.011182 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: BEGIN
[0m18:20:26.014386 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:20:26.014386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:26.056903 [debug] [Thread-3 (]: SQL status: BEGIN in 0.042 seconds
[0m18:20:26.057697 [debug] [Thread-3 (]: Using postgres connection "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m18:20:26.057697 [debug] [Thread-3 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        channel as value_field,
        count(*) as n_records

    from "attrib_analytics"."public"."mart_revenue_daily"
    group by channel

)

select *
from all_values
where value_field not in (
    'ads','email','direct'
)



  
  
      
    ) dbt_internal_test
[0m18:20:26.062137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m18:20:26.064258 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m18:20:26.064953 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:20:26.066554 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "attrib_analytics"."public"."mart_revenue_daily"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m18:20:26.071529 [debug] [Thread-3 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: ROLLBACK
[0m18:20:26.077472 [debug] [Thread-3 (]: On test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f: Close
[0m18:20:26.077472 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:20:26.089952 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: ROLLBACK
[0m18:20:26.082151 [info ] [Thread-3 (]: 7 of 8 PASS accepted_values_mart_revenue_daily_channel__ads__email__direct ..... [[32mPASS[0m in 0.16s]
[0m18:20:26.096058 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m18:20:26.096058 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097: Close
[0m18:20:26.100822 [info ] [Thread-1 (]: 8 of 8 PASS not_null_mart_revenue_daily_order_date ............................. [[32mPASS[0m in 0.17s]
[0m18:20:26.105514 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m18:20:26.110546 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:26.111331 [debug] [MainThread]: On master: BEGIN
[0m18:20:26.112665 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:20:26.144196 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m18:20:26.144196 [debug] [MainThread]: On master: COMMIT
[0m18:20:26.146902 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:26.148504 [debug] [MainThread]: On master: COMMIT
[0m18:20:26.149583 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:20:26.151142 [debug] [MainThread]: On master: Close
[0m18:20:26.153887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:26.154612 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m18:20:26.156312 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m18:20:26.156312 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m18:20:26.156312 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m18:20:26.156312 [debug] [MainThread]: Connection 'snapshot.attribution_dbt.orders_snapshot' was properly closed.
[0m18:20:26.159260 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097' was properly closed.
[0m18:20:26.159892 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_daily' was properly closed.
[0m18:20:26.160892 [debug] [MainThread]: Connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f' was properly closed.
[0m18:20:26.161546 [info ] [MainThread]: 
[0m18:20:26.161546 [info ] [MainThread]: Finished running 1 seed, 2 table models, 4 data tests, 1 snapshot in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m18:20:26.168407 [debug] [MainThread]: Command end result
[0m18:20:26.261964 [info ] [MainThread]: 
[0m18:20:26.266396 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:20:26.266396 [info ] [MainThread]: 
[0m18:20:26.269893 [error] [MainThread]:   Database Error in snapshot orders_snapshot (snapshots\orders_snapshot.sql)
  column "order_ts" does not exist
  LINE 11:   order_ts
             ^
  HINT:  Perhaps you meant to reference the column "orders_seed.order_id".
[0m18:20:26.273283 [info ] [MainThread]: 
[0m18:20:26.274536 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m18:20:26.277794 [debug] [MainThread]: Command `dbt build` failed at 18:20:26.276743 after 6.76 seconds
[0m18:20:26.277794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E695E180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E6DE9B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247E6DE99D0>]}
[0m18:20:26.281665 [debug] [MainThread]: Flushing usage events
[0m18:50:16.277005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218BF2B61B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218BF172BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218BF170C20>]}


============================== 18:50:16.287836 | e7017173-8f34-4d52-a7bc-17e95dcae6a6 ==============================
[0m18:50:16.287836 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:50:16.288357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:50:16.698448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7017173-8f34-4d52-a7bc-17e95dcae6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218BFAF8710>]}
[0m18:50:16.779222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7017173-8f34-4d52-a7bc-17e95dcae6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218BD439790>]}
[0m18:50:16.783852 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:50:17.227761 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:50:17.521087 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:50:17.599977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7017173-8f34-4d52-a7bc-17e95dcae6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C1262ED0>]}
[0m18:50:24.127948 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:50:24.132689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e7017173-8f34-4d52-a7bc-17e95dcae6a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218BFFC41D0>]}
[0m18:50:24.823754 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m18:50:24.823754 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m18:50:24.826797 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m18:50:24.826797 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m18:50:24.827803 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m18:50:24.828374 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m18:50:24.828374 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m18:50:24.979323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7017173-8f34-4d52-a7bc-17e95dcae6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C1405B80>]}
[0m18:50:25.263957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7017173-8f34-4d52-a7bc-17e95dcae6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C1500260>]}
[0m18:50:25.268823 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m18:50:25.269846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7017173-8f34-4d52-a7bc-17e95dcae6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C12EE630>]}
[0m18:50:25.272241 [info ] [MainThread]: 
[0m18:50:25.272241 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:25.272241 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m18:50:25.410346 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m18:50:25.410346 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:50:25.410346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:25.544967 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.133 seconds
[0m18:50:25.550115 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m18:50:25.560157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m18:50:25.575444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m18:50:25.577470 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m18:50:25.583033 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m18:50:25.584078 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m18:50:25.584078 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m18:50:25.584078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:25.585605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:25.607005 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m18:50:25.612410 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m18:50:25.613920 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:50:25.613920 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m18:50:25.613920 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m18:50:25.615964 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m18:50:25.652042 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.038 seconds
[0m18:50:25.654053 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.037 seconds
[0m18:50:25.655966 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m18:50:25.658983 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m18:50:25.660494 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m18:50:25.661327 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m18:50:25.673005 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:25.675028 [debug] [MainThread]: On master: BEGIN
[0m18:50:25.675028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:25.697158 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m18:50:25.697909 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:25.698497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:25.722229 [debug] [MainThread]: SQL status: SELECT 0 in 0.025 seconds
[0m18:50:25.722229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7017173-8f34-4d52-a7bc-17e95dcae6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C1387B30>]}
[0m18:50:25.726079 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:25.726079 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:25.728131 [debug] [MainThread]: On master: BEGIN
[0m18:50:25.728648 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:50:25.730441 [debug] [MainThread]: On master: COMMIT
[0m18:50:25.730441 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:25.730441 [debug] [MainThread]: On master: COMMIT
[0m18:50:25.734535 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:50:25.734535 [debug] [MainThread]: On master: Close
[0m18:50:25.734535 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:50:25.734535 [info ] [MainThread]: 
[0m18:50:25.745437 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m18:50:25.745437 [info ] [Thread-1 (]: 1 of 1 START seed file public_.orders_seed ..................................... [RUN]
[0m18:50:25.745437 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m18:50:25.745437 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m18:50:25.750957 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m18:50:25.796284 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public_"."orders_seed"
[0m18:50:25.806152 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:50:25.806152 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */
drop table if exists "attrib_analytics"."public_"."orders_seed" cascade
[0m18:50:25.807676 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:25.952024 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.146 seconds
[0m18:50:25.956346 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:50:25.956346 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m18:50:25.956346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:50:25.956346 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:50:25.956346 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */

    create table "attrib_analytics"."public_"."orders_seed" ("order_id" integer,"order_date" date,"channel" text,"amount" numeric(12,2),"order_ts" timestamp)
  
[0m18:50:26.006482 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.042 seconds
[0m18:50:26.055941 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:50:26.055941 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: 
          insert into "attrib_analytics"."public_"."orders_seed" ("order_id", "order_date", "channel", "amount", "order_ts") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m18:50:26.066922 [debug] [Thread-1 (]: Postgres adapter: Postgres error: date/time field value out of range: "25/10/2025"
LINE 3:           ('1','25/10/2025','ads','120.5',NULL),('2','26/10/...
                       ^
HINT:  Perhaps you need a different "datestyle" setting.

[0m18:50:26.068715 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: ROLLBACK
[0m18:50:26.068715 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m18:50:26.200216 [debug] [Thread-1 (]: Database Error in seed orders_seed (seeds\orders_seed.csv)
  date/time field value out of range: "25/10/2025"
  LINE 3:           ('1','25/10/2025','ads','120.5',NULL),('2','26/10/...
                         ^
  HINT:  Perhaps you need a different "datestyle" setting.
[0m18:50:26.201240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7017173-8f34-4d52-a7bc-17e95dcae6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218BF1E10D0>]}
[0m18:50:26.205938 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public_.orders_seed ............................. [[31mERROR[0m in 0.46s]
[0m18:50:26.207964 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m18:50:26.212494 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:26.212494 [debug] [MainThread]: On master: BEGIN
[0m18:50:26.216425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:26.239109 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m18:50:26.240545 [debug] [MainThread]: On master: COMMIT
[0m18:50:26.241106 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:26.241842 [debug] [MainThread]: On master: COMMIT
[0m18:50:26.244019 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:50:26.244553 [debug] [MainThread]: On master: Close
[0m18:50:26.245109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:26.245762 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m18:50:26.245762 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m18:50:26.245762 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m18:50:26.245762 [debug] [MainThread]: Connection 'seed.attribution_dbt.orders_seed' was properly closed.
[0m18:50:26.247825 [info ] [MainThread]: 
[0m18:50:26.247825 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m18:50:26.247825 [debug] [MainThread]: Command end result
[0m18:50:26.289189 [info ] [MainThread]: 
[0m18:50:26.291284 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:26.291284 [info ] [MainThread]: 
[0m18:50:26.294378 [error] [MainThread]:   Database Error in seed orders_seed (seeds\orders_seed.csv)
  date/time field value out of range: "25/10/2025"
  LINE 3:           ('1','25/10/2025','ads','120.5',NULL),('2','26/10/...
                         ^
  HINT:  Perhaps you need a different "datestyle" setting.
[0m18:50:26.294378 [info ] [MainThread]: 
[0m18:50:26.294378 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:50:26.294378 [debug] [MainThread]: Command `dbt seed` failed at 18:50:26.294378 after 10.32 seconds
[0m18:50:26.294378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218BF5BC920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218BF247860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C1567200>]}
[0m18:50:26.294378 [debug] [MainThread]: Flushing usage events
[0m18:50:31.183724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026628CE6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266260791F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026625124CB0>]}


============================== 18:50:31.191744 | e4a3d1dd-eb6d-466b-96a4-b927ca3053fc ==============================
[0m18:50:31.191744 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:50:31.191744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --select orders_snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:50:31.466653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4a3d1dd-eb6d-466b-96a4-b927ca3053fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026628F443E0>]}
[0m18:50:31.565977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4a3d1dd-eb6d-466b-96a4-b927ca3053fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026628F46660>]}
[0m18:50:31.568010 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:50:31.928871 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:50:32.266305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:32.266305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:32.370374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4a3d1dd-eb6d-466b-96a4-b927ca3053fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002662A365640>]}
[0m18:50:32.647248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4a3d1dd-eb6d-466b-96a4-b927ca3053fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002662A73DAC0>]}
[0m18:50:32.647248 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m18:50:32.647248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4a3d1dd-eb6d-466b-96a4-b927ca3053fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002662A7251F0>]}
[0m18:50:32.654095 [info ] [MainThread]: 
[0m18:50:32.654095 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:32.656109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m18:50:32.781860 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m18:50:32.784146 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:50:32.784146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:32.807979 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.028 seconds
[0m18:50:32.815841 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m18:50:32.821216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m18:50:32.821216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m18:50:32.833947 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m18:50:32.835959 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m18:50:32.835959 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m18:50:32.839183 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m18:50:32.839183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:32.839183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:32.861815 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m18:50:32.861815 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m18:50:32.863834 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:50:32.866667 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m18:50:32.866667 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m18:50:32.868696 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m18:50:32.868696 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m18:50:32.870715 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m18:50:32.870715 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m18:50:32.870715 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m18:50:32.870715 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m18:50:32.875690 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m18:50:32.883454 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:32.883454 [debug] [MainThread]: On master: BEGIN
[0m18:50:32.883454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:32.923256 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m18:50:32.923256 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:32.926016 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:32.933478 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:50:32.933478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4a3d1dd-eb6d-466b-96a4-b927ca3053fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002662A3C3950>]}
[0m18:50:32.936458 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:32.936458 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:32.936458 [debug] [MainThread]: On master: BEGIN
[0m18:50:32.936458 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:50:32.936458 [debug] [MainThread]: On master: COMMIT
[0m18:50:32.936458 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:32.942147 [debug] [MainThread]: On master: COMMIT
[0m18:50:32.942147 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:50:32.944292 [debug] [MainThread]: On master: Close
[0m18:50:32.944292 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:50:32.946426 [info ] [MainThread]: 
[0m18:50:32.948264 [debug] [Thread-1 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m18:50:32.948264 [info ] [Thread-1 (]: 1 of 1 START snapshot public_.orders_snapshot .................................. [RUN]
[0m18:50:32.953865 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m18:50:32.953865 [debug] [Thread-1 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m18:50:32.964740 [debug] [Thread-1 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m18:50:33.047004 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m18:50:33.047004 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select amount, channel from (
                

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public_"."orders_seed"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m18:50:33.047004 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:33.091981 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "order_ts" does not exist
LINE 11:   order_ts
           ^
HINT:  Perhaps you meant to reference the column "orders_seed.order_id".

[0m18:50:33.091981 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: Close
[0m18:50:33.105803 [debug] [Thread-1 (]: Database Error in snapshot orders_snapshot (snapshots\orders_snapshot.sql)
  column "order_ts" does not exist
  LINE 11:   order_ts
             ^
  HINT:  Perhaps you meant to reference the column "orders_seed.order_id".
[0m18:50:33.105803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4a3d1dd-eb6d-466b-96a4-b927ca3053fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002662AB4C860>]}
[0m18:50:33.108428 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting public_.orders_snapshot .............................. [[31mERROR[0m in 0.15s]
[0m18:50:33.109435 [debug] [Thread-1 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m18:50:33.109435 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:33.109435 [debug] [MainThread]: On master: BEGIN
[0m18:50:33.109435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:33.126506 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m18:50:33.130248 [debug] [MainThread]: On master: COMMIT
[0m18:50:33.130248 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:33.130248 [debug] [MainThread]: On master: COMMIT
[0m18:50:33.130248 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:50:33.130248 [debug] [MainThread]: On master: Close
[0m18:50:33.133961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:33.134744 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m18:50:33.135768 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m18:50:33.135768 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m18:50:33.137789 [debug] [MainThread]: Connection 'snapshot.attribution_dbt.orders_snapshot' was properly closed.
[0m18:50:33.137789 [info ] [MainThread]: 
[0m18:50:33.137789 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m18:50:33.137789 [debug] [MainThread]: Command end result
[0m18:50:33.175888 [info ] [MainThread]: 
[0m18:50:33.175888 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:33.175888 [info ] [MainThread]: 
[0m18:50:33.175888 [error] [MainThread]:   Database Error in snapshot orders_snapshot (snapshots\orders_snapshot.sql)
  column "order_ts" does not exist
  LINE 11:   order_ts
             ^
  HINT:  Perhaps you meant to reference the column "orders_seed.order_id".
[0m18:50:33.175888 [info ] [MainThread]: 
[0m18:50:33.182080 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:50:33.183782 [debug] [MainThread]: Command `dbt snapshot` failed at 18:50:33.183782 after 2.19 seconds
[0m18:50:33.183782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026628A4A0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026628DD3EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026628FC5FA0>]}
[0m18:50:33.183782 [debug] [MainThread]: Flushing usage events
[0m18:57:03.536097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5909C5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58FE07680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58CE44E30>]}


============================== 18:57:03.544530 | 2875237e-65ac-4305-a1b2-8bbd08f0e0c1 ==============================
[0m18:57:03.544530 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:57:03.545517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:57:03.873311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2875237e-65ac-4305-a1b2-8bbd08f0e0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F590B68770>]}
[0m18:57:03.922304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2875237e-65ac-4305-a1b2-8bbd08f0e0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58E36EA20>]}
[0m18:57:03.922304 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:57:04.336077 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:57:04.453219 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:57:04.453219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2875237e-65ac-4305-a1b2-8bbd08f0e0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59020FD70>]}
[0m18:57:05.721849 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:57:05.723305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2875237e-65ac-4305-a1b2-8bbd08f0e0c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F590C8C500>]}
[0m18:57:05.948101 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m18:57:05.949614 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m18:57:05.950186 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m18:57:05.950186 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m18:57:05.950186 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m18:57:05.950186 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m18:57:05.950186 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m18:57:06.029401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2875237e-65ac-4305-a1b2-8bbd08f0e0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F592536B70>]}
[0m18:57:06.184862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2875237e-65ac-4305-a1b2-8bbd08f0e0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5926B0290>]}
[0m18:57:06.184862 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m18:57:06.184862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2875237e-65ac-4305-a1b2-8bbd08f0e0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5926C00B0>]}
[0m18:57:06.192699 [info ] [MainThread]: 
[0m18:57:06.192699 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:06.194709 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m18:57:06.371432 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m18:57:06.371432 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:57:06.373541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:06.485548 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.117 seconds
[0m18:57:06.485548 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m18:57:06.485548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_attrib_analytics, now create_attrib_analytics_public_public_)
[0m18:57:06.485548 [debug] [ThreadPool]: Creating schema "database: "attrib_analytics"
schema: "public_public_"
"
[0m18:57:06.499008 [debug] [ThreadPool]: Using postgres connection "create_attrib_analytics_public_public_"
[0m18:57:06.499008 [debug] [ThreadPool]: On create_attrib_analytics_public_public_: BEGIN
[0m18:57:06.499008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:06.516219 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m18:57:06.516219 [debug] [ThreadPool]: Using postgres connection "create_attrib_analytics_public_public_"
[0m18:57:06.516219 [debug] [ThreadPool]: On create_attrib_analytics_public_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "create_attrib_analytics_public_public_"} */
create schema if not exists "public_public_"
[0m18:57:06.528984 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.006 seconds
[0m18:57:06.528984 [debug] [ThreadPool]: On create_attrib_analytics_public_public_: COMMIT
[0m18:57:06.528984 [debug] [ThreadPool]: Using postgres connection "create_attrib_analytics_public_public_"
[0m18:57:06.528984 [debug] [ThreadPool]: On create_attrib_analytics_public_public_: COMMIT
[0m18:57:06.536551 [debug] [ThreadPool]: SQL status: COMMIT in 0.006 seconds
[0m18:57:06.536551 [debug] [ThreadPool]: On create_attrib_analytics_public_public_: Close
[0m18:57:06.544884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m18:57:06.546900 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m18:57:06.546900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m18:57:06.546900 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m18:57:06.546900 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m18:57:06.546900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_public_'
[0m18:57:06.546900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:06.546900 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m18:57:06.557323 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_public_"
[0m18:57:06.558555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:06.558555 [debug] [ThreadPool]: On list_attrib_analytics_public_public_: BEGIN
[0m18:57:06.560112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:06.579076 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m18:57:06.580074 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m18:57:06.580074 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m18:57:06.584611 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m18:57:06.585613 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m18:57:06.586019 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m18:57:06.586019 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_public_"
[0m18:57:06.587041 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:57:06.587041 [debug] [ThreadPool]: On list_attrib_analytics_public_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public_'
  
[0m18:57:06.596655 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.015 seconds
[0m18:57:06.596655 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m18:57:06.597678 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m18:57:06.599198 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m18:57:06.600216 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m18:57:06.601200 [debug] [ThreadPool]: On list_attrib_analytics_public_public_: ROLLBACK
[0m18:57:06.603201 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m18:57:06.603201 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m18:57:06.604202 [debug] [ThreadPool]: On list_attrib_analytics_public_public_: Close
[0m18:57:06.610808 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:06.610808 [debug] [MainThread]: On master: BEGIN
[0m18:57:06.610808 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:06.629481 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m18:57:06.629481 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:06.629481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:06.640638 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m18:57:06.640638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2875237e-65ac-4305-a1b2-8bbd08f0e0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F592745A30>]}
[0m18:57:06.640638 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:06.640638 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:06.640638 [debug] [MainThread]: On master: BEGIN
[0m18:57:06.650395 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:57:06.650395 [debug] [MainThread]: On master: COMMIT
[0m18:57:06.650395 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:06.650395 [debug] [MainThread]: On master: COMMIT
[0m18:57:06.650395 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:57:06.650395 [debug] [MainThread]: On master: Close
[0m18:57:06.653425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:06.654542 [info ] [MainThread]: 
[0m18:57:06.661532 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m18:57:06.662533 [info ] [Thread-1 (]: 1 of 1 START seed file public_public_.orders_seed .............................. [RUN]
[0m18:57:06.663532 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m18:57:06.663532 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m18:57:06.664547 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m18:57:06.689002 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:57:06.689002 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m18:57:06.689002 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:57:06.723330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m18:57:06.723330 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:57:06.723330 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */

    create table "attrib_analytics"."public_public_"."orders_seed" ("order_id" integer,"order_date" date,"channel" text,"amount" numeric(12,2),"order_ts" timestamp)
  
[0m18:57:06.768646 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.037 seconds
[0m18:57:06.785412 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m18:57:06.785412 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: 
          insert into "attrib_analytics"."public_public_"."orders_seed" ("order_id", "order_date", "channel", "amount", "order_ts") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m18:57:06.808535 [debug] [Thread-1 (]: Postgres adapter: Postgres error: date/time field value out of range: "25/10/2025"
LINE 3:           ('1','25/10/2025','ads','120.5','2025-10-25T00:00:...
                       ^
HINT:  Perhaps you need a different "datestyle" setting.

[0m18:57:06.808535 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: ROLLBACK
[0m18:57:06.808535 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m18:57:06.816590 [debug] [Thread-1 (]: Database Error in seed orders_seed (seeds\orders_seed.csv)
  date/time field value out of range: "25/10/2025"
  LINE 3:           ('1','25/10/2025','ads','120.5','2025-10-25T00:00:...
                         ^
  HINT:  Perhaps you need a different "datestyle" setting.
[0m18:57:06.816590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2875237e-65ac-4305-a1b2-8bbd08f0e0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59247C590>]}
[0m18:57:06.824195 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public_public_.orders_seed ...................... [[31mERROR[0m in 0.15s]
[0m18:57:06.824195 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m18:57:06.826137 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:06.826137 [debug] [MainThread]: On master: BEGIN
[0m18:57:06.826137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:06.848598 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m18:57:06.848598 [debug] [MainThread]: On master: COMMIT
[0m18:57:06.848598 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:06.848598 [debug] [MainThread]: On master: COMMIT
[0m18:57:06.852380 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:06.852380 [debug] [MainThread]: On master: Close
[0m18:57:06.852380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:06.852380 [debug] [MainThread]: Connection 'create_attrib_analytics_public_public_' was properly closed.
[0m18:57:06.852380 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m18:57:06.856009 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m18:57:06.856009 [debug] [MainThread]: Connection 'list_attrib_analytics_public_public_' was properly closed.
[0m18:57:06.856009 [debug] [MainThread]: Connection 'seed.attribution_dbt.orders_seed' was properly closed.
[0m18:57:06.857207 [info ] [MainThread]: 
[0m18:57:06.858216 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m18:57:06.859220 [debug] [MainThread]: Command end result
[0m18:57:06.886872 [info ] [MainThread]: 
[0m18:57:06.889084 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:57:06.889084 [info ] [MainThread]: 
[0m18:57:06.889084 [error] [MainThread]:   Database Error in seed orders_seed (seeds\orders_seed.csv)
  date/time field value out of range: "25/10/2025"
  LINE 3:           ('1','25/10/2025','ads','120.5','2025-10-25T00:00:...
                         ^
  HINT:  Perhaps you need a different "datestyle" setting.
[0m18:57:06.889084 [info ] [MainThread]: 
[0m18:57:06.889084 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:57:06.889084 [debug] [MainThread]: Command `dbt seed` failed at 18:57:06.889084 after 3.65 seconds
[0m18:57:06.889084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F58FDDC980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F590B08110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F590B09730>]}
[0m18:57:06.889084 [debug] [MainThread]: Flushing usage events
[0m19:03:44.159844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015505A9EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001550579F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015507C80BF0>]}


============================== 19:03:44.169734 | 6d9c7914-b078-405b-a299-95874d94d51b ==============================
[0m19:03:44.169734 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:03:44.170295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m19:03:44.400301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d9c7914-b078-405b-a299-95874d94d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015508583F20>]}
[0m19:03:44.483298 [debug] [MainThread]: Command `dbt clean` succeeded at 19:03:44.483298 after 0.58 seconds
[0m19:03:44.483298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015507D1CB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015507D1E060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155049944D0>]}
[0m19:03:44.484838 [debug] [MainThread]: Flushing usage events
[0m19:03:53.818357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E768FD3E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7664F4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7692B1D30>]}


============================== 19:03:53.826392 | d2f1fb6a-d00d-4a54-b0d9-ecad9861bf31 ==============================
[0m19:03:53.826392 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:03:53.829335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --full-refresh', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:03:54.090483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2f1fb6a-d00d-4a54-b0d9-ecad9861bf31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7687AF6E0>]}
[0m19:03:54.185533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2f1fb6a-d00d-4a54-b0d9-ecad9861bf31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E769224F50>]}
[0m19:03:54.188544 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:03:54.632911 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:03:54.632911 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:03:54.632911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2f1fb6a-d00d-4a54-b0d9-ecad9861bf31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7699A8EC0>]}
[0m19:03:56.329101 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:03:56.338363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd2f1fb6a-d00d-4a54-b0d9-ecad9861bf31', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E76995DD00>]}
[0m19:03:56.559791 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m19:03:56.559791 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m19:03:56.559791 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m19:03:56.559791 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m19:03:56.562768 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m19:03:56.562768 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m19:03:56.562768 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m19:03:56.644597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2f1fb6a-d00d-4a54-b0d9-ecad9861bf31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E76AC76C60>]}
[0m19:03:56.794624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2f1fb6a-d00d-4a54-b0d9-ecad9861bf31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E76B015760>]}
[0m19:03:56.795721 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m19:03:56.796635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f1fb6a-d00d-4a54-b0d9-ecad9861bf31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E76AD22A50>]}
[0m19:03:56.798725 [info ] [MainThread]: 
[0m19:03:56.799733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:03:56.800728 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m19:03:56.888607 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m19:03:56.888607 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m19:03:56.890130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:57.006212 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.120 seconds
[0m19:03:57.010634 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m19:03:57.016597 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m19:03:57.016597 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:03:57.016597 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m19:03:57.016597 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m19:03:57.026476 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:03:57.026476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:57.026476 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m19:03:57.028494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:57.057359 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m19:03:57.057359 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m19:03:57.058360 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:03:57.058360 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:03:57.058360 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m19:03:57.058360 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:03:57.080645 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.026 seconds
[0m19:03:57.080645 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.026 seconds
[0m19:03:57.086927 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m19:03:57.086927 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m19:03:57.090477 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m19:03:57.091048 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m19:03:57.097422 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:57.097422 [debug] [MainThread]: On master: BEGIN
[0m19:03:57.097422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:03:57.128632 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m19:03:57.128632 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:57.128632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:03:57.155383 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m19:03:57.156389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f1fb6a-d00d-4a54-b0d9-ecad9861bf31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E766D546B0>]}
[0m19:03:57.157413 [debug] [MainThread]: On master: ROLLBACK
[0m19:03:57.159391 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:57.159976 [debug] [MainThread]: On master: BEGIN
[0m19:03:57.161614 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:03:57.163210 [debug] [MainThread]: On master: COMMIT
[0m19:03:57.163210 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:57.163210 [debug] [MainThread]: On master: COMMIT
[0m19:03:57.165756 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:03:57.165756 [debug] [MainThread]: On master: Close
[0m19:03:57.166768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:03:57.166768 [info ] [MainThread]: 
[0m19:03:57.170889 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m19:03:57.170889 [info ] [Thread-1 (]: 1 of 1 START seed file public.orders_seed ...................................... [RUN]
[0m19:03:57.170889 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m19:03:57.176932 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m19:03:57.176932 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m19:03:57.202512 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m19:03:57.202512 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m19:03:57.206621 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:03:57.242981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m19:03:57.247963 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m19:03:57.247963 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */

    create table "attrib_analytics"."public"."orders_seed" ("order_id" integer,"order_date" date,"channel" text,"amount" numeric(12,2),"order_ts" timestamp)
  
[0m19:03:57.289454 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.042 seconds
[0m19:03:57.305476 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m19:03:57.305476 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: 
          insert into "attrib_analytics"."public"."orders_seed" ("order_id", "order_date", "channel", "amount", "order_ts") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m19:03:57.309958 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.006 seconds
[0m19:03:57.315778 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.attribution_dbt.orders_seed"
[0m19:03:57.337169 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m19:03:57.337169 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m19:03:57.337169 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m19:03:57.346608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m19:03:57.347130 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m19:03:57.347130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f1fb6a-d00d-4a54-b0d9-ecad9861bf31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E768C21040>]}
[0m19:03:57.347130 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.orders_seed .................................. [[32mCREATE 3[0m in 0.18s]
[0m19:03:57.347130 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m19:03:57.354658 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:57.355255 [debug] [MainThread]: On master: BEGIN
[0m19:03:57.355829 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:03:57.371665 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:03:57.372329 [debug] [MainThread]: On master: COMMIT
[0m19:03:57.372329 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:57.373341 [debug] [MainThread]: On master: COMMIT
[0m19:03:57.374341 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:03:57.375338 [debug] [MainThread]: On master: Close
[0m19:03:57.375338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:57.376337 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m19:03:57.376337 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m19:03:57.377340 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m19:03:57.377340 [debug] [MainThread]: Connection 'seed.attribution_dbt.orders_seed' was properly closed.
[0m19:03:57.378337 [info ] [MainThread]: 
[0m19:03:57.378840 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m19:03:57.379848 [debug] [MainThread]: Command end result
[0m19:03:57.407252 [info ] [MainThread]: 
[0m19:03:57.409768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:57.410800 [info ] [MainThread]: 
[0m19:03:57.410800 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:03:57.410800 [debug] [MainThread]: Command `dbt seed` succeeded at 19:03:57.410800 after 3.77 seconds
[0m19:03:57.410800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7694FF860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7684F2E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E76936F0B0>]}
[0m19:03:57.410800 [debug] [MainThread]: Flushing usage events
[0m19:04:05.812379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017876295760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017876296C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017876295580>]}


============================== 19:04:05.818403 | 8f31756d-8d10-4dde-93e6-fadab25805e2 ==============================
[0m19:04:05.818403 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:04:05.819403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_orders mart_revenue_daily --full-refresh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:04:06.061869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f31756d-8d10-4dde-93e6-fadab25805e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017875B20FB0>]}
[0m19:04:06.130513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f31756d-8d10-4dde-93e6-fadab25805e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178753CE900>]}
[0m19:04:06.133089 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:04:06.393058 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:04:06.663367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:06.663367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:06.738718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f31756d-8d10-4dde-93e6-fadab25805e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178779D4410>]}
[0m19:04:06.939766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f31756d-8d10-4dde-93e6-fadab25805e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017877D4D280>]}
[0m19:04:06.940765 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m19:04:06.940765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f31756d-8d10-4dde-93e6-fadab25805e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178779C3D40>]}
[0m19:04:06.943557 [info ] [MainThread]: 
[0m19:04:06.944995 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:04:06.950067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m19:04:07.052460 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m19:04:07.056044 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m19:04:07.056044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:07.095301 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.039 seconds
[0m19:04:07.097571 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m19:04:07.099877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m19:04:07.101002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m19:04:07.108525 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:04:07.112796 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:04:07.112796 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m19:04:07.114825 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m19:04:07.114825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:07.114825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:07.133191 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:04:07.133191 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:04:07.133191 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:04:07.139245 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m19:04:07.139245 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:04:07.139245 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m19:04:07.144699 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m19:04:07.144699 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m19:04:07.149787 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m19:04:07.149787 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:04:07.149787 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m19:04:07.154735 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m19:04:07.163027 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:07.163027 [debug] [MainThread]: On master: BEGIN
[0m19:04:07.163027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:07.194713 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m19:04:07.194713 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:07.197400 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:04:07.230152 [debug] [MainThread]: SQL status: SELECT 0 in 0.033 seconds
[0m19:04:07.232165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f31756d-8d10-4dde-93e6-fadab25805e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017876583620>]}
[0m19:04:07.232165 [debug] [MainThread]: On master: ROLLBACK
[0m19:04:07.235222 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:07.235222 [debug] [MainThread]: On master: BEGIN
[0m19:04:07.235222 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:04:07.235222 [debug] [MainThread]: On master: COMMIT
[0m19:04:07.235222 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:07.235222 [debug] [MainThread]: On master: COMMIT
[0m19:04:07.235222 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:04:07.235222 [debug] [MainThread]: On master: Close
[0m19:04:07.240814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:04:07.242336 [info ] [MainThread]: 
[0m19:04:07.245893 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_orders
[0m19:04:07.245893 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_orders ................................. [RUN]
[0m19:04:07.250416 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m19:04:07.250416 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_orders
[0m19:04:07.261711 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m19:04:07.264319 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_orders
[0m19:04:07.318100 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_orders"
[0m19:04:07.319098 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:04:07.320691 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: BEGIN
[0m19:04:07.320691 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:04:07.340449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:04:07.340449 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:04:07.340449 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */

  
    

  create  table "attrib_analytics"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    select
	order_id,
    cast(order_date as date) as order_date,
    lower(channel) as channel,
    cast(amount as numeric(12,2)) as amount
from "attrib_analytics"."public"."orders_seed"
  );
  
[0m19:04:07.356221 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.017 seconds
[0m19:04:07.372222 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:04:07.372222 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m19:04:07.375551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m19:04:07.378611 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:04:07.378611 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:04:07.378611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:04:07.403998 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m19:04:07.406308 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:04:07.406308 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m19:04:07.411346 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m19:04:07.421045 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public"."stg_orders__dbt_backup"
[0m19:04:07.427766 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:04:07.427766 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
drop table if exists "attrib_analytics"."public"."stg_orders__dbt_backup" cascade
[0m19:04:07.451291 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m19:04:07.460525 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: Close
[0m19:04:07.463564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f31756d-8d10-4dde-93e6-fadab25805e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017873BA6EA0>]}
[0m19:04:07.464576 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_orders ............................ [[32mSELECT 3[0m in 0.22s]
[0m19:04:07.464576 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_orders
[0m19:04:07.464576 [debug] [Thread-3 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m19:04:07.468626 [info ] [Thread-3 (]: 2 of 2 START sql table model public.mart_revenue_daily ......................... [RUN]
[0m19:04:07.469497 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_daily'
[0m19:04:07.469497 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m19:04:07.474630 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m19:04:07.474630 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m19:04:07.480976 [debug] [Thread-3 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_daily"
[0m19:04:07.480976 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:04:07.480976 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: BEGIN
[0m19:04:07.480976 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:04:07.509446 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m19:04:07.510673 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:04:07.510673 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
  order_date,
  channel,
  sum(amount) as revenue
from "attrib_analytics"."public"."stg_orders"
group by 1,2
  );
  
[0m19:04:07.539827 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.028 seconds
[0m19:04:07.542515 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:04:07.545072 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily" rename to "mart_revenue_daily__dbt_backup"
[0m19:04:07.545072 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:04:07.550282 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:04:07.550282 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp" rename to "mart_revenue_daily"
[0m19:04:07.550282 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:04:07.555627 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m19:04:07.555627 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:04:07.555627 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m19:04:07.561044 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m19:04:07.561044 [debug] [Thread-3 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_daily__dbt_backup"
[0m19:04:07.561044 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:04:07.561044 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_daily__dbt_backup" cascade
[0m19:04:07.576854 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m19:04:07.580130 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: Close
[0m19:04:07.581138 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f31756d-8d10-4dde-93e6-fadab25805e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178783A7170>]}
[0m19:04:07.581138 [info ] [Thread-3 (]: 2 of 2 OK created sql table model public.mart_revenue_daily .................... [[32mSELECT 3[0m in 0.11s]
[0m19:04:07.581138 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m19:04:07.584858 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:07.586380 [debug] [MainThread]: On master: BEGIN
[0m19:04:07.586380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:04:07.602625 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:04:07.602625 [debug] [MainThread]: On master: COMMIT
[0m19:04:07.602625 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:07.606190 [debug] [MainThread]: On master: COMMIT
[0m19:04:07.606190 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:04:07.608778 [debug] [MainThread]: On master: Close
[0m19:04:07.608778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:07.608778 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m19:04:07.608778 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m19:04:07.608778 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m19:04:07.608778 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_orders' was properly closed.
[0m19:04:07.612297 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_daily' was properly closed.
[0m19:04:07.612297 [info ] [MainThread]: 
[0m19:04:07.612297 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m19:04:07.612297 [debug] [MainThread]: Command end result
[0m19:04:07.656838 [info ] [MainThread]: 
[0m19:04:07.656838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:07.656838 [info ] [MainThread]: 
[0m19:04:07.656838 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:04:07.656838 [debug] [MainThread]: Command `dbt run` succeeded at 19:04:07.656838 after 2.03 seconds
[0m19:04:07.656838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787655D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017875957320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017873DA8CB0>]}
[0m19:04:07.663819 [debug] [MainThread]: Flushing usage events
[0m19:04:16.680487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9187C4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9178A4BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91A2FA420>]}


============================== 19:04:16.685155 | 7e686d85-b192-4e57-a815-37a25c87ac2a ==============================
[0m19:04:16.685155 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:04:16.688300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --select orders_snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:04:16.918853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e686d85-b192-4e57-a815-37a25c87ac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91C9E6450>]}
[0m19:04:16.984307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e686d85-b192-4e57-a815-37a25c87ac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91ACAECC0>]}
[0m19:04:16.987901 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:04:17.236449 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:04:17.440710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:17.440710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:17.512680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e686d85-b192-4e57-a815-37a25c87ac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91B5CB560>]}
[0m19:04:17.677446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e686d85-b192-4e57-a815-37a25c87ac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91CE4EBD0>]}
[0m19:04:17.677446 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m19:04:17.677446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e686d85-b192-4e57-a815-37a25c87ac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91CA964E0>]}
[0m19:04:17.684417 [info ] [MainThread]: 
[0m19:04:17.684417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:04:17.688350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m19:04:17.784543 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m19:04:17.784543 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m19:04:17.784543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:17.816119 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.032 seconds
[0m19:04:17.816119 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m19:04:17.827090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m19:04:17.839387 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:04:17.839387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m19:04:17.840389 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m19:04:17.842587 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:04:17.844611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:17.844611 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m19:04:17.844611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:17.864263 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:04:17.864786 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:04:17.864786 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m19:04:17.864786 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:04:17.864786 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:04:17.864786 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:04:17.864786 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m19:04:17.872379 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m19:04:17.872902 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m19:04:17.872902 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m19:04:17.872902 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m19:04:17.877183 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m19:04:17.885336 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:17.885336 [debug] [MainThread]: On master: BEGIN
[0m19:04:17.885336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:17.904307 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:04:17.904307 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:17.904307 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:04:17.912148 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m19:04:17.914190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e686d85-b192-4e57-a815-37a25c87ac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91C9E5C40>]}
[0m19:04:17.914190 [debug] [MainThread]: On master: ROLLBACK
[0m19:04:17.914190 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:17.914190 [debug] [MainThread]: On master: BEGIN
[0m19:04:17.914190 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:04:17.919209 [debug] [MainThread]: On master: COMMIT
[0m19:04:17.920006 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:17.920006 [debug] [MainThread]: On master: COMMIT
[0m19:04:17.920006 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:04:17.920006 [debug] [MainThread]: On master: Close
[0m19:04:17.920006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:04:17.924289 [info ] [MainThread]: 
[0m19:04:17.928369 [debug] [Thread-1 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m19:04:17.928369 [info ] [Thread-1 (]: 1 of 1 START snapshot public_.orders_snapshot .................................. [RUN]
[0m19:04:17.928369 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m19:04:17.928369 [debug] [Thread-1 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m19:04:17.944978 [debug] [Thread-1 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m19:04:18.017695 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:04:18.017695 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select amount, channel from (
                

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public_"."orders_seed"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m19:04:18.020279 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:04:18.039364 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "order_ts" does not exist
LINE 11:   order_ts
           ^
HINT:  Perhaps you meant to reference the column "orders_seed.order_id".

[0m19:04:18.040367 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: Close
[0m19:04:18.057099 [debug] [Thread-1 (]: Database Error in snapshot orders_snapshot (snapshots\orders_snapshot.sql)
  column "order_ts" does not exist
  LINE 11:   order_ts
             ^
  HINT:  Perhaps you meant to reference the column "orders_seed.order_id".
[0m19:04:18.059665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e686d85-b192-4e57-a815-37a25c87ac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91B54FEC0>]}
[0m19:04:18.060734 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting public_.orders_snapshot .............................. [[31mERROR[0m in 0.13s]
[0m19:04:18.063341 [debug] [Thread-1 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m19:04:18.065351 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:18.066398 [debug] [MainThread]: On master: BEGIN
[0m19:04:18.066398 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:04:18.100979 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m19:04:18.104090 [debug] [MainThread]: On master: COMMIT
[0m19:04:18.104090 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:18.104090 [debug] [MainThread]: On master: COMMIT
[0m19:04:18.106408 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:04:18.107015 [debug] [MainThread]: On master: Close
[0m19:04:18.107015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:18.107015 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m19:04:18.107015 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m19:04:18.107015 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m19:04:18.107015 [debug] [MainThread]: Connection 'snapshot.attribution_dbt.orders_snapshot' was properly closed.
[0m19:04:18.107015 [info ] [MainThread]: 
[0m19:04:18.111175 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m19:04:18.111175 [debug] [MainThread]: Command end result
[0m19:04:18.142444 [info ] [MainThread]: 
[0m19:04:18.148388 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:04:18.148388 [info ] [MainThread]: 
[0m19:04:18.148388 [error] [MainThread]:   Database Error in snapshot orders_snapshot (snapshots\orders_snapshot.sql)
  column "order_ts" does not exist
  LINE 11:   order_ts
             ^
  HINT:  Perhaps you meant to reference the column "orders_seed.order_id".
[0m19:04:18.148388 [info ] [MainThread]: 
[0m19:04:18.148388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:04:18.152798 [debug] [MainThread]: Command `dbt snapshot` failed at 19:04:18.152798 after 1.63 seconds
[0m19:04:18.153894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91B3FCCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91A2FA420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B91A83CC50>]}
[0m19:04:18.154587 [debug] [MainThread]: Flushing usage events
[0m19:41:02.509849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F59C9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F85D7AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F85D7F80>]}


============================== 19:41:02.520152 | 24139d85-280a-45d4-b3b8-0a08eb5f4fcc ==============================
[0m19:41:02.520152 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:41:02.521609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:41:02.729854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24139d85-280a-45d4-b3b8-0a08eb5f4fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F8723C20>]}
[0m19:41:02.779963 [debug] [MainThread]: Command `dbt clean` succeeded at 19:41:02.779963 after 0.50 seconds
[0m19:41:02.779963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F8236A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F777A060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F8723C20>]}
[0m19:41:02.780983 [debug] [MainThread]: Flushing usage events
[0m19:41:14.037866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3FF290D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3F024D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C429FB200>]}


============================== 19:41:14.043202 | 7bde8070-bc82-4535-ad19-8d43de519b48 ==============================
[0m19:41:14.043202 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:41:14.044358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:41:14.254034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bde8070-bc82-4535-ad19-8d43de519b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C429C42F0>]}
[0m19:41:14.308660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bde8070-bc82-4535-ad19-8d43de519b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C40580F50>]}
[0m19:41:14.311480 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:41:14.596597 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:41:14.598205 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:41:14.598205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7bde8070-bc82-4535-ad19-8d43de519b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C44230950>]}
[0m19:41:16.116383 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:41:16.117913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7bde8070-bc82-4535-ad19-8d43de519b48', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4484F590>]}
[0m19:41:16.373976 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m19:41:16.373976 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m19:41:16.373976 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m19:41:16.373976 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m19:41:16.376738 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m19:41:16.376738 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m19:41:16.376738 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m19:41:16.464944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bde8070-bc82-4535-ad19-8d43de519b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C44230440>]}
[0m19:41:16.615404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bde8070-bc82-4535-ad19-8d43de519b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C41B660C0>]}
[0m19:41:16.615404 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m19:41:16.615404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bde8070-bc82-4535-ad19-8d43de519b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42E35CA0>]}
[0m19:41:16.615404 [info ] [MainThread]: 
[0m19:41:16.622610 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:41:16.622610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m19:41:16.815743 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m19:41:16.815743 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m19:41:16.816749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:16.934608 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.119 seconds
[0m19:41:16.937123 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m19:41:16.942220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m19:41:16.942220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m19:41:16.950028 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:41:16.950752 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:41:16.950752 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m19:41:16.950752 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m19:41:16.950752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:16.950752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:16.972559 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:41:16.972559 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:41:16.974065 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:41:16.974065 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:41:16.974065 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:41:16.974065 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m19:41:16.982990 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m19:41:16.982990 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m19:41:16.988909 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m19:41:16.989927 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m19:41:16.989927 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m19:41:16.989927 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m19:41:16.999369 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:17.000376 [debug] [MainThread]: On master: BEGIN
[0m19:41:17.000376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:17.022004 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m19:41:17.022004 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:17.022004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:41:17.038384 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m19:41:17.038384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bde8070-bc82-4535-ad19-8d43de519b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C44589310>]}
[0m19:41:17.040402 [debug] [MainThread]: On master: ROLLBACK
[0m19:41:17.040402 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:17.040402 [debug] [MainThread]: On master: BEGIN
[0m19:41:17.043201 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:41:17.043201 [debug] [MainThread]: On master: COMMIT
[0m19:41:17.043201 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:17.043201 [debug] [MainThread]: On master: COMMIT
[0m19:41:17.043201 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:41:17.045866 [debug] [MainThread]: On master: Close
[0m19:41:17.045866 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:41:17.045866 [info ] [MainThread]: 
[0m19:41:17.054344 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m19:41:17.054344 [info ] [Thread-1 (]: 1 of 1 START seed file public.orders_seed ...................................... [RUN]
[0m19:41:17.054344 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m19:41:17.058467 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m19:41:17.059093 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m19:41:17.091083 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public"."orders_seed"
[0m19:41:17.094155 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m19:41:17.094155 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */
drop table if exists "attrib_analytics"."public"."orders_seed" cascade
[0m19:41:17.094155 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:41:17.134343 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.036 seconds
[0m19:41:17.142188 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m19:41:17.142188 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: BEGIN
[0m19:41:17.144211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m19:41:17.144211 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m19:41:17.144211 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "seed.attribution_dbt.orders_seed"} */

    create table "attrib_analytics"."public"."orders_seed" ("order_id" integer,"order_date" date,"channel" text,"amount" numeric(12,2),"order_ts" timestamp)
  
[0m19:41:17.164949 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.020 seconds
[0m19:41:17.181982 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m19:41:17.181982 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: 
          insert into "attrib_analytics"."public"."orders_seed" ("order_id", "order_date", "channel", "amount", "order_ts") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m19:41:17.189990 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.006 seconds
[0m19:41:17.195986 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.attribution_dbt.orders_seed"
[0m19:41:17.219398 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m19:41:17.220398 [debug] [Thread-1 (]: Using postgres connection "seed.attribution_dbt.orders_seed"
[0m19:41:17.220398 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: COMMIT
[0m19:41:17.237494 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m19:41:17.239069 [debug] [Thread-1 (]: On seed.attribution_dbt.orders_seed: Close
[0m19:41:17.239069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bde8070-bc82-4535-ad19-8d43de519b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C40447170>]}
[0m19:41:17.239069 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.orders_seed .................................. [[32mCREATE 3[0m in 0.18s]
[0m19:41:17.239069 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m19:41:17.239069 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:17.246115 [debug] [MainThread]: On master: BEGIN
[0m19:41:17.246115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:17.262106 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:41:17.264700 [debug] [MainThread]: On master: COMMIT
[0m19:41:17.265223 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:17.265223 [debug] [MainThread]: On master: COMMIT
[0m19:41:17.265223 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:41:17.265223 [debug] [MainThread]: On master: Close
[0m19:41:17.265223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:17.268748 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m19:41:17.268748 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m19:41:17.268748 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m19:41:17.270275 [debug] [MainThread]: Connection 'seed.attribution_dbt.orders_seed' was properly closed.
[0m19:41:17.270275 [info ] [MainThread]: 
[0m19:41:17.271312 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m19:41:17.271312 [debug] [MainThread]: Command end result
[0m19:41:17.304556 [info ] [MainThread]: 
[0m19:41:17.304556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:17.304556 [info ] [MainThread]: 
[0m19:41:17.304556 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:41:17.309275 [debug] [MainThread]: Command `dbt seed` succeeded at 19:41:17.309275 after 3.41 seconds
[0m19:41:17.309275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3FF290D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4219D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C41C72BD0>]}
[0m19:41:17.310316 [debug] [MainThread]: Flushing usage events
[0m19:41:25.537692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A96BCEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219ABB00CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219ABB00BC0>]}


============================== 19:41:25.544769 | a86a2f39-030e-4555-bc78-530d6f83cc82 ==============================
[0m19:41:25.544769 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:41:25.546727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_orders mart_revenue_daily --full-refresh', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:41:25.737455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a86a2f39-030e-4555-bc78-530d6f83cc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AC488530>]}
[0m19:41:25.789915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a86a2f39-030e-4555-bc78-530d6f83cc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AB4C4170>]}
[0m19:41:25.795481 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:41:26.022599 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:41:26.264657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:41:26.264657 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:41:26.323274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a86a2f39-030e-4555-bc78-530d6f83cc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AD9C8500>]}
[0m19:41:26.453963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a86a2f39-030e-4555-bc78-530d6f83cc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AD9CBA70>]}
[0m19:41:26.453963 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m19:41:26.453963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a86a2f39-030e-4555-bc78-530d6f83cc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219ADD1F7A0>]}
[0m19:41:26.457098 [info ] [MainThread]: 
[0m19:41:26.457098 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:41:26.460267 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m19:41:26.533316 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m19:41:26.534875 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m19:41:26.535554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:26.568248 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.034 seconds
[0m19:41:26.571207 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m19:41:26.575959 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m19:41:26.591227 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m19:41:26.590203 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:41:26.593349 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:41:26.593349 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m19:41:26.593349 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m19:41:26.593349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:26.593349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:26.618364 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:41:26.618971 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:41:26.619515 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m19:41:26.621366 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m19:41:26.622002 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:41:26.623074 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:41:26.624871 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m19:41:26.626502 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m19:41:26.627691 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m19:41:26.628321 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m19:41:26.629869 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m19:41:26.629869 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m19:41:26.637013 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:26.637616 [debug] [MainThread]: On master: BEGIN
[0m19:41:26.637616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:26.661950 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m19:41:26.661950 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:26.664513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:41:26.670241 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:41:26.670241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a86a2f39-030e-4555-bc78-530d6f83cc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AC489670>]}
[0m19:41:26.672576 [debug] [MainThread]: On master: ROLLBACK
[0m19:41:26.672576 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:26.672576 [debug] [MainThread]: On master: BEGIN
[0m19:41:26.674582 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:41:26.676609 [debug] [MainThread]: On master: COMMIT
[0m19:41:26.676609 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:26.676609 [debug] [MainThread]: On master: COMMIT
[0m19:41:26.678115 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:41:26.678115 [debug] [MainThread]: On master: Close
[0m19:41:26.680148 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:41:26.680148 [info ] [MainThread]: 
[0m19:41:26.686020 [debug] [Thread-1 (]: Began running node model.attribution_dbt.stg_orders
[0m19:41:26.686020 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_orders ................................. [RUN]
[0m19:41:26.686020 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m19:41:26.686020 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.stg_orders
[0m19:41:26.695567 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m19:41:26.698093 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.stg_orders
[0m19:41:26.737025 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.stg_orders"
[0m19:41:26.737025 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:41:26.737025 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: BEGIN
[0m19:41:26.737025 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:41:26.774088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m19:41:26.774088 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:41:26.774088 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */

  
    

  create  table "attrib_analytics"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    select
	order_id,
    cast(order_date as date) as order_date,
    lower(channel) as channel,
    cast(amount as numeric(12,2)) as amount
from "attrib_analytics"."public"."orders_seed"
  );
  
[0m19:41:26.795378 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.022 seconds
[0m19:41:26.806204 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:41:26.806204 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m19:41:26.810384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:41:26.814392 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:41:26.814392 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
alter table "attrib_analytics"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:41:26.814392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:41:26.838082 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m19:41:26.839091 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:41:26.840463 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: COMMIT
[0m19:41:26.846317 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m19:41:26.854233 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public"."stg_orders__dbt_backup"
[0m19:41:26.857118 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.stg_orders"
[0m19:41:26.857118 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.stg_orders"} */
drop table if exists "attrib_analytics"."public"."stg_orders__dbt_backup" cascade
[0m19:41:26.870092 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m19:41:26.873369 [debug] [Thread-1 (]: On model.attribution_dbt.stg_orders: Close
[0m19:41:26.873369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a86a2f39-030e-4555-bc78-530d6f83cc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A9BE70B0>]}
[0m19:41:26.873369 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_orders ............................ [[32mSELECT 3[0m in 0.19s]
[0m19:41:26.873369 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.stg_orders
[0m19:41:26.878159 [debug] [Thread-3 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m19:41:26.878159 [info ] [Thread-3 (]: 2 of 2 START sql table model public.mart_revenue_daily ......................... [RUN]
[0m19:41:26.878159 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_daily'
[0m19:41:26.878159 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m19:41:26.886190 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m19:41:26.889528 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m19:41:26.893381 [debug] [Thread-3 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_daily"
[0m19:41:26.894490 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:41:26.894490 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: BEGIN
[0m19:41:26.894490 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:41:26.932353 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m19:41:26.932353 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:41:26.932353 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
  order_date,
  channel,
  sum(amount) as revenue
from "attrib_analytics"."public"."stg_orders"
group by 1,2
  );
  
[0m19:41:26.950315 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.021 seconds
[0m19:41:26.956329 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:41:26.958597 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily" rename to "mart_revenue_daily__dbt_backup"
[0m19:41:26.958597 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:41:26.958597 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:41:26.958597 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
alter table "attrib_analytics"."public"."mart_revenue_daily__dbt_tmp" rename to "mart_revenue_daily"
[0m19:41:26.966632 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:41:26.967932 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m19:41:26.967932 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:41:26.967932 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: COMMIT
[0m19:41:26.977898 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m19:41:26.979918 [debug] [Thread-3 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_daily__dbt_backup"
[0m19:41:26.979918 [debug] [Thread-3 (]: Using postgres connection "model.attribution_dbt.mart_revenue_daily"
[0m19:41:26.979918 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_daily"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_daily__dbt_backup" cascade
[0m19:41:26.989978 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m19:41:26.989978 [debug] [Thread-3 (]: On model.attribution_dbt.mart_revenue_daily: Close
[0m19:41:26.989978 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a86a2f39-030e-4555-bc78-530d6f83cc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AE3F79E0>]}
[0m19:41:26.989978 [info ] [Thread-3 (]: 2 of 2 OK created sql table model public.mart_revenue_daily .................... [[32mSELECT 3[0m in 0.11s]
[0m19:41:26.989978 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m19:41:26.999584 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:26.999584 [debug] [MainThread]: On master: BEGIN
[0m19:41:27.001036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:27.024479 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m19:41:27.024479 [debug] [MainThread]: On master: COMMIT
[0m19:41:27.024479 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:27.024479 [debug] [MainThread]: On master: COMMIT
[0m19:41:27.029756 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:41:27.030310 [debug] [MainThread]: On master: Close
[0m19:41:27.030935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:27.030935 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m19:41:27.030935 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m19:41:27.030935 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m19:41:27.030935 [debug] [MainThread]: Connection 'model.attribution_dbt.stg_orders' was properly closed.
[0m19:41:27.030935 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_daily' was properly closed.
[0m19:41:27.034561 [info ] [MainThread]: 
[0m19:41:27.034561 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m19:41:27.036755 [debug] [MainThread]: Command end result
[0m19:41:27.064385 [info ] [MainThread]: 
[0m19:41:27.064385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:27.064385 [info ] [MainThread]: 
[0m19:41:27.064385 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:41:27.070154 [debug] [MainThread]: Command `dbt run` succeeded at 19:41:27.070154 after 1.69 seconds
[0m19:41:27.070154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219ABF7C920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A9DF8BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AC935B50>]}
[0m19:41:27.070154 [debug] [MainThread]: Flushing usage events
[0m19:41:35.490758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014135916480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141357661B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141358D5640>]}


============================== 19:41:35.497641 | 61e5fbcf-2711-494b-ba5c-9880421b8611 ==============================
[0m19:41:35.497641 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:41:35.500398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --select orders_snapshot', 'send_anonymous_usage_stats': 'True'}
[0m19:41:35.674947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61e5fbcf-2711-494b-ba5c-9880421b8611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014135BF5DC0>]}
[0m19:41:35.721917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61e5fbcf-2711-494b-ba5c-9880421b8611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014135000200>]}
[0m19:41:35.721917 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:41:35.916538 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:41:36.071771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:41:36.071771 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:41:36.124584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61e5fbcf-2711-494b-ba5c-9880421b8611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014136FB0FB0>]}
[0m19:41:36.263297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61e5fbcf-2711-494b-ba5c-9880421b8611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001413733DD60>]}
[0m19:41:36.263297 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 seed, 4 data tests, 1 source, 433 macros
[0m19:41:36.263297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61e5fbcf-2711-494b-ba5c-9880421b8611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141370ECB90>]}
[0m19:41:36.265847 [info ] [MainThread]: 
[0m19:41:36.265847 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:41:36.268885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m19:41:36.339155 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m19:41:36.340186 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m19:41:36.340186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:36.362031 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.024 seconds
[0m19:41:36.362031 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m19:41:36.368347 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m19:41:36.377736 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:41:36.377736 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m19:41:36.377736 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m19:41:36.377736 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:41:36.377736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:36.377736 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m19:41:36.382715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:36.413672 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m19:41:36.413672 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m19:41:36.413672 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:41:36.413672 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:41:36.413672 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:41:36.413672 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m19:41:36.422276 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m19:41:36.422276 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m19:41:36.423790 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m19:41:36.425830 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m19:41:36.425830 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m19:41:36.425830 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m19:41:36.434365 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:36.434365 [debug] [MainThread]: On master: BEGIN
[0m19:41:36.435531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:36.448925 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m19:41:36.448925 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:36.448925 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:41:36.455200 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:41:36.457847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61e5fbcf-2711-494b-ba5c-9880421b8611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014136FCB950>]}
[0m19:41:36.457847 [debug] [MainThread]: On master: ROLLBACK
[0m19:41:36.457847 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:36.457847 [debug] [MainThread]: On master: BEGIN
[0m19:41:36.457847 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:41:36.457847 [debug] [MainThread]: On master: COMMIT
[0m19:41:36.457847 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:36.457847 [debug] [MainThread]: On master: COMMIT
[0m19:41:36.465741 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:41:36.465741 [debug] [MainThread]: On master: Close
[0m19:41:36.465741 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:41:36.465741 [info ] [MainThread]: 
[0m19:41:36.473615 [debug] [Thread-1 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m19:41:36.473615 [info ] [Thread-1 (]: 1 of 1 START snapshot public_.orders_snapshot .................................. [RUN]
[0m19:41:36.473615 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m19:41:36.473615 [debug] [Thread-1 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m19:41:36.480898 [debug] [Thread-1 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m19:41:36.540729 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.540729 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select amount, channel from (
                

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public"."orders_seed"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m19:41:36.541733 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:41:36.574758 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m19:41:36.585858 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.585858 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: BEGIN
[0m19:41:36.585858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m19:41:36.585858 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.585858 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m19:41:36.622777 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.035 seconds
[0m19:41:36.633310 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.633835 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m19:41:36.638193 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m19:41:36.685684 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.685684 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

        
  
    

  create temporary table "orders_snapshot__dbt_tmp194136674962"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public"."orders_seed"

    ),

    snapshotted_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from "attrib_analytics"."public_"."orders_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m19:41:36.706390 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.021 seconds
[0m19:41:36.706390 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.713105 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp194136674962'
        
      order by ordinal_position

  
[0m19:41:36.716996 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m19:41:36.716996 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.716996 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m19:41:36.716996 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m19:41:36.716996 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.727174 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp194136674962'
        
      order by ordinal_position

  
[0m19:41:36.729885 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.003 seconds
[0m19:41:36.731477 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.731477 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "attrib_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot'
        
        and table_schema = 'public_'
        
      order by ordinal_position

  
[0m19:41:36.737428 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m19:41:36.742222 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.745349 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'orders_snapshot__dbt_tmp194136674962'
        
      order by ordinal_position

  
[0m19:41:36.749487 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m19:41:36.761656 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.762708 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        

select
  order_id,
  channel,
  amount,
  order_date,
  order_ts
from "attrib_analytics"."public"."orders_seed"

    ),

    snapshotted_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from "attrib_analytics"."public_"."orders_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        order_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."amount" != source_data."amount"
        or
        (
            ((snapshotted_data."amount" is null) and not (source_data."amount" is null))
            or
            ((not snapshotted_data."amount" is null) and (source_data."amount" is null))
        ) or snapshotted_data."channel" != source_data."channel"
        or
        (
            ((snapshotted_data."channel" is null) and not (source_data."channel" is null))
            or
            ((not snapshotted_data."channel" is null) and (source_data."channel" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0

[0m19:41:36.764827 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m19:41:36.767903 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.768919 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m19:41:36.770995 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m19:41:36.770995 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.773002 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.773002 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "snapshot.attribution_dbt.orders_snapshot"} */

      update "attrib_analytics"."public_"."orders_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "orders_snapshot__dbt_tmp194136674962" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "attrib_analytics"."public_"."orders_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "attrib_analytics"."public_"."orders_snapshot".dbt_valid_to is null;

    insert into "attrib_analytics"."public_"."orders_snapshot" ("order_id", "channel", "amount", "order_date", "order_ts", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."channel",DBT_INTERNAL_SOURCE."amount",DBT_INTERNAL_SOURCE."order_date",DBT_INTERNAL_SOURCE."order_ts",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "orders_snapshot__dbt_tmp194136674962" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:41:36.776821 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.004 seconds
[0m19:41:36.789552 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m19:41:36.789552 [debug] [Thread-1 (]: Using postgres connection "snapshot.attribution_dbt.orders_snapshot"
[0m19:41:36.789552 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: COMMIT
[0m19:41:36.794666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m19:41:36.802268 [debug] [Thread-1 (]: On snapshot.attribution_dbt.orders_snapshot: Close
[0m19:41:36.802268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e5fbcf-2711-494b-ba5c-9880421b8611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141331D70E0>]}
[0m19:41:36.802268 [info ] [Thread-1 (]: 1 of 1 OK snapshotted public_.orders_snapshot .................................. [[32mINSERT 0 1[0m in 0.33s]
[0m19:41:36.802268 [debug] [Thread-1 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m19:41:36.802268 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:36.808922 [debug] [MainThread]: On master: BEGIN
[0m19:41:36.810048 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:36.836192 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m19:41:36.836192 [debug] [MainThread]: On master: COMMIT
[0m19:41:36.836192 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:36.841054 [debug] [MainThread]: On master: COMMIT
[0m19:41:36.841578 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:41:36.842652 [debug] [MainThread]: On master: Close
[0m19:41:36.842652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:36.842652 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m19:41:36.842652 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m19:41:36.842652 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m19:41:36.842652 [debug] [MainThread]: Connection 'snapshot.attribution_dbt.orders_snapshot' was properly closed.
[0m19:41:36.842652 [info ] [MainThread]: 
[0m19:41:36.842652 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m19:41:36.842652 [debug] [MainThread]: Command end result
[0m19:41:36.880622 [info ] [MainThread]: 
[0m19:41:36.881591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:36.881591 [info ] [MainThread]: 
[0m19:41:36.883137 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:41:36.884145 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:41:36.884145 after 1.54 seconds
[0m19:41:36.885147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141351C5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001413582B140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001413582BD70>]}
[0m19:41:36.885147 [debug] [MainThread]: Flushing usage events
[0m19:56:39.740101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B7570770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B75716A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B5A24B90>]}


============================== 19:56:39.749594 | 75482ea7-bb6a-42ed-b08c-d0c0f39816af ==============================
[0m19:56:39.749594 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:56:39.754015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select mart_revenue_monthly mart_kpis --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:56:40.171802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75482ea7-bb6a-42ed-b08c-d0c0f39816af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B9CAA1B0>]}
[0m19:56:40.253806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75482ea7-bb6a-42ed-b08c-d0c0f39816af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B9711D00>]}
[0m19:56:40.253806 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:56:40.747758 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:56:41.078649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m19:56:41.083778 [debug] [MainThread]: Partial parsing: added file: attribution_dbt://models\marts\mart_revenue_monthly.sql
[0m19:56:41.084812 [debug] [MainThread]: Partial parsing: added file: attribution_dbt://models\marts\mart_kpis.sql
[0m19:56:41.084812 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\schema.yml
[0m19:56:41.420191 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:56:41.422209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '75482ea7-bb6a-42ed-b08c-d0c0f39816af', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BB1B13A0>]}
[0m19:56:41.816455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75482ea7-bb6a-42ed-b08c-d0c0f39816af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BB283AA0>]}
[0m19:56:42.791505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75482ea7-bb6a-42ed-b08c-d0c0f39816af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BB36CC80>]}
[0m19:56:42.791505 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 6 data tests, 1 source, 433 macros
[0m19:56:42.794560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75482ea7-bb6a-42ed-b08c-d0c0f39816af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BB2E3B30>]}
[0m19:56:42.799035 [info ] [MainThread]: 
[0m19:56:42.799035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:56:42.802042 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m19:56:42.948075 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m19:56:42.950635 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m19:56:42.950635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:43.187471 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.236 seconds
[0m19:56:43.189505 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m19:56:43.194125 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m19:56:43.196158 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m19:56:43.202116 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:56:43.209056 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:56:43.210944 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m19:56:43.210944 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m19:56:43.211979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:43.212505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:43.239555 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m19:56:43.239555 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:56:43.239555 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m19:56:43.239555 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m19:56:43.243865 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:56:43.243865 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:56:43.282735 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m19:56:43.282735 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.040 seconds
[0m19:56:43.285869 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m19:56:43.285869 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m19:56:43.285869 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m19:56:43.285869 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m19:56:43.297469 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:43.297469 [debug] [MainThread]: On master: BEGIN
[0m19:56:43.297469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:43.324018 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m19:56:43.324018 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:43.324018 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:56:43.344019 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m19:56:43.347726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75482ea7-bb6a-42ed-b08c-d0c0f39816af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BB283FE0>]}
[0m19:56:43.347726 [debug] [MainThread]: On master: ROLLBACK
[0m19:56:43.347726 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:43.347726 [debug] [MainThread]: On master: BEGIN
[0m19:56:43.351317 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:56:43.351317 [debug] [MainThread]: On master: COMMIT
[0m19:56:43.351317 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:43.354371 [debug] [MainThread]: On master: COMMIT
[0m19:56:43.355892 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:56:43.355892 [debug] [MainThread]: On master: Close
[0m19:56:43.355892 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:56:43.358007 [info ] [MainThread]: 
[0m19:56:43.365771 [debug] [Thread-1 (]: Began running node model.attribution_dbt.mart_kpis
[0m19:56:43.365771 [debug] [Thread-2 (]: Began running node model.attribution_dbt.mart_revenue_monthly
[0m19:56:43.365771 [info ] [Thread-1 (]: 1 of 2 START sql table model public.mart_kpis .................................. [RUN]
[0m19:56:43.365771 [info ] [Thread-2 (]: 2 of 2 START sql table model public.mart_revenue_monthly ....................... [RUN]
[0m19:56:43.371941 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_kpis'
[0m19:56:43.371941 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_monthly'
[0m19:56:43.375684 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.mart_kpis
[0m19:56:43.375684 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.mart_revenue_monthly
[0m19:56:43.385976 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.mart_kpis"
[0m19:56:43.390634 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_monthly"
[0m19:56:43.390634 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.mart_kpis
[0m19:56:43.420047 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.mart_revenue_monthly
[0m19:56:43.437967 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.mart_kpis"
[0m19:56:43.442700 [debug] [Thread-2 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_monthly"
[0m19:56:43.442700 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m19:56:43.442700 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: BEGIN
[0m19:56:43.442700 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m19:56:43.448396 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:56:43.448396 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: BEGIN
[0m19:56:43.448396 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:43.483949 [debug] [Thread-2 (]: SQL status: BEGIN in 0.036 seconds
[0m19:56:43.483949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m19:56:43.483949 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m19:56:43.485977 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m19:56:43.485977 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_monthly"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_monthly__dbt_tmp"
  
  
    as
  
  (
    select
  date_trunc('month', order_date)::date as month,
  channel,
  sum(amount) as revenue
from "attrib_analytics"."public"."stg_orders"
group by 1,2
  );
  
[0m19:56:43.485977 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_kpis"} */

  
    

  create  table "attrib_analytics"."public"."mart_kpis__dbt_tmp"
  
  
    as
  
  (
    with base as (
  select order_date, amount from "attrib_analytics"."public"."stg_orders"
),
agg as (
  select
    current_date as as_of,
    count(*)                          as orders_total,
    sum(amount)                       as revenue_total,
    sum(case when order_date >= current_date - interval '7 day' then amount end) as revenue_last_7d,
    sum(case when date_trunc('month', order_date) = date_trunc('month', current_date) then amount end) as revenue_mtd
  from base
)
select * from agg
  );
  
[0m19:56:43.536405 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.049 seconds
[0m19:56:43.547041 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.059 seconds
[0m19:56:43.553445 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m19:56:43.559210 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m19:56:43.559210 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_monthly"} */
alter table "attrib_analytics"."public"."mart_revenue_monthly__dbt_tmp" rename to "mart_revenue_monthly"
[0m19:56:43.559210 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_kpis"} */
alter table "attrib_analytics"."public"."mart_kpis__dbt_tmp" rename to "mart_kpis"
[0m19:56:43.564369 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m19:56:43.566449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m19:56:43.585109 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: COMMIT
[0m19:56:43.590134 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: COMMIT
[0m19:56:43.590134 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m19:56:43.590134 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m19:56:43.590134 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: COMMIT
[0m19:56:43.590134 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: COMMIT
[0m19:56:43.600162 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m19:56:43.601289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m19:56:43.608739 [debug] [Thread-2 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_monthly__dbt_backup"
[0m19:56:43.612783 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public"."mart_kpis__dbt_backup"
[0m19:56:43.620006 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m19:56:43.621867 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m19:56:43.622444 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_monthly"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_monthly__dbt_backup" cascade
[0m19:56:43.622967 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_kpis"} */
drop table if exists "attrib_analytics"."public"."mart_kpis__dbt_backup" cascade
[0m19:56:43.626431 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:56:43.627445 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:56:43.630501 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: Close
[0m19:56:43.632202 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: Close
[0m19:56:43.635270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75482ea7-bb6a-42ed-b08c-d0c0f39816af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BB88E390>]}
[0m19:56:43.636378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75482ea7-bb6a-42ed-b08c-d0c0f39816af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BB2E3BC0>]}
[0m19:56:43.638004 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.mart_revenue_monthly .................. [[32mSELECT 3[0m in 0.26s]
[0m19:56:43.642027 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.mart_revenue_monthly
[0m19:56:43.638004 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.mart_kpis ............................. [[32mSELECT 1[0m in 0.27s]
[0m19:56:43.644813 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.mart_kpis
[0m19:56:43.646928 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:43.648396 [debug] [MainThread]: On master: BEGIN
[0m19:56:43.648906 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:43.670236 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m19:56:43.670236 [debug] [MainThread]: On master: COMMIT
[0m19:56:43.672244 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:43.672244 [debug] [MainThread]: On master: COMMIT
[0m19:56:43.674408 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:56:43.674952 [debug] [MainThread]: On master: Close
[0m19:56:43.675966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:43.677417 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m19:56:43.677978 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m19:56:43.678530 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m19:56:43.679060 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_kpis' was properly closed.
[0m19:56:43.679602 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_monthly' was properly closed.
[0m19:56:43.680261 [info ] [MainThread]: 
[0m19:56:43.681647 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m19:56:43.684739 [debug] [MainThread]: Command end result
[0m19:56:43.749775 [info ] [MainThread]: 
[0m19:56:43.752571 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:43.754393 [info ] [MainThread]: 
[0m19:56:43.756750 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:56:43.759259 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:43.759259 after 4.47 seconds
[0m19:56:43.762795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B872A2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B872A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B948B140>]}
[0m19:56:43.764537 [debug] [MainThread]: Flushing usage events
[0m19:56:54.928638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7F9FB9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FCB3FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FCB3FD10>]}


============================== 19:56:54.934855 | d0ab4e8b-9239-4068-937b-f33f3fb7c3fd ==============================
[0m19:56:54.934855 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:56:54.936861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select mart_revenue_monthly mart_kpis', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:56:55.202443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0ab4e8b-9239-4068-937b-f33f3fb7c3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FE224350>]}
[0m19:56:55.298478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0ab4e8b-9239-4068-937b-f33f3fb7c3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FC8221E0>]}
[0m19:56:55.301518 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:56:55.970399 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:56:56.447726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:56.448245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:56.555062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0ab4e8b-9239-4068-937b-f33f3fb7c3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FE45C230>]}
[0m19:56:56.930274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0ab4e8b-9239-4068-937b-f33f3fb7c3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FE7B5160>]}
[0m19:56:56.933069 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 6 data tests, 1 source, 433 macros
[0m19:56:56.934581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ab4e8b-9239-4068-937b-f33f3fb7c3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FE45D6D0>]}
[0m19:56:56.936700 [info ] [MainThread]: 
[0m19:56:56.939228 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:56:56.947847 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m19:56:56.951297 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m19:56:57.060480 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:56:57.063573 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:56:57.064004 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m19:56:57.064004 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m19:56:57.064004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:57.064004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:57.266612 [debug] [ThreadPool]: SQL status: BEGIN in 0.202 seconds
[0m19:56:57.270684 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m19:56:57.270684 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m19:56:57.277913 [debug] [ThreadPool]: SQL status: BEGIN in 0.212 seconds
[0m19:56:57.277913 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m19:56:57.277913 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:56:57.277913 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:56:57.282329 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m19:56:57.282329 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m19:56:57.285458 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m19:56:57.285458 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m19:56:57.285458 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m19:56:57.298268 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:57.298268 [debug] [MainThread]: On master: BEGIN
[0m19:56:57.298268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:57.522580 [debug] [MainThread]: SQL status: BEGIN in 0.225 seconds
[0m19:56:57.524886 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:57.525899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:56:57.532148 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:56:57.532148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ab4e8b-9239-4068-937b-f33f3fb7c3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FE7B59A0>]}
[0m19:56:57.532148 [debug] [MainThread]: On master: ROLLBACK
[0m19:56:57.532148 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:57.538271 [debug] [MainThread]: On master: BEGIN
[0m19:56:57.538271 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:56:57.538271 [debug] [MainThread]: On master: COMMIT
[0m19:56:57.538271 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:57.538271 [debug] [MainThread]: On master: COMMIT
[0m19:56:57.542694 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:56:57.542694 [debug] [MainThread]: On master: Close
[0m19:56:57.542694 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:56:57.545332 [info ] [MainThread]: 
[0m19:56:57.552963 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m19:56:57.552963 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m19:56:57.554573 [info ] [Thread-1 (]: 1 of 2 START test not_null_mart_kpis_as_of ..................................... [RUN]
[0m19:56:57.554573 [info ] [Thread-2 (]: 2 of 2 START test not_null_mart_revenue_monthly_month .......................... [RUN]
[0m19:56:57.554573 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516'
[0m19:56:57.554573 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61'
[0m19:56:57.554573 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m19:56:57.554573 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m19:56:57.579110 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"
[0m19:56:57.586633 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"
[0m19:56:57.666449 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m19:56:57.677986 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m19:56:57.714300 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"
[0m19:56:57.721735 [debug] [Thread-2 (]: Writing runtime sql for node "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"
[0m19:56:57.894815 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"
[0m19:56:57.894815 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516: BEGIN
[0m19:56:57.894815 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:57.899237 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"
[0m19:56:57.901417 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61: BEGIN
[0m19:56:57.901417 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:56:57.926729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m19:56:57.926729 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"
[0m19:56:57.926729 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select as_of
from "attrib_analytics"."public"."mart_kpis"
where as_of is null



  
  
      
    ) dbt_internal_test
[0m19:56:57.942996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m19:56:57.947851 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516: ROLLBACK
[0m19:56:57.947851 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516: Close
[0m19:56:57.953257 [info ] [Thread-1 (]: 1 of 2 PASS not_null_mart_kpis_as_of ........................................... [[32mPASS[0m in 0.40s]
[0m19:56:57.954524 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m19:56:58.036334 [debug] [Thread-2 (]: SQL status: BEGIN in 0.136 seconds
[0m19:56:58.038889 [debug] [Thread-2 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"
[0m19:56:58.038889 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "attrib_analytics"."public"."mart_revenue_monthly"
where month is null



  
  
      
    ) dbt_internal_test
[0m19:56:58.043071 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:56:58.043071 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61: ROLLBACK
[0m19:56:58.043071 [debug] [Thread-2 (]: On test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61: Close
[0m19:56:58.049170 [info ] [Thread-2 (]: 2 of 2 PASS not_null_mart_revenue_monthly_month ................................ [[32mPASS[0m in 0.49s]
[0m19:56:58.050674 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m19:56:58.053568 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:58.053568 [debug] [MainThread]: On master: BEGIN
[0m19:56:58.055257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:58.106911 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m19:56:58.106911 [debug] [MainThread]: On master: COMMIT
[0m19:56:58.106911 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:58.112719 [debug] [MainThread]: On master: COMMIT
[0m19:56:58.114307 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:56:58.114307 [debug] [MainThread]: On master: Close
[0m19:56:58.114307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:58.114307 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m19:56:58.114307 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m19:56:58.114307 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516' was properly closed.
[0m19:56:58.114307 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61' was properly closed.
[0m19:56:58.118024 [info ] [MainThread]: 
[0m19:56:58.118024 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m19:56:58.118024 [debug] [MainThread]: Command end result
[0m19:56:58.242575 [info ] [MainThread]: 
[0m19:56:58.242575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:58.242575 [info ] [MainThread]: 
[0m19:56:58.248175 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:56:58.251244 [debug] [MainThread]: Command `dbt test` succeeded at 19:56:58.251244 after 3.60 seconds
[0m19:56:58.251244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FCBBCB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FCBBC740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FCBBFC80>]}
[0m19:56:58.251244 [debug] [MainThread]: Flushing usage events
[0m20:14:24.000375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ABDFBD7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ABA444D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ABDFBD880>]}


============================== 20:14:24.010865 | 2e22c096-d364-4c73-bdbc-3e028a37c508 ==============================
[0m20:14:24.010865 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:14:24.012855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:14:24.419649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e22c096-d364-4c73-bdbc-3e028a37c508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ABBC41E50>]}
[0m20:14:24.522335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e22c096-d364-4c73-bdbc-3e028a37c508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ABE23E540>]}
[0m20:14:24.526327 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:14:25.090776 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:14:25.433827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:14:25.433827 [debug] [MainThread]: Partial parsing: added file: attribution_dbt://models\exposures.yml
[0m20:14:25.472169 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid exposures config given in FilePath(searched_path='models', relative_path='exposures.yml', modification_time=1762222432.6748204, project_root='C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt') @ exposures: {'name': 'attribution_dashboard_v1', 'type': 'dashboard', 'maturity': 'low', 'url': 'http://localhost:3000/dashboard/2-attribution-os-overview-seed?channel=&order_date=', 'description': 'Dashboard de orders, revenue diario y mensual.', 'owners': [{'name': 'Rafael Ruiz', 'email': 'rafartejadasegura@gmail.com'}], 'depends_on': ["ref('mart_revenue_daily')", "ref('mart_revenue_monthly')", "ref('mart_kpis')", "ref('stg_orders')"]} - at path []: Additional properties are not allowed ('owners' was unexpected)
[0m20:14:25.475370 [debug] [MainThread]: Command `dbt docs generate` failed at 20:14:25.474843 after 1.88 seconds
[0m20:14:25.476497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ABDFBD7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ABFA4B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ABF6D80E0>]}
[0m20:14:25.477552 [debug] [MainThread]: Flushing usage events
[0m20:18:09.311587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727A120980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727A5161B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727A6AB5C0>]}


============================== 20:18:09.321466 | 07f38767-1866-44ae-b796-8cc99b5c6bc8 ==============================
[0m20:18:09.321466 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:18:09.321466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ls --resource-type model -s stg_orders mart_revenue_daily mart_revenue_monthly mart_kpis', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:18:09.757711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07f38767-1866-44ae-b796-8cc99b5c6bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727BF29730>]}
[0m20:18:09.874614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07f38767-1866-44ae-b796-8cc99b5c6bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017279CAC8F0>]}
[0m20:18:09.881265 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:18:10.559762 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:18:10.896004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:18:10.899918 [debug] [MainThread]: Partial parsing: added file: attribution_dbt://models\exposures.yml
[0m20:18:11.112053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07f38767-1866-44ae-b796-8cc99b5c6bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727C359EB0>]}
[0m20:18:11.352777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07f38767-1866-44ae-b796-8cc99b5c6bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727C6B3380>]}
[0m20:18:11.352777 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 6 data tests, 1 source, 1 exposure, 433 macros
[0m20:18:11.355719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f38767-1866-44ae-b796-8cc99b5c6bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727C00F590>]}
[0m20:18:11.358869 [debug] [MainThread]: Command `dbt ls` succeeded at 20:18:11.358869 after 2.38 seconds
[0m20:18:11.360399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727A0B1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727A7EB470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727A7EBB00>]}
[0m20:18:11.360399 [debug] [MainThread]: Flushing usage events
[0m20:18:47.718060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191637AE0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191635A7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019163C9DD60>]}


============================== 20:18:47.728613 | d35654f2-c2b9-4d1e-83b5-aee8e4a063da ==============================
[0m20:18:47.728613 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:18:47.729700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:18:48.056470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd35654f2-c2b9-4d1e-83b5-aee8e4a063da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001916553DC40>]}
[0m20:18:48.135034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd35654f2-c2b9-4d1e-83b5-aee8e4a063da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001916558CDD0>]}
[0m20:18:48.136672 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:18:48.514183 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:18:48.960869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:18:48.961899 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\exposures.yml
[0m20:18:49.005529 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid exposures config given in FilePath(searched_path='models', relative_path='exposures.yml', modification_time=1762222562.4156146, project_root='C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt') @ exposures: {'name': 'attribution_dashboard_v1', 'type': 'dashboard', 'maturity': 'low', 'url': 'http://localhost:3000/dashboard/2-attribution-os-overview-seed?channel=&order_date=', 'description': 'Dashboard de orders, revenue diario y mensual.', 'owner': [{'name': 'Rafael Ruiz', 'email': 'rafartejadasegura@gmail.com'}], 'depends_on': ["ref('mart_revenue_daily')", "ref('mart_revenue_monthly')", "ref('mart_kpis')", "ref('stg_orders')"]} - at path ['owner']: [{'name': 'Rafael Ruiz', 'email': 'rafartejadasegura@gmail.com'}] is not of type 'object'
[0m20:18:49.009111 [debug] [MainThread]: Command `dbt docs generate` failed at 20:18:49.008099 after 1.55 seconds
[0m20:18:49.009111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191640D3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019163266A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019163BFEF30>]}
[0m20:18:49.010749 [debug] [MainThread]: Flushing usage events
[0m20:26:22.727962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E30D8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E30D8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E30D8B00>]}


============================== 20:26:22.736250 | b9bfe310-138a-43ea-9b20-e1a24d8f497d ==============================
[0m20:26:22.736250 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:26:22.736250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls -s stg_orders mart_revenue_daily mart_revenue_monthly mart_kpis', 'send_anonymous_usage_stats': 'True'}
[0m20:26:23.387682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9bfe310-138a-43ea-9b20-e1a24d8f497d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E45F3B30>]}
[0m20:26:23.569079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9bfe310-138a-43ea-9b20-e1a24d8f497d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E45CE990>]}
[0m20:26:23.574959 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:26:24.487374 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:26:25.067180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:26:25.068814 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\exposures.yml
[0m20:26:25.380671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9bfe310-138a-43ea-9b20-e1a24d8f497d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E4A82E40>]}
[0m20:26:25.607407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9bfe310-138a-43ea-9b20-e1a24d8f497d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E4DABE30>]}
[0m20:26:25.607407 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 6 data tests, 1 source, 1 exposure, 433 macros
[0m20:26:25.613524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9bfe310-138a-43ea-9b20-e1a24d8f497d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E4A5B7D0>]}
[0m20:26:25.618340 [debug] [MainThread]: Command `dbt ls` succeeded at 20:26:25.618340 after 3.16 seconds
[0m20:26:25.618340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E30D87A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E49C24B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E2F18080>]}
[0m20:26:25.618340 [debug] [MainThread]: Flushing usage events
[0m20:31:07.501683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9206C380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB92244890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB91F66660>]}


============================== 20:31:07.513547 | 7a45f6fe-889f-42cd-b337-29c6f368ce4d ==============================
[0m20:31:07.513547 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:31:07.515214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:31:08.011713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a45f6fe-889f-42cd-b337-29c6f368ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB937C3EF0>]}
[0m20:31:08.142242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a45f6fe-889f-42cd-b337-29c6f368ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9161C770>]}
[0m20:31:08.144278 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:31:09.043990 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:31:09.462564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:31:09.462564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:31:09.581729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a45f6fe-889f-42cd-b337-29c6f368ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB93A011C0>]}
[0m20:31:09.647531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a45f6fe-889f-42cd-b337-29c6f368ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB93C4DCD0>]}
[0m20:31:09.649502 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 6 data tests, 1 source, 1 exposure, 433 macros
[0m20:31:09.650739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a45f6fe-889f-42cd-b337-29c6f368ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB938DB6E0>]}
[0m20:31:09.654992 [info ] [MainThread]: 
[0m20:31:09.656780 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:31:09.670209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m20:31:09.670812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m20:31:09.833776 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m20:31:09.834754 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m20:31:09.835354 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m20:31:09.836362 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m20:31:09.836801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:09.837862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:09.932792 [debug] [ThreadPool]: SQL status: BEGIN in 0.096 seconds
[0m20:31:09.932792 [debug] [ThreadPool]: SQL status: BEGIN in 0.096 seconds
[0m20:31:09.934874 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m20:31:09.935591 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m20:31:09.936126 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:31:09.936126 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m20:31:09.946568 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m20:31:09.946568 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m20:31:09.949113 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m20:31:09.950112 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m20:31:09.952226 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m20:31:09.952785 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m20:31:09.961261 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:09.962237 [debug] [MainThread]: On master: BEGIN
[0m20:31:09.962237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:31:09.991377 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m20:31:09.991377 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:09.992464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:31:10.010400 [debug] [MainThread]: SQL status: SELECT 1 in 0.018 seconds
[0m20:31:10.012271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a45f6fe-889f-42cd-b337-29c6f368ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB93AF3860>]}
[0m20:31:10.013272 [debug] [MainThread]: On master: ROLLBACK
[0m20:31:10.014453 [debug] [MainThread]: On master: Close
[0m20:31:10.015508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:31:10.016461 [info ] [MainThread]: 
[0m20:31:10.022507 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m20:31:10.023462 [debug] [Thread-2 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m20:31:10.024416 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m20:31:10.025417 [debug] [Thread-2 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m20:31:10.025417 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m20:31:10.026421 [debug] [Thread-2 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m20:31:10.038630 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m20:31:10.042832 [debug] [Thread-2 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m20:31:10.043864 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m20:31:10.044847 [debug] [Thread-2 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m20:31:10.045835 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_orders
[0m20:31:10.046841 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m20:31:10.046841 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_orders
[0m20:31:10.052369 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m20:31:10.054674 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_orders
[0m20:31:10.056795 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_orders
[0m20:31:10.058379 [debug] [Thread-1 (]: Began running node model.attribution_dbt.mart_kpis
[0m20:31:10.059072 [debug] [Thread-2 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m20:31:10.060135 [debug] [Thread-3 (]: Began running node model.attribution_dbt.mart_revenue_monthly
[0m20:31:10.061060 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m20:31:10.063367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.attribution_dbt.orders_seed, now model.attribution_dbt.mart_kpis)
[0m20:31:10.064768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.attribution_dbt.orders_snapshot, now model.attribution_dbt.mart_revenue_daily)
[0m20:31:10.065848 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_monthly'
[0m20:31:10.067405 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_orders, now test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:31:10.069618 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.mart_kpis
[0m20:31:10.071788 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m20:31:10.074063 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.mart_revenue_monthly
[0m20:31:10.075065 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m20:31:10.080143 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.mart_kpis"
[0m20:31:10.094330 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m20:31:10.098590 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_monthly"
[0m20:31:10.126418 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:31:10.128580 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m20:31:10.130611 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.mart_kpis
[0m20:31:10.131621 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m20:31:10.133489 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m20:31:10.135330 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.mart_kpis
[0m20:31:10.136681 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.mart_revenue_monthly
[0m20:31:10.139265 [debug] [Thread-4 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m20:31:10.142326 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m20:31:10.143589 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m20:31:10.144687 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.mart_revenue_monthly
[0m20:31:10.146204 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m20:31:10.147910 [debug] [Thread-2 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m20:31:10.148890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_kpis, now test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516)
[0m20:31:10.149555 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m20:31:10.150077 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m20:31:10.151518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_revenue_daily, now test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f)
[0m20:31:10.152885 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m20:31:10.154339 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_revenue_monthly, now test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097)
[0m20:31:10.168676 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m20:31:10.169727 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m20:31:10.177522 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"
[0m20:31:10.178567 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m20:31:10.199441 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m20:31:10.200947 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m20:31:10.208624 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m20:31:10.211201 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m20:31:10.212817 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m20:31:10.214825 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m20:31:10.214825 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m20:31:10.216829 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m20:31:10.218068 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a, now test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61)
[0m20:31:10.219836 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m20:31:10.220952 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m20:31:10.222141 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m20:31:10.224781 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m20:31:10.233349 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"
[0m20:31:10.237092 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m20:31:10.238748 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m20:31:10.240773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:10.241966 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m20:31:10.241966 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m20:31:10.243478 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516' was properly closed.
[0m20:31:10.243478 [debug] [MainThread]: Connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f' was properly closed.
[0m20:31:10.244105 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61' was properly closed.
[0m20:31:10.245112 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097' was properly closed.
[0m20:31:10.248783 [debug] [MainThread]: Command end result
[0m20:31:11.369818 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m20:31:11.371067 [info ] [MainThread]: Building catalog
[0m20:31:11.386065 [debug] [ThreadPool]: Acquiring new postgres connection 'attrib_analytics.information_schema'
[0m20:31:11.394572 [debug] [ThreadPool]: Using postgres connection "attrib_analytics.information_schema"
[0m20:31:11.394572 [debug] [ThreadPool]: On attrib_analytics.information_schema: BEGIN
[0m20:31:11.394572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:11.426850 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m20:31:11.434753 [debug] [ThreadPool]: Using postgres connection "attrib_analytics.information_schema"
[0m20:31:11.436260 [debug] [ThreadPool]: On attrib_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "attrib_analytics.information_schema"} */

    
    

    select
        'attrib_analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_kpis')) or (upper(sch.nspname) = upper('public_') and
           upper(tbl.relname) = upper('orders_snapshot')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders_seed')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_revenue_daily')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_revenue_monthly')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m20:31:11.446810 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.010 seconds
[0m20:31:11.452482 [debug] [ThreadPool]: On attrib_analytics.information_schema: ROLLBACK
[0m20:31:11.454049 [debug] [ThreadPool]: On attrib_analytics.information_schema: Close
[0m20:31:11.510473 [info ] [MainThread]: Catalog written to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\catalog.json
[0m20:31:11.514567 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:31:11.513593 after 4.35 seconds
[0m20:31:11.515574 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:31:11.516554 [debug] [MainThread]: Connection 'attrib_analytics.information_schema' was properly closed.
[0m20:31:11.517269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9236FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB8F5D9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB92244890>]}
[0m20:31:11.518279 [debug] [MainThread]: Flushing usage events
[0m20:31:15.988007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F136D8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F162E3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F162E3C80>]}


============================== 20:31:15.988007 | 0513a8aa-f8ff-47f3-af92-30411e41ce0d ==============================
[0m20:31:15.988007 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:31:15.997324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8088', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:31:16.168592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0513a8aa-f8ff-47f3-af92-30411e41ce0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F1795ACF0>]}
[0m20:31:16.218331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0513a8aa-f8ff-47f3-af92-30411e41ce0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F162FD7C0>]}
[0m20:44:07.163919 [error] [MainThread]: Encountered an error:

[0m20:44:07.498134 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\danie\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m20:44:07.541075 [debug] [MainThread]: Command `dbt docs serve` failed at 20:44:07.535252 after 771.70 seconds
[0m20:44:07.561256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F136D8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F179E5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F179E54F0>]}
[0m20:44:07.584866 [debug] [MainThread]: Flushing usage events
[0m20:44:16.386469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020730BE4BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020730BE47D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020730BE6FF0>]}


============================== 20:44:16.393656 | 0af159d9-eadd-4182-9853-fb6fb52dcc57 ==============================
[0m20:44:16.393656 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:44:16.393656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:44:16.689834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0af159d9-eadd-4182-9853-fb6fb52dcc57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020730D49550>]}
[0m20:44:16.745735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0af159d9-eadd-4182-9853-fb6fb52dcc57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002073117D9D0>]}
[0m20:44:16.745735 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:44:17.134854 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:44:17.407470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:44:17.409793 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\schema.yml
[0m20:44:17.796270 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:44:17.797392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0af159d9-eadd-4182-9853-fb6fb52dcc57', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020732627350>]}
[0m20:44:18.246814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0af159d9-eadd-4182-9853-fb6fb52dcc57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002073279A1E0>]}
[0m20:44:18.907850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0af159d9-eadd-4182-9853-fb6fb52dcc57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020732A2C350>]}
[0m20:44:18.910455 [info ] [MainThread]: Found 1 seed, 4 models, 1 snapshot, 6 data tests, 1 source, 1 exposure, 433 macros
[0m20:44:18.910982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af159d9-eadd-4182-9853-fb6fb52dcc57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207323C7EC0>]}
[0m20:44:18.910982 [info ] [MainThread]: 
[0m20:44:18.910982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:44:18.918911 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m20:44:18.932342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m20:44:19.029231 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m20:44:19.029231 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m20:44:19.029231 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m20:44:19.029231 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m20:44:19.029231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:19.034300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:19.126903 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m20:44:19.134633 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m20:44:19.134633 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m20:44:19.134633 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m20:44:19.134633 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m20:44:19.134633 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:44:19.182716 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.047 seconds
[0m20:44:19.182716 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.047 seconds
[0m20:44:19.186122 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m20:44:19.186122 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m20:44:19.188658 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m20:44:19.188658 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m20:44:19.196729 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:19.196729 [debug] [MainThread]: On master: BEGIN
[0m20:44:19.198238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:19.229498 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m20:44:19.229498 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:19.230516 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:44:19.253676 [debug] [MainThread]: SQL status: SELECT 1 in 0.022 seconds
[0m20:44:19.255315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af159d9-eadd-4182-9853-fb6fb52dcc57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072E54CD70>]}
[0m20:44:19.255854 [debug] [MainThread]: On master: ROLLBACK
[0m20:44:19.256935 [debug] [MainThread]: On master: Close
[0m20:44:19.257986 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:44:19.258541 [info ] [MainThread]: 
[0m20:44:19.265141 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m20:44:19.265141 [debug] [Thread-2 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m20:44:19.268031 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m20:44:19.268031 [debug] [Thread-2 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m20:44:19.268031 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m20:44:19.270327 [debug] [Thread-2 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m20:44:19.278716 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m20:44:19.281320 [debug] [Thread-2 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m20:44:19.284354 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m20:44:19.284354 [debug] [Thread-2 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m20:44:19.284354 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_orders
[0m20:44:19.284354 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m20:44:19.284354 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_orders
[0m20:44:19.288828 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m20:44:19.290836 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_orders
[0m20:44:19.290836 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_orders
[0m20:44:19.290836 [debug] [Thread-1 (]: Began running node model.attribution_dbt.mart_kpis
[0m20:44:19.294818 [debug] [Thread-3 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m20:44:19.294818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.attribution_dbt.orders_seed, now model.attribution_dbt.mart_kpis)
[0m20:44:19.294818 [debug] [Thread-2 (]: Began running node model.attribution_dbt.mart_revenue_monthly
[0m20:44:19.296569 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m20:44:19.297193 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_daily'
[0m20:44:19.297193 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.mart_kpis
[0m20:44:19.297193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.attribution_dbt.orders_snapshot, now model.attribution_dbt.mart_revenue_monthly)
[0m20:44:19.299899 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_orders, now test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:44:19.300420 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m20:44:19.301436 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.mart_kpis"
[0m20:44:19.301436 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.mart_revenue_monthly
[0m20:44:19.301436 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m20:44:19.301436 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m20:44:19.301436 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_monthly"
[0m20:44:19.316194 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:44:19.316194 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.mart_kpis
[0m20:44:19.316194 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.mart_kpis
[0m20:44:19.316194 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.mart_revenue_monthly
[0m20:44:19.316194 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m20:44:19.316194 [debug] [Thread-1 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m20:44:19.322552 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.mart_revenue_monthly
[0m20:44:19.322552 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m20:44:19.322552 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m20:44:19.322552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_kpis, now test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m20:44:19.322552 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m20:44:19.326788 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m20:44:19.326788 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m20:44:19.326788 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m20:44:19.328309 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_revenue_monthly, now test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516)
[0m20:44:19.328884 [debug] [Thread-4 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m20:44:19.328884 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_revenue_daily, now test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61)
[0m20:44:19.332995 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m20:44:19.332995 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m20:44:19.332995 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f)
[0m20:44:19.332995 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m20:44:19.342927 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"
[0m20:44:19.343444 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m20:44:19.344182 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m20:44:19.348059 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"
[0m20:44:19.348059 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m20:44:19.353856 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m20:44:19.353856 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m20:44:19.353856 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m20:44:19.353856 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m20:44:19.359233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a, now test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097)
[0m20:44:19.359233 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m20:44:19.359233 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m20:44:19.359233 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m20:44:19.359233 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m20:44:19.364035 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m20:44:19.364035 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m20:44:19.368705 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m20:44:19.368705 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m20:44:19.368705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:19.368705 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m20:44:19.368705 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m20:44:19.368705 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097' was properly closed.
[0m20:44:19.368705 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516' was properly closed.
[0m20:44:19.368705 [debug] [MainThread]: Connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f' was properly closed.
[0m20:44:19.368705 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61' was properly closed.
[0m20:44:19.375525 [debug] [MainThread]: Command end result
[0m20:44:19.572381 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m20:44:19.572381 [info ] [MainThread]: Building catalog
[0m20:44:19.582822 [debug] [ThreadPool]: Acquiring new postgres connection 'attrib_analytics.information_schema'
[0m20:44:19.591928 [debug] [ThreadPool]: Using postgres connection "attrib_analytics.information_schema"
[0m20:44:19.591928 [debug] [ThreadPool]: On attrib_analytics.information_schema: BEGIN
[0m20:44:19.591928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:19.622716 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m20:44:19.622716 [debug] [ThreadPool]: Using postgres connection "attrib_analytics.information_schema"
[0m20:44:19.622716 [debug] [ThreadPool]: On attrib_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "attrib_analytics.information_schema"} */

    
    

    select
        'attrib_analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_revenue_monthly')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_revenue_daily')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders_seed')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public_') and
           upper(tbl.relname) = upper('orders_snapshot')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_kpis')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m20:44:19.653559 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.029 seconds
[0m20:44:19.657723 [debug] [ThreadPool]: On attrib_analytics.information_schema: ROLLBACK
[0m20:44:19.657723 [debug] [ThreadPool]: On attrib_analytics.information_schema: Close
[0m20:44:19.702789 [info ] [MainThread]: Catalog written to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\catalog.json
[0m20:44:19.704798 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:44:19.704798 after 3.58 seconds
[0m20:44:19.704798 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:44:19.704798 [debug] [MainThread]: Connection 'attrib_analytics.information_schema' was properly closed.
[0m20:44:19.704798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020730BA16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020732805280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020732806DE0>]}
[0m20:44:19.704798 [debug] [MainThread]: Flushing usage events
[0m20:44:23.470728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280232AF0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802652FCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802652FA40>]}


============================== 20:44:23.476083 | fe553d76-ce27-4709-a7d7-bcf5330ab956 ==============================
[0m20:44:23.476083 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:44:23.478102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:44:23.646836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe553d76-ce27-4709-a7d7-bcf5330ab956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028026517680>]}
[0m20:44:23.700333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe553d76-ce27-4709-a7d7-bcf5330ab956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028026F98B00>]}
[0m20:52:31.985483 [error] [MainThread]: Encountered an error:

[0m20:52:32.114127 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\danie\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m20:52:32.134778 [debug] [MainThread]: Command `dbt docs serve` failed at 20:52:32.131261 after 488.87 seconds
[0m20:52:32.137892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028026EE5D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028028632AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028028534470>]}
[0m20:52:32.148057 [debug] [MainThread]: Flushing usage events
[0m20:54:26.849003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B244059B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24386A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B243868E60>]}


============================== 20:54:27.169096 | f0d8644b-b392-448a-b4de-ebf94627846f ==============================
[0m20:54:27.169096 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:54:27.169096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select mart_revenue_monthly mart_kpis', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:54:28.231067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0d8644b-b392-448a-b4de-ebf94627846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2458C34D0>]}
[0m20:54:28.298241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0d8644b-b392-448a-b4de-ebf94627846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2458E9C40>]}
[0m20:54:28.299753 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:54:28.727652 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:54:29.076187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:54:29.076187 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\marts\mart_kpis.sql
[0m20:54:29.076187 [debug] [MainThread]: Partial parsing: updated file: attribution_dbt://models\marts\mart_revenue_monthly.sql
[0m20:54:29.344342 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:54:29.344342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f0d8644b-b392-448a-b4de-ebf94627846f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2459D7E00>]}
[0m20:54:29.592281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0d8644b-b392-448a-b4de-ebf94627846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B245D3F740>]}
[0m20:54:31.168493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0d8644b-b392-448a-b4de-ebf94627846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B245FAE150>]}
[0m20:54:31.169654 [info ] [MainThread]: Found 1 seed, 4 models, 1 snapshot, 6 data tests, 1 source, 1 exposure, 433 macros
[0m20:54:31.171163 [info ] [MainThread]: 
[0m20:54:31.171163 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:54:31.179818 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m20:54:31.351790 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m20:54:31.355760 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m20:54:31.355760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:31.552485 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.198 seconds
[0m20:54:31.552485 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m20:54:31.559649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m20:54:31.559649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m20:54:31.563968 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m20:54:31.563968 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m20:54:31.563968 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m20:54:31.563968 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m20:54:31.573322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:31.573322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:31.599816 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m20:54:31.600552 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m20:54:31.601623 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:54:31.606510 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m20:54:31.608207 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m20:54:31.608600 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m20:54:31.638734 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.037 seconds
[0m20:54:31.640883 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m20:54:31.643031 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m20:54:31.649037 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.040 seconds
[0m20:54:31.651190 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m20:54:31.653597 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m20:54:31.666665 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:31.667183 [debug] [MainThread]: On master: BEGIN
[0m20:54:31.668259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:31.687393 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m20:54:31.688940 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:31.688940 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:54:31.711321 [debug] [MainThread]: SQL status: SELECT 1 in 0.021 seconds
[0m20:54:31.714462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0d8644b-b392-448a-b4de-ebf94627846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B245E4F470>]}
[0m20:54:31.714462 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:31.721121 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:31.721972 [debug] [MainThread]: On master: BEGIN
[0m20:54:31.724150 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:54:31.725216 [debug] [MainThread]: On master: COMMIT
[0m20:54:31.725216 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:31.726027 [debug] [MainThread]: On master: COMMIT
[0m20:54:31.727610 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:54:31.728129 [debug] [MainThread]: On master: Close
[0m20:54:31.729697 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:54:31.730757 [info ] [MainThread]: 
[0m20:54:31.740119 [debug] [Thread-1 (]: Began running node model.attribution_dbt.mart_kpis
[0m20:54:31.741185 [debug] [Thread-2 (]: Began running node model.attribution_dbt.mart_revenue_monthly
[0m20:54:31.742271 [info ] [Thread-1 (]: 1 of 4 START sql table model public.mart_kpis .................................. [RUN]
[0m20:54:31.743338 [info ] [Thread-2 (]: 2 of 4 START sql table model public.mart_revenue_monthly ....................... [RUN]
[0m20:54:31.744938 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_kpis'
[0m20:54:31.746027 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_monthly'
[0m20:54:31.748407 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.mart_kpis
[0m20:54:31.748930 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.mart_revenue_monthly
[0m20:54:31.760535 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.mart_kpis"
[0m20:54:31.764635 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_monthly"
[0m20:54:31.767246 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.mart_kpis
[0m20:54:31.776878 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.mart_revenue_monthly
[0m20:54:31.815589 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.mart_kpis"
[0m20:54:31.819636 [debug] [Thread-2 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_monthly"
[0m20:54:31.823630 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m20:54:31.824238 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: BEGIN
[0m20:54:31.824238 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:54:31.827003 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m20:54:31.827003 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: BEGIN
[0m20:54:31.827003 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:54:31.855473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m20:54:31.856517 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m20:54:31.856517 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m20:54:31.856517 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_kpis"} */

  
    

  create  table "attrib_analytics"."public"."mart_kpis__dbt_tmp"
  
  
    as
  
  (
    with base as (
  select * from "attrib_analytics"."public"."stg_orders"
)
select
  now()                                                          as as_of,
  count(*)                                                       as orders_count,
  sum(amount)                                                    as revenue_total,
  case when count(*) > 0 then sum(amount)::numeric / count(*) else 0 end as aov,
  count(distinct channel)                                        as channels_count
from base;
  );
  
[0m20:54:31.856517 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m20:54:31.856517 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_monthly"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_monthly__dbt_tmp"
  
  
    as
  
  (
    with daily as (
  select order_date, channel, amount
  from "attrib_analytics"."public"."stg_orders"
)
select
  date_trunc('month', order_date)::date                          as month,
  sum(amount)                                                    as revenue,
  sum(case when channel='ads'    then amount else 0 end)         as revenue_ads,
  sum(case when channel='email'  then amount else 0 end)         as revenue_email,
  sum(case when channel='direct' then amount else 0 end)         as revenue_direct
from daily
group by 1
order by 1;
  );
  
[0m20:54:31.864202 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: from base;
                  ^

[0m20:54:31.864202 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24: order by 1;
                   ^

[0m20:54:31.867561 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: ROLLBACK
[0m20:54:31.868079 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: ROLLBACK
[0m20:54:31.868521 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: Close
[0m20:54:31.868521 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: Close
[0m20:54:31.884661 [debug] [Thread-2 (]: Database Error in model mart_revenue_monthly (models\marts\mart_revenue_monthly.sql)
  syntax error at or near ";"
  LINE 24: order by 1;
                     ^
  compiled code at target\run\attribution_dbt\models\marts\mart_revenue_monthly.sql
[0m20:54:31.884661 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0d8644b-b392-448a-b4de-ebf94627846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B243AD1070>]}
[0m20:54:31.888646 [debug] [Thread-1 (]: Database Error in model mart_kpis (models\marts\mart_kpis.sql)
  syntax error at or near ";"
  LINE 21: from base;
                    ^
  compiled code at target\run\attribution_dbt\models\marts\mart_kpis.sql
[0m20:54:31.884661 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model public.mart_revenue_monthly .............. [[31mERROR[0m in 0.14s]
[0m20:54:31.888646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0d8644b-b392-448a-b4de-ebf94627846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2466DFCB0>]}
[0m20:54:31.888646 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.mart_revenue_monthly
[0m20:54:31.888646 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.mart_kpis ......................... [[31mERROR[0m in 0.14s]
[0m20:54:31.888646 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m20:54:31.888646 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.mart_kpis
[0m20:54:31.888646 [info ] [Thread-4 (]: 3 of 4 SKIP test not_null_mart_revenue_monthly_month ........................... [[33mSKIP[0m]
[0m20:54:31.888646 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m20:54:31.894949 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m20:54:31.895469 [info ] [Thread-2 (]: 4 of 4 SKIP test not_null_mart_kpis_as_of ...................................... [[33mSKIP[0m]
[0m20:54:31.895469 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m20:54:31.897483 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:31.897483 [debug] [MainThread]: On master: BEGIN
[0m20:54:31.897483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:31.937168 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m20:54:31.937168 [debug] [MainThread]: On master: COMMIT
[0m20:54:31.937168 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:31.937168 [debug] [MainThread]: On master: COMMIT
[0m20:54:31.941487 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:54:31.941487 [debug] [MainThread]: On master: Close
[0m20:54:31.943505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:31.943505 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m20:54:31.943505 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m20:54:31.945525 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m20:54:31.945525 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_kpis' was properly closed.
[0m20:54:31.945525 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_monthly' was properly closed.
[0m20:54:31.947717 [info ] [MainThread]: 
[0m20:54:31.948241 [info ] [MainThread]: Finished running 2 table models, 2 data tests in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m20:54:31.950255 [debug] [MainThread]: Command end result
[0m20:54:31.981420 [info ] [MainThread]: 
[0m20:54:31.982520 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:54:31.983237 [info ] [MainThread]: 
[0m20:54:31.984821 [error] [MainThread]:   Database Error in model mart_revenue_monthly (models\marts\mart_revenue_monthly.sql)
  syntax error at or near ";"
  LINE 24: order by 1;
                     ^
  compiled code at target\run\attribution_dbt\models\marts\mart_revenue_monthly.sql
[0m20:54:31.984821 [info ] [MainThread]: 
[0m20:54:31.985939 [error] [MainThread]:   Database Error in model mart_kpis (models\marts\mart_kpis.sql)
  syntax error at or near ";"
  LINE 21: from base;
                    ^
  compiled code at target\run\attribution_dbt\models\marts\mart_kpis.sql
[0m20:54:31.986831 [info ] [MainThread]: 
[0m20:54:31.986831 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m20:54:31.987921 [debug] [MainThread]: Command `dbt build` failed at 20:54:31.987921 after 5.87 seconds
[0m20:54:31.988906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B244373F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B244373DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B243A62240>]}
[0m20:54:31.989491 [debug] [MainThread]: Flushing usage events
[0m21:38:48.953204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F7D9E870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F7204B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FAD7D880>]}


============================== 21:38:48.971824 | be09ff04-eac9-4a48-9b19-e545fef00360 ==============================
[0m21:38:48.971824 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:38:48.972887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m21:38:49.874567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be09ff04-eac9-4a48-9b19-e545fef00360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FADFC260>]}
[0m21:38:49.968702 [debug] [MainThread]: Command `dbt clean` succeeded at 21:38:49.968702 after 1.34 seconds
[0m21:38:49.968702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FA611EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FAECB740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FAEEBE30>]}
[0m21:38:49.968702 [debug] [MainThread]: Flushing usage events
[0m21:38:55.645119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0DF4E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0C040BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0E20D7F0>]}


============================== 21:38:55.646237 | 424bc997-4c0a-4cf2-be04-fcf55976b50f ==============================
[0m21:38:55.646237 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:38:55.646237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select mart_revenue_monthly mart_kpis', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:38:56.013595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '424bc997-4c0a-4cf2-be04-fcf55976b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0E3BB800>]}
[0m21:38:56.117240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '424bc997-4c0a-4cf2-be04-fcf55976b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0E19CF20>]}
[0m21:38:56.126665 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:38:56.673559 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:38:56.673559 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:38:56.678723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '424bc997-4c0a-4cf2-be04-fcf55976b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0F9A1850>]}
[0m21:38:59.029235 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:38:59.030324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '424bc997-4c0a-4cf2-be04-fcf55976b50f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0FD32960>]}
[0m21:38:59.609027 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_event_id.ca53deedfc' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m21:38:59.610357 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_web2_event_id.250b5fae02' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m21:38:59.610357 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_web2_ts.8c96d22bb6' (models\staging\schema.yml) depends on a node named 'stg_web2' which is disabled
[0m21:38:59.610357 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_mempool_txid.970361d120' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m21:38:59.615843 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_mempool_txid.7597984969' (models\staging\schema.yml) depends on a node named 'stg_chain_mempool' which is disabled
[0m21:38:59.615843 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.not_null_stg_chain_blocks_height.8729e95962' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m21:38:59.615843 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.attribution_dbt.unique_stg_chain_blocks_height.e43ea39157' (models\staging\schema.yml) depends on a node named 'stg_chain_blocks' which is disabled
[0m21:38:59.737236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '424bc997-4c0a-4cf2-be04-fcf55976b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0FBCC860>]}
[0m21:39:00.089725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '424bc997-4c0a-4cf2-be04-fcf55976b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0E359B20>]}
[0m21:39:00.089725 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 6 data tests, 1 source, 1 exposure, 433 macros
[0m21:39:00.095340 [info ] [MainThread]: 
[0m21:39:00.097361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:39:00.106444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics'
[0m21:39:00.438968 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics"
[0m21:39:00.438968 [debug] [ThreadPool]: On list_attrib_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics"} */

    select distinct nspname from pg_namespace
  
[0m21:39:00.438968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:00.786982 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.347 seconds
[0m21:39:00.786982 [debug] [ThreadPool]: On list_attrib_analytics: Close
[0m21:39:00.794891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m21:39:00.804330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m21:39:00.809546 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m21:39:00.811558 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m21:39:00.811558 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m21:39:00.811558 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m21:39:00.815759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:00.815759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:00.861824 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m21:39:00.862360 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m21:39:00.862360 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m21:39:00.881648 [debug] [ThreadPool]: SQL status: BEGIN in 0.066 seconds
[0m21:39:00.882339 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m21:39:00.882339 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:39:00.975337 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.092 seconds
[0m21:39:00.976580 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.112 seconds
[0m21:39:00.979319 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m21:39:00.982358 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m21:39:00.984346 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m21:39:00.984854 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m21:39:00.999500 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:00.999500 [debug] [MainThread]: On master: BEGIN
[0m21:39:00.999500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:39:01.026538 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m21:39:01.026538 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:01.026538 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:39:01.067635 [debug] [MainThread]: SQL status: SELECT 1 in 0.046 seconds
[0m21:39:01.077770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '424bc997-4c0a-4cf2-be04-fcf55976b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0D2690A0>]}
[0m21:39:01.079891 [debug] [MainThread]: On master: ROLLBACK
[0m21:39:01.081104 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:01.081104 [debug] [MainThread]: On master: BEGIN
[0m21:39:01.085044 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:39:01.085743 [debug] [MainThread]: On master: COMMIT
[0m21:39:01.085743 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:01.085743 [debug] [MainThread]: On master: COMMIT
[0m21:39:01.089293 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:39:01.089293 [debug] [MainThread]: On master: Close
[0m21:39:01.091325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:39:01.092838 [info ] [MainThread]: 
[0m21:39:01.110458 [debug] [Thread-1 (]: Began running node model.attribution_dbt.mart_kpis
[0m21:39:01.112488 [debug] [Thread-2 (]: Began running node model.attribution_dbt.mart_revenue_monthly
[0m21:39:01.112488 [info ] [Thread-1 (]: 1 of 4 START sql table model public.mart_kpis .................................. [RUN]
[0m21:39:01.116122 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_kpis'
[0m21:39:01.116122 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.mart_kpis
[0m21:39:01.115025 [info ] [Thread-2 (]: 2 of 4 START sql table model public.mart_revenue_monthly ....................... [RUN]
[0m21:39:01.133140 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.mart_kpis"
[0m21:39:01.133140 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_monthly'
[0m21:39:01.135850 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.mart_revenue_monthly
[0m21:39:01.136366 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_monthly"
[0m21:39:01.141335 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.mart_revenue_monthly
[0m21:39:01.148553 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.mart_kpis
[0m21:39:01.243815 [debug] [Thread-2 (]: Writing runtime sql for node "model.attribution_dbt.mart_revenue_monthly"
[0m21:39:01.243815 [debug] [Thread-1 (]: Writing runtime sql for node "model.attribution_dbt.mart_kpis"
[0m21:39:01.248611 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m21:39:01.249651 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: BEGIN
[0m21:39:01.250166 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m21:39:01.257037 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:39:01.258460 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: BEGIN
[0m21:39:01.260115 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:39:01.286019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m21:39:01.287096 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m21:39:01.287096 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m21:39:01.287096 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m21:39:01.287096 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_kpis"} */

  
    

  create  table "attrib_analytics"."public"."mart_kpis__dbt_tmp"
  
  
    as
  
  (
    with base as (
  select * from "attrib_analytics"."public"."stg_orders"
)
select
  now()                                                          as as_of,
  count(*)                                                       as orders_count,
  sum(amount)                                                    as revenue_total,
  case when count(*) > 0 then sum(amount)::numeric / count(*) else 0 end as aov,
  count(distinct channel)                                        as channels_count
from base
  );
  
[0m21:39:01.287096 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_monthly"} */

  
    

  create  table "attrib_analytics"."public"."mart_revenue_monthly__dbt_tmp"
  
  
    as
  
  (
    with daily as (
  select order_date, channel, amount
  from "attrib_analytics"."public"."stg_orders"
)
select
  date_trunc('month', order_date)::date                          as month,
  sum(amount)                                                    as revenue,
  sum(case when channel='ads'    then amount else 0 end)         as revenue_ads,
  sum(case when channel='email'  then amount else 0 end)         as revenue_email,
  sum(case when channel='direct' then amount else 0 end)         as revenue_direct
from daily
group by 1
order by 1
  );
  
[0m21:39:01.368193 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.078 seconds
[0m21:39:01.384663 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.094 seconds
[0m21:39:01.388848 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m21:39:01.395260 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m21:39:01.395260 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_monthly"} */
alter table "attrib_analytics"."public"."mart_revenue_monthly" rename to "mart_revenue_monthly__dbt_backup"
[0m21:39:01.395260 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_kpis"} */
alter table "attrib_analytics"."public"."mart_kpis" rename to "mart_kpis__dbt_backup"
[0m21:39:01.402659 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:39:01.404711 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m21:39:01.408965 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m21:39:01.416098 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m21:39:01.416098 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_kpis"} */
alter table "attrib_analytics"."public"."mart_kpis__dbt_tmp" rename to "mart_kpis"
[0m21:39:01.417118 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_monthly"} */
alter table "attrib_analytics"."public"."mart_revenue_monthly__dbt_tmp" rename to "mart_revenue_monthly"
[0m21:39:01.420619 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:39:01.433246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m21:39:01.449580 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: COMMIT
[0m21:39:01.452761 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: COMMIT
[0m21:39:01.452761 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m21:39:01.452761 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m21:39:01.452761 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: COMMIT
[0m21:39:01.452761 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: COMMIT
[0m21:39:01.462924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m21:39:01.462924 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m21:39:01.473936 [debug] [Thread-1 (]: Applying DROP to: "attrib_analytics"."public"."mart_kpis__dbt_backup"
[0m21:39:01.477003 [debug] [Thread-2 (]: Applying DROP to: "attrib_analytics"."public"."mart_revenue_monthly__dbt_backup"
[0m21:39:01.486037 [debug] [Thread-1 (]: Using postgres connection "model.attribution_dbt.mart_kpis"
[0m21:39:01.486037 [debug] [Thread-2 (]: Using postgres connection "model.attribution_dbt.mart_revenue_monthly"
[0m21:39:01.491368 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_kpis"} */
drop table if exists "attrib_analytics"."public"."mart_kpis__dbt_backup" cascade
[0m21:39:01.491368 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "model.attribution_dbt.mart_revenue_monthly"} */
drop table if exists "attrib_analytics"."public"."mart_revenue_monthly__dbt_backup" cascade
[0m21:39:01.532659 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.041 seconds
[0m21:39:01.534471 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.042 seconds
[0m21:39:01.538488 [debug] [Thread-1 (]: On model.attribution_dbt.mart_kpis: Close
[0m21:39:01.542884 [debug] [Thread-2 (]: On model.attribution_dbt.mart_revenue_monthly: Close
[0m21:39:01.544433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424bc997-4c0a-4cf2-be04-fcf55976b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0F8ED640>]}
[0m21:39:01.546615 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424bc997-4c0a-4cf2-be04-fcf55976b50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B1070C260>]}
[0m21:39:01.546615 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.mart_kpis ............................. [[32mSELECT 1[0m in 0.43s]
[0m21:39:01.551168 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.mart_kpis
[0m21:39:01.549086 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.mart_revenue_monthly .................. [[32mSELECT 1[0m in 0.41s]
[0m21:39:01.554404 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m21:39:01.554404 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.mart_revenue_monthly
[0m21:39:01.554404 [info ] [Thread-4 (]: 3 of 4 START test not_null_mart_kpis_as_of ..................................... [RUN]
[0m21:39:01.554404 [debug] [Thread-1 (]: Began running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m21:39:01.554404 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516'
[0m21:39:01.554404 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m21:39:01.554404 [info ] [Thread-1 (]: 4 of 4 START test not_null_mart_revenue_monthly_month .......................... [RUN]
[0m21:39:01.577317 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"
[0m21:39:01.577317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_kpis, now test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61)
[0m21:39:01.579329 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m21:39:01.587094 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"
[0m21:39:01.587094 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m21:39:01.612673 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m21:39:01.618609 [debug] [Thread-4 (]: Writing runtime sql for node "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"
[0m21:39:01.623222 [debug] [Thread-1 (]: Writing runtime sql for node "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"
[0m21:39:01.626800 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"
[0m21:39:01.626800 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"
[0m21:39:01.628193 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61: BEGIN
[0m21:39:01.628706 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516: BEGIN
[0m21:39:01.628706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:01.628706 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:39:01.652372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m21:39:01.652372 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m21:39:01.652372 [debug] [Thread-1 (]: Using postgres connection "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"
[0m21:39:01.657570 [debug] [Thread-4 (]: Using postgres connection "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"
[0m21:39:01.657570 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "attrib_analytics"."public"."mart_revenue_monthly"
where month is null



  
  
      
    ) dbt_internal_test
[0m21:39:01.657570 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "node_id": "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select as_of
from "attrib_analytics"."public"."mart_kpis"
where as_of is null



  
  
      
    ) dbt_internal_test
[0m21:39:01.660878 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:39:01.662452 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:39:01.668435 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61: ROLLBACK
[0m21:39:01.671775 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516: ROLLBACK
[0m21:39:01.671775 [debug] [Thread-1 (]: On test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61: Close
[0m21:39:01.671775 [debug] [Thread-4 (]: On test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516: Close
[0m21:39:01.675679 [info ] [Thread-1 (]: 4 of 4 PASS not_null_mart_revenue_monthly_month ................................ [[32mPASS[0m in 0.10s]
[0m21:39:01.676391 [info ] [Thread-4 (]: 3 of 4 PASS not_null_mart_kpis_as_of ........................................... [[32mPASS[0m in 0.12s]
[0m21:39:01.678347 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m21:39:01.678347 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m21:39:01.681870 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:01.681870 [debug] [MainThread]: On master: BEGIN
[0m21:39:01.681870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:39:01.705214 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:39:01.705214 [debug] [MainThread]: On master: COMMIT
[0m21:39:01.707221 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:01.707221 [debug] [MainThread]: On master: COMMIT
[0m21:39:01.707221 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:39:01.709730 [debug] [MainThread]: On master: Close
[0m21:39:01.709730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:01.711867 [debug] [MainThread]: Connection 'list_attrib_analytics' was properly closed.
[0m21:39:01.711867 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m21:39:01.711867 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m21:39:01.711867 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61' was properly closed.
[0m21:39:01.711867 [debug] [MainThread]: Connection 'model.attribution_dbt.mart_revenue_monthly' was properly closed.
[0m21:39:01.715109 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516' was properly closed.
[0m21:39:01.715615 [info ] [MainThread]: 
[0m21:39:01.716639 [info ] [MainThread]: Finished running 2 table models, 2 data tests in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m21:39:01.719909 [debug] [MainThread]: Command end result
[0m21:39:01.773963 [info ] [MainThread]: 
[0m21:39:01.775592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:39:01.776700 [info ] [MainThread]: 
[0m21:39:01.777876 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:39:01.779655 [debug] [MainThread]: Command `dbt build` succeeded at 21:39:01.779655 after 6.32 seconds
[0m21:39:01.780186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0E16BBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0E16B230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0D5178F0>]}
[0m21:39:01.781314 [debug] [MainThread]: Flushing usage events
[0m23:43:18.878803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA351E1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9FCE4B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA3824800>]}


============================== 23:43:18.889244 | 0e3512b3-efef-4104-abd9-07442231c9e1 ==============================
[0m23:43:18.889244 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:43:18.889244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:43:19.231903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e3512b3-efef-4104-abd9-07442231c9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA3929280>]}
[0m23:43:19.303610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e3512b3-efef-4104-abd9-07442231c9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA12D9520>]}
[0m23:43:19.306822 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:43:19.701818 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:43:20.032270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:20.033310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:20.106307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e3512b3-efef-4104-abd9-07442231c9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA4F105C0>]}
[0m23:43:20.182028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e3512b3-efef-4104-abd9-07442231c9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA52AAC90>]}
[0m23:43:20.184085 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 6 data tests, 1 source, 1 exposure, 433 macros
[0m23:43:20.185135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e3512b3-efef-4104-abd9-07442231c9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA5144DA0>]}
[0m23:43:20.188157 [info ] [MainThread]: 
[0m23:43:20.188157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:20.194238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public_'
[0m23:43:20.195522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_attrib_analytics_public'
[0m23:43:20.406981 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m23:43:20.411716 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m23:43:20.411716 [debug] [ThreadPool]: On list_attrib_analytics_public_: BEGIN
[0m23:43:20.411716 [debug] [ThreadPool]: On list_attrib_analytics_public: BEGIN
[0m23:43:20.411716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:20.411716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:20.543250 [debug] [ThreadPool]: SQL status: BEGIN in 0.132 seconds
[0m23:43:20.543250 [debug] [ThreadPool]: SQL status: BEGIN in 0.133 seconds
[0m23:43:20.543250 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public"
[0m23:43:20.543250 [debug] [ThreadPool]: Using postgres connection "list_attrib_analytics_public_"
[0m23:43:20.543250 [debug] [ThreadPool]: On list_attrib_analytics_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:43:20.543250 [debug] [ThreadPool]: On list_attrib_analytics_public_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "list_attrib_analytics_public_"} */
select
      'attrib_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_'
    union all
    select
      'attrib_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_'
  
[0m23:43:20.619506 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.069 seconds
[0m23:43:20.621128 [debug] [ThreadPool]: On list_attrib_analytics_public_: ROLLBACK
[0m23:43:20.621128 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.072 seconds
[0m23:43:20.621128 [debug] [ThreadPool]: On list_attrib_analytics_public: ROLLBACK
[0m23:43:20.621128 [debug] [ThreadPool]: On list_attrib_analytics_public_: Close
[0m23:43:20.621128 [debug] [ThreadPool]: On list_attrib_analytics_public: Close
[0m23:43:20.626155 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:20.626155 [debug] [MainThread]: On master: BEGIN
[0m23:43:20.626155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:20.656921 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m23:43:20.656921 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:20.656921 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:20.687689 [debug] [MainThread]: SQL status: SELECT 1 in 0.028 seconds
[0m23:43:20.687689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e3512b3-efef-4104-abd9-07442231c9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA504D190>]}
[0m23:43:20.687689 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:20.687689 [debug] [MainThread]: On master: Close
[0m23:43:20.687689 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:20.687689 [info ] [MainThread]: 
[0m23:43:20.701038 [debug] [Thread-1 (]: Began running node seed.attribution_dbt.orders_seed
[0m23:43:20.701038 [debug] [Thread-2 (]: Began running node snapshot.attribution_dbt.orders_snapshot
[0m23:43:20.706823 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.attribution_dbt.orders_seed'
[0m23:43:20.707971 [debug] [Thread-2 (]: Acquiring new postgres connection 'snapshot.attribution_dbt.orders_snapshot'
[0m23:43:20.708493 [debug] [Thread-1 (]: Began compiling node seed.attribution_dbt.orders_seed
[0m23:43:20.709063 [debug] [Thread-2 (]: Began compiling node snapshot.attribution_dbt.orders_snapshot
[0m23:43:20.717513 [debug] [Thread-1 (]: Began executing node seed.attribution_dbt.orders_seed
[0m23:43:20.721879 [debug] [Thread-2 (]: Began executing node snapshot.attribution_dbt.orders_snapshot
[0m23:43:20.722446 [debug] [Thread-1 (]: Finished running node seed.attribution_dbt.orders_seed
[0m23:43:20.723714 [debug] [Thread-2 (]: Finished running node snapshot.attribution_dbt.orders_snapshot
[0m23:43:20.724859 [debug] [Thread-4 (]: Began running node model.attribution_dbt.stg_orders
[0m23:43:20.726010 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.attribution_dbt.stg_orders'
[0m23:43:20.726559 [debug] [Thread-4 (]: Began compiling node model.attribution_dbt.stg_orders
[0m23:43:20.729971 [debug] [Thread-4 (]: Writing injected SQL for node "model.attribution_dbt.stg_orders"
[0m23:43:20.733140 [debug] [Thread-4 (]: Began executing node model.attribution_dbt.stg_orders
[0m23:43:20.734851 [debug] [Thread-4 (]: Finished running node model.attribution_dbt.stg_orders
[0m23:43:20.735438 [debug] [Thread-1 (]: Began running node model.attribution_dbt.mart_kpis
[0m23:43:20.736591 [debug] [Thread-2 (]: Began running node model.attribution_dbt.mart_revenue_daily
[0m23:43:20.737244 [debug] [Thread-3 (]: Began running node model.attribution_dbt.mart_revenue_monthly
[0m23:43:20.737845 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:43:20.738385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.attribution_dbt.orders_seed, now model.attribution_dbt.mart_kpis)
[0m23:43:20.739011 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.attribution_dbt.orders_snapshot, now model.attribution_dbt.mart_revenue_daily)
[0m23:43:20.739563 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.attribution_dbt.mart_revenue_monthly'
[0m23:43:20.740104 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.stg_orders, now test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m23:43:20.740729 [debug] [Thread-1 (]: Began compiling node model.attribution_dbt.mart_kpis
[0m23:43:20.741817 [debug] [Thread-2 (]: Began compiling node model.attribution_dbt.mart_revenue_daily
[0m23:43:20.742352 [debug] [Thread-3 (]: Began compiling node model.attribution_dbt.mart_revenue_monthly
[0m23:43:20.742878 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:43:20.746699 [debug] [Thread-1 (]: Writing injected SQL for node "model.attribution_dbt.mart_kpis"
[0m23:43:20.749633 [debug] [Thread-2 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_daily"
[0m23:43:20.752544 [debug] [Thread-3 (]: Writing injected SQL for node "model.attribution_dbt.mart_revenue_monthly"
[0m23:43:20.769192 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:43:20.771968 [debug] [Thread-2 (]: Began executing node model.attribution_dbt.mart_revenue_daily
[0m23:43:20.774170 [debug] [Thread-2 (]: Finished running node model.attribution_dbt.mart_revenue_daily
[0m23:43:20.774704 [debug] [Thread-1 (]: Began executing node model.attribution_dbt.mart_kpis
[0m23:43:20.775226 [debug] [Thread-3 (]: Began executing node model.attribution_dbt.mart_revenue_monthly
[0m23:43:20.776292 [debug] [Thread-2 (]: Began running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:43:20.777431 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:43:20.779617 [debug] [Thread-1 (]: Finished running node model.attribution_dbt.mart_kpis
[0m23:43:20.780730 [debug] [Thread-3 (]: Finished running node model.attribution_dbt.mart_revenue_monthly
[0m23:43:20.781294 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_revenue_daily, now test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m23:43:20.782393 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:43:20.782934 [debug] [Thread-1 (]: Began running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m23:43:20.784063 [debug] [Thread-3 (]: Began running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m23:43:20.784599 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:43:20.785832 [debug] [Thread-4 (]: Began running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m23:43:20.786430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_kpis, now test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f)
[0m23:43:20.787010 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.attribution_dbt.mart_revenue_monthly, now test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097)
[0m23:43:20.798907 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:43:20.798907 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516)
[0m23:43:20.800925 [debug] [Thread-1 (]: Began compiling node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m23:43:20.801443 [debug] [Thread-3 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m23:43:20.801443 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:43:20.801443 [debug] [Thread-4 (]: Began compiling node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m23:43:20.819724 [debug] [Thread-1 (]: Writing injected SQL for node "test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f"
[0m23:43:20.828140 [debug] [Thread-3 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097"
[0m23:43:20.830140 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:43:20.836857 [debug] [Thread-4 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516"
[0m23:43:20.837875 [debug] [Thread-2 (]: Began running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m23:43:20.839501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.attribution_dbt.unique_stg_orders_order_id.e3b841c71a, now test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61)
[0m23:43:20.840641 [debug] [Thread-1 (]: Began executing node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m23:43:20.840641 [debug] [Thread-3 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m23:43:20.840641 [debug] [Thread-2 (]: Began compiling node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m23:43:20.843187 [debug] [Thread-4 (]: Began executing node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m23:43:20.845798 [debug] [Thread-1 (]: Finished running node test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f
[0m23:43:20.845798 [debug] [Thread-3 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097
[0m23:43:20.857656 [debug] [Thread-2 (]: Writing injected SQL for node "test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61"
[0m23:43:20.858681 [debug] [Thread-4 (]: Finished running node test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516
[0m23:43:20.858681 [debug] [Thread-2 (]: Began executing node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m23:43:20.858681 [debug] [Thread-2 (]: Finished running node test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61
[0m23:43:20.864286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:20.865633 [debug] [MainThread]: Connection 'list_attrib_analytics_public_' was properly closed.
[0m23:43:20.865633 [debug] [MainThread]: Connection 'list_attrib_analytics_public' was properly closed.
[0m23:43:20.865633 [debug] [MainThread]: Connection 'test.attribution_dbt.accepted_values_mart_revenue_daily_channel__ads__email__direct.65d51b480f' was properly closed.
[0m23:43:20.865633 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_monthly_month.31c1454a61' was properly closed.
[0m23:43:20.865633 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_kpis_as_of.a3dbaad516' was properly closed.
[0m23:43:20.868149 [debug] [MainThread]: Connection 'test.attribution_dbt.not_null_mart_revenue_daily_order_date.2b97a35097' was properly closed.
[0m23:43:20.871446 [debug] [MainThread]: Command end result
[0m23:43:21.044386 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:43:21.045200 [info ] [MainThread]: Building catalog
[0m23:43:21.057245 [debug] [ThreadPool]: Acquiring new postgres connection 'attrib_analytics.information_schema'
[0m23:43:21.067121 [debug] [ThreadPool]: Using postgres connection "attrib_analytics.information_schema"
[0m23:43:21.069134 [debug] [ThreadPool]: On attrib_analytics.information_schema: BEGIN
[0m23:43:21.069134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:21.104054 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m23:43:21.107106 [debug] [ThreadPool]: Using postgres connection "attrib_analytics.information_schema"
[0m23:43:21.107866 [debug] [ThreadPool]: On attrib_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "attribution_os", "target_name": "dev", "connection_name": "attrib_analytics.information_schema"} */

    
    

    select
        'attrib_analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders_seed')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_revenue_daily')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_revenue_monthly')) or (upper(sch.nspname) = upper('public_') and
           upper(tbl.relname) = upper('orders_snapshot')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_kpis')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:43:21.157696 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.050 seconds
[0m23:43:21.161685 [debug] [ThreadPool]: On attrib_analytics.information_schema: ROLLBACK
[0m23:43:21.163717 [debug] [ThreadPool]: On attrib_analytics.information_schema: Close
[0m23:43:21.207038 [info ] [MainThread]: Catalog written to C:\Users\danie\attribution-os\analytics\attribution_dbt\target\catalog.json
[0m23:43:21.217063 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:43:21.217063 after 2.64 seconds
[0m23:43:21.217588 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:43:21.218168 [debug] [MainThread]: Connection 'attrib_analytics.information_schema' was properly closed.
[0m23:43:21.218168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA394FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA4DD7F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA51881D0>]}
[0m23:43:21.218168 [debug] [MainThread]: Flushing usage events
[0m23:43:26.562229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD42E9E870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD45E15730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD45E157C0>]}


============================== 23:43:26.562229 | a708798f-4160-4f21-893f-106179e75547 ==============================
[0m23:43:26.562229 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:43:26.589122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\danie\\attribution-os\\analytics\\attribution_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m23:43:26.799368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a708798f-4160-4f21-893f-106179e75547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD45F5BD10>]}
[0m23:43:26.856674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a708798f-4160-4f21-893f-106179e75547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD45633860>]}
[0m00:14:20.731847 [error] [MainThread]: Encountered an error:

[0m00:14:20.949120 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\danie\attribution-os\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\danie\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\danie\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m00:14:20.989261 [debug] [MainThread]: Command `dbt docs serve` failed at 00:14:20.985311 after 1854.96 seconds
[0m00:14:21.020166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD42E9E870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD4565E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD45F5B050>]}
[0m00:14:21.032696 [debug] [MainThread]: Flushing usage events
